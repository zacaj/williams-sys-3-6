0001   0000             #include "680xlogic.asm"
0001+  0000             ;***********************************************
0002+  0000             ;* 680X Style Logical Instruction Macros       *
0003+  0000             ;* For use with TASMx Assembler                *
0004+  0000             ;* Written by Jess M. Askey 2001 jess@askey.org*
0005+  0000             ;***********************************************
0006+  0000             .module logic
0007+  0000             
0008+  0000             var1_		.equ	$00
0009+  0000             var2_		.equ	$00
0010+  0000             var3_		.equ	$00
0011+  0000             var4_		.equ	$00
0012+  0000             
0013+  0000             #define     FLAG_IF    	0
0014+  0000             #define     FLAG_ELSE 	1
0015+  0000             #define	FLAG_BEGIN 	2
0016+  0000             
0017+  0000             ;*******************************************************************
0018+  0000             ;* Locate: Pushes two Words                                        *
0019+  0000             ;*                                                                 *
0020+  0000             ;*            Word 1 - address of branch location                  *
0021+  0000             ;*            Word 2 - Type of Operation                           *
0022+  0000             ;*                     0 - Standard ENDIF                          *
0023+  0000             ;*                     1 - ELSE or Logical ELSE                    *
0024+  0000             ;*                     2 - Loop                                    *
0025+  0000             ;*******************************************************************
0026+  0000             #define	logic_loc(type)	     \ .push  *, type
0027+  0000             
0028+  0000             ;*******************************************************************
0029+  0000             ;* Ifxx: These are the standard 'if' statements, they will always  *
0030+  0000             ;*       be of type 0.                                             *
0031+  0000             ;*******************************************************************
0032+  0000             #define	logic_ifxx(x)	     logic_loc(FLAG_IF) \ x  * 
0033+  0000             
0034+  0000             ;*******************************************************************
0035+  0000             ;* Begin: The start marker for logical loops, must terminate with  *
0036+  0000             ;*        an 'xxend' statement.                                    *
0037+  0000             ;******************************************************************* 
0038+  0000             #define     begin(x)		     logic_loc(FLAG_BEGIN)
0039+  0000             
0040+  0000             ;*******************************************************************
0041+  0000             ;* Logic End: This is the end macro for the 'begin' statement. It  *
0042+  0000             ;*            pulls the pc location of the beginning of the loop   *
0043+  0000             ;*            and verifies that the 'type' is correct.             *
0044+  0000             ;*******************************************************************
0045+  0000             #define logic_loopend(x,y)	\ .pop var1_, var2_
0046+  0000             #defcont				\#if (var1_ & FLAG_BEGIN)
0047+  0000             #defcont					\#if ((var2_-*-2+127) <= 0)
0048+  0000             #defcont						\ y	*+5
0049+  0000             #defcont						\ jmp	var2_
0050+  0000             #defcont					\#else
0051+  0000             #defcont						\ x	var2_
0052+  0000             #defcont					\#endif
0053+  0000             #defcont				\#else
0054+  0000             #defcont					\ .error "Inappropriate End for BEGIN Loop."
0055+  0000             #defcont				\#endif
0056+  0000             
0057+  0000             ;*******************************************************************
0058+  0000             ;* Logic Find: Used for ENDIF statement. Will find the pc for the  *
0059+  0000             ;*             previous IF (or ELSE) and update the branch or jump *
0060+  0000             ;*             at that address to point to the current address.    *
0061+  0000             ;*******************************************************************
0062+  0000             #define logic_end \var1_ .set *
0063+  0000             #defcont		\ .pop var3_, var4_
0064+  0000             #defcont		\#if (var3_ & FLAG_BEGIN)==0 
0065+  0000             #defcont			\#if (var3_ & FLAG_ELSE)==0	
0066+  0000             #defcont  				\var2_ .set var1_-var4_-2
0067+  0000             #defcont				\#if var2_+127 < 0
0068+  0000             #defcont					\ .error "Branch Range < -127"
0069+  0000             #defcont				\#else
0070+  0000             #defcont					\#if var2_-128 > 0
0071+  0000             #defcont						\ .error "Branch Range > 128"
0072+  0000             #defcont					\#else
0073+  0000             #defcont    					\ .org var4_+1
0074+  0000             #defcont						\ .byte var2_
0075+  0000             #defcont					\#endif
0076+  0000             #defcont				\#endif
0077+  0000             #defcont			\#else	
0078+  0000             #defcont    			\ .org  var4_-2	
0079+  0000             #defcont				\ .word var1_
0080+  0000             #defcont			\#endif
0081+  0000             #defcont			\ .org	var1_
0082+  0000             #defcont		\#else
0083+  0000             #defcont			\.error "Wrong Endtype for IF block"
0084+  0000             #defcont		\#endif
0085+  0000             
0086+  0000             ;*******************************************************************
0087+  0000             ;* Logic Else: Can act as a standard else or a complex else        *
0088+  0000             ;*             (ie. with additional logic as defined below). The   *
0089+  0000             ;*             ELSE block will resove how to terminate the current *
0090+  0000             ;*             code and then set the owning IF statement's data    *
0091+  0000             ;*             byte.                                               *
0092+  0000             ;*******************************************************************
0093+  0000             #define	logic_else(x,y)	\var1_ .set $
0094+  0000             #defcont		\ .pop var3_, var4_
0095+  0000             #defcont		\#if (var3_ & FLAG_BEGIN)==0
0096+  0000             #defcont			\#if (var3_ & FLAG_ELSE)==0
0097+  0000             #defcont				\ .org var4_+1
0098+  0000             #defcont	      		\#if x==0
0099+  0000             #defcont					\var2_ .set var1_-var4_-2+2
0100+  0000             #defcont					\#if var2_+127 < 0
0101+  0000             #defcont						\ .org var1_
0102+  0000             #defcont						\.push $+3, 1
0103+  0000             #defcont						\ jmp $
0104+  0000             #defcont					\#else
0105+  0000             #defcont						\#if var2_-128>0
0106+  0000             #defcont							\ .org var1_
0107+  0000             #defcont							\.push $+3, 1
0108+  0000             #defcont							\ jmp $
0109+  0000             #defcont						\#else
0110+  0000             #defcont							\.push var1_, 0
0111+  0000             #defcont							\ .byte var2_
0112+  0000             #defcont							\ .org var1_
0113+  0000             #defcont							\ BRA $
0114+  0000             #defcont							\ .org var1_+2
0115+  0000             #defcont						\#endif
0116+  0000             #defcont					\#endif
0117+  0000             #defcont				\#else
0118+  0000             #defcont					\ .byte var1_-var4_-2+2
0119+  0000             #defcont					\ .org var1_
0120+  0000             #defcont					\.push $, 0
0121+  0000             #defcont					\ y $		
0122+  0000             #defcont				\#endif
0123+  0000             #defcont			\#else
0124+  0000             #defcont				\.error "Duplicate ELSE Statement"
0125+  0000             #defcont			\#endif
0126+  0000             #defcont		\#else
0127+  0000             #defcont			\ .error "Misplaced Else"
0128+  0000             #defcont		\#endif
0129+  0000             
0130+  0000             
0131+  0000             ;*******************************************************************
0132+  0000             ;* Defines how to use the various logic macros defined above.      *
0133+  0000             ;*******************************************************************
0134+  0000             #define	ifeq	logic_ifxx(BNE)		
0135+  0000             #define	ifne	logic_ifxx(BEQ)
0136+  0000             #define	ifpl	logic_ifxx(BMI)
0137+  0000             #define	ifhi	logic_ifxx(BLO)
0138+  0000             #define	ifmi	logic_ifxx(BPL)
0139+  0000             #define	iflo	logic_ifxx(BHI)
0140+  0000             #define	ifcs	logic_ifxx(BCC)
0141+  0000             #define	ifcc	logic_ifxx(BCS)
0142+  0000             #define 	ifvc	logic_ifxx(BVS)
0143+  0000             #define 	ifvs	logic_ifxx(BVC)
0144+  0000             #define	ifge	logic_ifxx(BLO)
0145+  0000             #define	ifgt	logic_ifxx(BLS)
0146+  0000             
0147+  0000             #define	else  	logic_else(0,0)
0148+  0000             #define	else_eq	logic_else(1,BEQ)
0149+  0000             #define	else_ne	logic_else(1,BNE)
0150+  0000             #define	else_pl	logic_else(1,BPL)
0151+  0000             #define	else_mi	logic_else(1,BMI)
0152+  0000             #define	else_cc	logic_else(1,BCC)
0153+  0000             #define	else_cs	logic_else(1,BCS)
0154+  0000             
0155+  0000             #define 	endif		logic_end
0156+  0000             
0157+  0000             #define	eqend	logic_loopend(BNE,BEQ)		
0158+  0000             #define	neend	logic_loopend(BEQ,BNE)		
0159+  0000             #define	plend	logic_loopend(BMI,BPL)
0160+  0000             #define	miend	logic_loopend(BPL,BMI)
0161+  0000             #define	csend	logic_loopend(BCC,BCS)
0162+  0000             #define	ccend	logic_loopend(BCS,BCC)
0163+  0000             #define	vcend	logic_loopend(BVS,BVC)
0164+  0000             #define	vsend	logic_loopend(BVC,BVS)
0165+  0000             
0166+  0000             #define	loopend	logic_loopend(BRA,BRA)
0167+  0000             
0168+  0000             #define	lsb(x)	x&$FF
0169+  0000             
0170+  0000             #define	msb(x)	(x>>8)&$FF0002   0000             
0003   0000             #include "decls.asm"
0001+  0000             
0002+  0000             displayStrobe: 	.equ $2800 ;		CB2=1 special solenoid 6
0003+  0000             displayBcd: 	.equ $2802
0004+  0000             displayStrobeC:	.equ $2801
0005+  0000             displayBcdC:	.equ $2803
0006+  0000             lampCol:		.equ $2400 ;		CA2=1 special solenoid 2
0007+  0000             lampColC:		.equ $2401 ; 		CB2=1 special solenoid 1
0008+  0000             lampStrobe:		.equ $2402
0009+  0000             lampStrobeC:	.equ $2403
0010+  0000             switchStrobe:	.equ $3002
0011+  0000             switchStrobeC:	.equ $3003
0012+  0000             switchRow:		.equ $3000 ; 		CB2=1 special solenoid 3
0013+  0000             switchRowC:		.equ $3001 ;		CA2=1 special solenoid 4
0014+  0000             solenoidA:		.equ $2200 ; todo: 	CB2=1 enable special solenoids, flippers
0015+  0000             solenoidAC		.equ $2201 ;      	CA2=1 special solenoid 5
0016+  0000             solenoidB:		.equ $2202
0017+  0000             solenoidBC:		.equ $2203
0018+  0000             
0019+  0000             RAM:			.equ $0000
0020+  0000             cRAM:			.equ $0100
0021+  0000             RAMEnd:			.equ $01FF
0022+  0000             temp:			.equ RAM + $00 ; 01
0023+  0000             counter:		.equ RAM + $02
0024+  0000             counter2:		.equ RAM + $03
0025+  0000             strobe:			.equ RAM + $07
0026+  0000             lampCol1:		.equ RAM + $08
0027+  0000             lampCol8:		.equ lampCol1 + 7 
0028+  0000             #DEFINE lc(x) 		lampCol1 + (x-1)
0029+  0000             #DEFINE lr(x)		((1 << (x-1))
0030+  0000             curSwitchRowLsb:	.equ RAM + $10 
0031+  0000             ; 
0032+  0000             curPlayer:		.equ RAM + $12 ; + 0-3
0033+  0000             ;;;
0034+  0000             switchRow1:		.equ RAM + $20
0035+  0000             switchRow8:		.equ switchRow1 + 7 
0036+  0000             #DEFINE sc(x) 		switchRow1 + x - 1
0037+  0000             #DEFINE sr(x)		(1 << (x-1))
0038+  0000             solAStatus:		.equ RAM + $28 ; solenoid PIA is updated once every 8 IRQ
0039+  0000             solBStatus:		.equ RAM + $29 ; one solenoid bit is generated per IRQ and pushed on
0040+  0000             attractX:		.equ RAM + $2A ; +
0041+  0000             forkX			.equ RAM + $2C ; +
0042+  0000             scanCurCol:		.equ RAM + $2E ; +
0043+  0000             scanCurSwitchRowLsb:	.equ RAM + $30
0044+  0000             scanStrobe:		.equ RAM + $31
0045+  0000             scanX:			.equ RAM + $32 ; +
0046+  0000             scanTempX:		.equ RAM + $34 ; +
0047+  0000             irqSwitchRow:		.equ RAM + $36
0048+  0000             curCol:			.equ RAM + $50 ; +
0049+  0000             tempX:			.equ RAM + $52 ; +
0050+  0000             queueHead:		.equ RAM + $54 ; +
0051+  0000             queueTail:		.equ RAM + $56 ; +
0052+  0000             tempQ:			.equ RAM + $58 ; +
0053+  0000             queue:			.equ RAM + $60	; opened | switch? | number#6
0054+  0000             queueEnd:		.equ RAM + $6D
0055+  0000             ;
0056+  0000             displayBcd1:	.equ RAM + $70
0057+  0000             displayBcd16:	.equ RAM + $7F
0058+  0000             ballCount:		.equ displayBcd1 + 7
0059+  0000             waitLeft: 		.equ RAM + $80 ; dec every 8ms
0060+  0000             waitLeftEnd:		.equ RAM + $87
0061+  0000             waitMsb:		.equ RAM + $88 ; -> 8F
0062+  0000             waitLsb:		.equ RAM + $90 ; -> 97
0063+  0000             waitReg:		.equ RAM + $98 ; -> 9F
0064+  0000             flashLampCol1:		.equ RAM + $A0
0065+  0000             flashLampCol8:		.equ RAM + $A7
0066+  0000             #DEFINE flc(x) 		flashLampCol1 + (x - 1)
0067+  0000             lastSwitch:		.equ RAM + $A8
0068+  0000             dropResetTimer:		.equ RAM + $A9 ; max 127
0069+  0000             dropsDown		.equ RAM + $AA
0070+  0000             p_Bonus:		.equ RAM + $B0
0071+  0000             p_Ejects:		.equ RAM + $B1 ; -> B4
0072+  0000             p_DropsDown:		.equ RAM + $B5
0073+  0000             p_LampCol2:		.equ RAM + $B6 ; -> B9
0074+  0000             spinnerTimer:		.equ RAM + $BA 
0075+  0000             
0076+  0000             p_BonusLeft:		.equ RAM + $BE
0077+  0000             bonusTimer:		.equ RAM + $BF ; counts down from 127 during bonus
0078+  0000             
0079+  0000             
0080+  0000             
0081+  0000             settleRow1:		.equ cRAM + $00 ;must be at 0
0082+  0000             settleRow8End:		.equ settleRow1+  (8*8)-1
0083+  0000             solenoid1:		.equ cRAM + $40		; set to E to turn solenoid on permanently
0084+  0000             solenoid8:		.equ solenoid1 + 7	; otherwise (<E), decremented every 8ms till reaches 0
0085+  0000             solenoid9:		.equ solenoid1 + 8	; F = solenoid off, otherwise on
0086+  0000             solenoid16:		.equ solenoid1 + 15 ; set to pulse time / 8ms to fire solenoid (5-7 reccomended)
0087+  0000             #DEFINE s(n) 		(0 + n)
0088+  0000             pA_1m:			.equ cRAM + $50	; note reverse order to match displays
0089+  0000             pA_10:			.equ pA_1m + 5
0090+  0000             pB_1m:			.equ pA_10 + 1
0091+  0000             pB_10:			.equ pB_1m + 5
0092+  0000             pC_1m:			.equ pB_10 + 1
0093+  0000             pC_10:			.equ pC_1m + 5
0094+  0000             pD_1m:			.equ pC_10 + 1
0095+  0000             pD_10:			.equ pD_1m + 5 
0096+  0000             ; 
0097+  0000             displayCol:		.equ cRAM + $6A
0098+  0000             state:			.equ cRAM + $6B	; loop processing performed | strobe reset | don't validate | quick scanning switches
0099+  0000             strobeReset:		.equ cRAM + $6C
0100+  0000             
0101+  0000             instant:		.equ 4
0102+  0000             debounce:		.equ 1
0103+  0000             slow:			.equ 2
0104+  0000             
0105+  0000             switchSettle:	.equ cRAM + $30
0106+  0000             ; through $7F ?0004   0000             
0005   0000             #include "util.asm"
0001+  7D00             utils:	.org $7800 + $500
0002+  7D00             
0003+  7D00             ; copy players' scores to display 
0004+  7D00             copyScores13:
0005+  7D00 CE 00 70    	ldX	displayBcd1
0006+  7D03 C6 FF       	ldaB	$FF	; blank(F) until a number >0 is found then 0
0007+  7D05             copy13Loop:
0008+  7D05 A6 E0       	ldaA	pA_1m - displayBcd1, X
0009+  7D07 84 0F       	andA	$0F
0010+  7D09 81 00       	cmpA	$00 
0011+  7D0B             	ifeq ; if pA score = 0?
0011+  7D0B             
0011+  7D0B 26 FE       
0012+  7D0D 8C 00 75    		cpX	displayBcd1 + 5
0013+  7D10             		ifeq
0013+  7D10             
0013+  7D10 26 FE       
0014+  7D12 C4 0F       			andB	00001111b 
0015+  7D14 86 0F       			ldaA	$0F
0016+  7D16             		else
0016+  7D16             
0016+  7D16             
0016+  7D16             
0016+  7D16             
0016+  7D11             
0016+  7D11             
0016+  7D11             
0016+  7D11~            		else
0016+  7D11~            		else
0016+  7D11~            		else
0016+  7D11~            		else
0016+  7D11             
0016+  7D11~            		else
0016+  7D11~            		else
0016+  7D11~            		else
0016+  7D11~            		else
0016+  7D11             
0016+  7D11             
0016+  7D11 06          
0016+  7D16             
0016+  7D16 20 FE       
0016+  7D18             
0016+  7D18             
0016+  7D18             
0016+  7D18~            		else
0016+  7D18~            		else
0016+  7D18~            		else
0016+  7D18~            		else
0016+  7D18~            		else
0016+  7D18             
0016+  7D18~            		else
0016+  7D18~            		else
0016+  7D18             
0016+  7D18~            		else
0016+  7D18~            		else
0016+  7D18             
0017+  7D18 17          			tBA	; replace 0 with blank/0
0018+  7D19             		endif
0018+  7D19             
0018+  7D19             
0018+  7D19             
0018+  7D19             
0018+  7D19             
0018+  7D19~            		endif
0018+  7D19~            		endif
0018+  7D19             
0018+  7D19~            		endif
0018+  7D19~            		endif
0018+  7D19             
0018+  7D17             
0018+  7D17 01          
0018+  7D18             
0018+  7D18             
0018+  7D18~            		endif
0018+  7D18~            		endif
0018+  7D18~            		endif
0018+  7D18             
0018+  7D19             
0018+  7D19~            		endif
0018+  7D19~            		endif
0018+  7D19             
0019+  7D19             	else
0019+  7D19             
0019+  7D19             
0019+  7D19             
0019+  7D19             
0019+  7D0C             
0019+  7D0C             
0019+  7D0C             
0019+  7D0C~            	else
0019+  7D0C~            	else
0019+  7D0C~            	else
0019+  7D0C~            	else
0019+  7D0C             
0019+  7D0C~            	else
0019+  7D0C~            	else
0019+  7D0C~            	else
0019+  7D0C~            	else
0019+  7D0C             
0019+  7D0C             
0019+  7D0C 0E          
0019+  7D19             
0019+  7D19 20 FE       
0019+  7D1B             
0019+  7D1B             
0019+  7D1B             
0019+  7D1B~            	else
0019+  7D1B~            	else
0019+  7D1B~            	else
0019+  7D1B~            	else
0019+  7D1B~            	else
0019+  7D1B             
0019+  7D1B~            	else
0019+  7D1B~            	else
0019+  7D1B             
0019+  7D1B~            	else
0019+  7D1B~            	else
0019+  7D1B             
0020+  7D1B 48          		aslA
0021+  7D1C 48          		aslA
0022+  7D1D 48          		aslA
0023+  7D1E 48          		aslA
0024+  7D1F C4 0F       		andB	00001111b ; mark upper half of B as 0 since number found
0025+  7D21 8A 0F       		oraA	00001111b
0026+  7D23             	endif
0026+  7D23             
0026+  7D23             
0026+  7D23             
0026+  7D23             
0026+  7D23             
0026+  7D23~            	endif
0026+  7D23~            	endif
0026+  7D23             
0026+  7D23~            	endif
0026+  7D23~            	endif
0026+  7D23             
0026+  7D1A             
0026+  7D1A 08          
0026+  7D1B             
0026+  7D1B             
0026+  7D1B~            	endif
0026+  7D1B~            	endif
0026+  7D1B~            	endif
0026+  7D1B             
0026+  7D23             
0026+  7D23~            	endif
0026+  7D23~            	endif
0026+  7D23             
0027+  7D23 A4 EC       	andA	pC_1m - displayBcd1, X
0028+  7D25             	
0029+  7D25             	;andA	$F0
0030+  7D25 85 0F       	bitA	00001111b
0031+  7D27             	ifeq ; pC is 0
0031+  7D27             
0031+  7D27 26 FE       
0032+  7D29 C5 0F       		bitB	1111b
0033+  7D2B             		ifne
0033+  7D2B             
0033+  7D2B 27 FE       
0034+  7D2D 8C 00 75    			cpX	displayBcd1 + 5
0035+  7D30             			ifeq
0035+  7D30             
0035+  7D30 26 FE       
0036+  7D32 C4 F0       				andB	11110000b
0037+  7D34             			else
0037+  7D34             
0037+  7D34             
0037+  7D34             
0037+  7D34             
0037+  7D31             
0037+  7D31             
0037+  7D31             
0037+  7D31~            			else
0037+  7D31~            			else
0037+  7D31~            			else
0037+  7D31~            			else
0037+  7D31             
0037+  7D31~            			else
0037+  7D31~            			else
0037+  7D31~            			else
0037+  7D31~            			else
0037+  7D31             
0037+  7D31             
0037+  7D31 04          
0037+  7D34             
0037+  7D34 20 FE       
0037+  7D36             
0037+  7D36             
0037+  7D36             
0037+  7D36~            			else
0037+  7D36~            			else
0037+  7D36~            			else
0037+  7D36~            			else
0037+  7D36~            			else
0037+  7D36             
0037+  7D36~            			else
0037+  7D36~            			else
0037+  7D36             
0037+  7D36~            			else
0037+  7D36~            			else
0037+  7D36             
0038+  7D36 8A 0F       				oraA	$F
0039+  7D38             			endif
0039+  7D38             
0039+  7D38             
0039+  7D38             
0039+  7D38             
0039+  7D38             
0039+  7D38~            			endif
0039+  7D38~            			endif
0039+  7D38             
0039+  7D38~            			endif
0039+  7D38~            			endif
0039+  7D38             
0039+  7D35             
0039+  7D35 02          
0039+  7D36             
0039+  7D36             
0039+  7D36~            			endif
0039+  7D36~            			endif
0039+  7D36~            			endif
0039+  7D36             
0039+  7D38             
0039+  7D38~            			endif
0039+  7D38~            			endif
0039+  7D38             
0040+  7D38             		endif
0040+  7D38             
0040+  7D38             
0040+  7D38             
0040+  7D38             
0040+  7D38             
0040+  7D38~            		endif
0040+  7D38~            		endif
0040+  7D38             
0040+  7D38~            		endif
0040+  7D38~            		endif
0040+  7D38             
0040+  7D2C             
0040+  7D2C 0B          
0040+  7D2D             
0040+  7D2D             
0040+  7D2D~            		endif
0040+  7D2D~            		endif
0040+  7D2D~            		endif
0040+  7D2D             
0040+  7D38             
0040+  7D38~            		endif
0040+  7D38~            		endif
0040+  7D38             
0041+  7D38             	else
0041+  7D38             
0041+  7D38             
0041+  7D38             
0041+  7D38             
0041+  7D28             
0041+  7D28             
0041+  7D28             
0041+  7D28~            	else
0041+  7D28~            	else
0041+  7D28~            	else
0041+  7D28~            	else
0041+  7D28             
0041+  7D28~            	else
0041+  7D28~            	else
0041+  7D28~            	else
0041+  7D28~            	else
0041+  7D28             
0041+  7D28             
0041+  7D28 11          
0041+  7D38             
0041+  7D38 20 FE       
0041+  7D3A             
0041+  7D3A             
0041+  7D3A             
0041+  7D3A~            	else
0041+  7D3A~            	else
0041+  7D3A~            	else
0041+  7D3A~            	else
0041+  7D3A~            	else
0041+  7D3A             
0041+  7D3A~            	else
0041+  7D3A~            	else
0041+  7D3A             
0041+  7D3A~            	else
0041+  7D3A~            	else
0041+  7D3A             
0042+  7D3A C4 F0       		andB	11110000b
0043+  7D3C             	endif
0043+  7D3C             
0043+  7D3C             
0043+  7D3C             
0043+  7D3C             
0043+  7D3C             
0043+  7D3C~            	endif
0043+  7D3C~            	endif
0043+  7D3C             
0043+  7D3C~            	endif
0043+  7D3C~            	endif
0043+  7D3C             
0043+  7D39             
0043+  7D39 02          
0043+  7D3A             
0043+  7D3A             
0043+  7D3A~            	endif
0043+  7D3A~            	endif
0043+  7D3A~            	endif
0043+  7D3A             
0043+  7D3C             
0043+  7D3C~            	endif
0043+  7D3C~            	endif
0043+  7D3C             
0044+  7D3C A7 00       	staA	0, X
0045+  7D3E             	
0046+  7D3E 08          	inX
0047+  7D3F 8C 00 76    	cpX	displayBcd1 + 6
0048+  7D42 26 C1       	bne 	copy13Loop
0049+  7D44             	
0050+  7D44 39          	rts
0051+  7D45             
0052+  7D45             copyScores24:
0053+  7D45 CE 00 78    	ldX	displayBcd1 + 8
0054+  7D48 C6 FF       	ldaB	$FF	; blank(F) until a number >0 is found then 0
0055+  7D4A             copy24Loop:
0056+  7D4A A6 DE       	ldaA	pB_1m - (displayBcd1 + 8), X
0057+  7D4C 84 0F       	andA	$0F
0058+  7D4E 81 00       	cmpA	$00 ; is pA score 0?
0059+  7D50             	ifeq ; if pA score = 0?
0059+  7D50             
0059+  7D50 26 FE       
0060+  7D52 8C 00 7D    		cpX	displayBcd1 + 8 + 5
0061+  7D55             		ifeq
0061+  7D55             
0061+  7D55 26 FE       
0062+  7D57 C4 0F       			andB	00001111b 
0063+  7D59 86 0F       			ldaA	$0F
0064+  7D5B             		else
0064+  7D5B             
0064+  7D5B             
0064+  7D5B             
0064+  7D5B             
0064+  7D56             
0064+  7D56             
0064+  7D56             
0064+  7D56~            		else
0064+  7D56~            		else
0064+  7D56~            		else
0064+  7D56~            		else
0064+  7D56             
0064+  7D56~            		else
0064+  7D56~            		else
0064+  7D56~            		else
0064+  7D56~            		else
0064+  7D56             
0064+  7D56             
0064+  7D56 06          
0064+  7D5B             
0064+  7D5B 20 FE       
0064+  7D5D             
0064+  7D5D             
0064+  7D5D             
0064+  7D5D~            		else
0064+  7D5D~            		else
0064+  7D5D~            		else
0064+  7D5D~            		else
0064+  7D5D~            		else
0064+  7D5D             
0064+  7D5D~            		else
0064+  7D5D~            		else
0064+  7D5D             
0064+  7D5D~            		else
0064+  7D5D~            		else
0064+  7D5D             
0065+  7D5D 17          			tBA	; replace 0 with blank/0
0066+  7D5E             		endif
0066+  7D5E             
0066+  7D5E             
0066+  7D5E             
0066+  7D5E             
0066+  7D5E             
0066+  7D5E~            		endif
0066+  7D5E~            		endif
0066+  7D5E             
0066+  7D5E~            		endif
0066+  7D5E~            		endif
0066+  7D5E             
0066+  7D5C             
0066+  7D5C 01          
0066+  7D5D             
0066+  7D5D             
0066+  7D5D~            		endif
0066+  7D5D~            		endif
0066+  7D5D~            		endif
0066+  7D5D             
0066+  7D5E             
0066+  7D5E~            		endif
0066+  7D5E~            		endif
0066+  7D5E             
0067+  7D5E             	else
0067+  7D5E             
0067+  7D5E             
0067+  7D5E             
0067+  7D5E             
0067+  7D51             
0067+  7D51             
0067+  7D51             
0067+  7D51~            	else
0067+  7D51~            	else
0067+  7D51~            	else
0067+  7D51~            	else
0067+  7D51             
0067+  7D51~            	else
0067+  7D51~            	else
0067+  7D51~            	else
0067+  7D51~            	else
0067+  7D51             
0067+  7D51             
0067+  7D51 0E          
0067+  7D5E             
0067+  7D5E 20 FE       
0067+  7D60             
0067+  7D60             
0067+  7D60             
0067+  7D60~            	else
0067+  7D60~            	else
0067+  7D60~            	else
0067+  7D60~            	else
0067+  7D60~            	else
0067+  7D60             
0067+  7D60~            	else
0067+  7D60~            	else
0067+  7D60             
0067+  7D60~            	else
0067+  7D60~            	else
0067+  7D60             
0068+  7D60 48          		aslA
0069+  7D61 48          		aslA
0070+  7D62 48          		aslA
0071+  7D63 48          		aslA
0072+  7D64 C4 0F       		andB	00001111b ; mark upper half of B as 0 since number found
0073+  7D66 8A 0F       		oraA	00001111b
0074+  7D68             	endif
0074+  7D68             
0074+  7D68             
0074+  7D68             
0074+  7D68             
0074+  7D68             
0074+  7D68~            	endif
0074+  7D68~            	endif
0074+  7D68             
0074+  7D68~            	endif
0074+  7D68~            	endif
0074+  7D68             
0074+  7D5F             
0074+  7D5F 08          
0074+  7D60             
0074+  7D60             
0074+  7D60~            	endif
0074+  7D60~            	endif
0074+  7D60~            	endif
0074+  7D60             
0074+  7D68             
0074+  7D68~            	endif
0074+  7D68~            	endif
0074+  7D68             
0075+  7D68 A4 EA       	andA	pD_1m - (displayBcd1 + 8), X
0076+  7D6A             	;andA	$F0
0077+  7D6A 85 0F       	bitA	00001111b
0078+  7D6C             	ifeq ; pC is 0
0078+  7D6C             
0078+  7D6C 26 FE       
0079+  7D6E C5 0F       		bitB	1111b
0080+  7D70             		ifne
0080+  7D70             
0080+  7D70 27 FE       
0081+  7D72 8C 00 7D    			cpX	displayBcd1 + 8 + 5
0082+  7D75             			ifeq
0082+  7D75             
0082+  7D75 26 FE       
0083+  7D77 C4 F0       				andB	11110000b
0084+  7D79             			else
0084+  7D79             
0084+  7D79             
0084+  7D79             
0084+  7D79             
0084+  7D76             
0084+  7D76             
0084+  7D76             
0084+  7D76~            			else
0084+  7D76~            			else
0084+  7D76~            			else
0084+  7D76~            			else
0084+  7D76             
0084+  7D76~            			else
0084+  7D76~            			else
0084+  7D76~            			else
0084+  7D76~            			else
0084+  7D76             
0084+  7D76             
0084+  7D76 04          
0084+  7D79             
0084+  7D79 20 FE       
0084+  7D7B             
0084+  7D7B             
0084+  7D7B             
0084+  7D7B~            			else
0084+  7D7B~            			else
0084+  7D7B~            			else
0084+  7D7B~            			else
0084+  7D7B~            			else
0084+  7D7B             
0084+  7D7B~            			else
0084+  7D7B~            			else
0084+  7D7B             
0084+  7D7B~            			else
0084+  7D7B~            			else
0084+  7D7B             
0085+  7D7B 8A 0F       				oraA	$F
0086+  7D7D             			endif
0086+  7D7D             
0086+  7D7D             
0086+  7D7D             
0086+  7D7D             
0086+  7D7D             
0086+  7D7D~            			endif
0086+  7D7D~            			endif
0086+  7D7D             
0086+  7D7D~            			endif
0086+  7D7D~            			endif
0086+  7D7D             
0086+  7D7A             
0086+  7D7A 02          
0086+  7D7B             
0086+  7D7B             
0086+  7D7B~            			endif
0086+  7D7B~            			endif
0086+  7D7B~            			endif
0086+  7D7B             
0086+  7D7D             
0086+  7D7D~            			endif
0086+  7D7D~            			endif
0086+  7D7D             
0087+  7D7D             		endif
0087+  7D7D             
0087+  7D7D             
0087+  7D7D             
0087+  7D7D             
0087+  7D7D             
0087+  7D7D~            		endif
0087+  7D7D~            		endif
0087+  7D7D             
0087+  7D7D~            		endif
0087+  7D7D~            		endif
0087+  7D7D             
0087+  7D71             
0087+  7D71 0B          
0087+  7D72             
0087+  7D72             
0087+  7D72~            		endif
0087+  7D72~            		endif
0087+  7D72~            		endif
0087+  7D72             
0087+  7D7D             
0087+  7D7D~            		endif
0087+  7D7D~            		endif
0087+  7D7D             
0088+  7D7D             	else
0088+  7D7D             
0088+  7D7D             
0088+  7D7D             
0088+  7D7D             
0088+  7D6D             
0088+  7D6D             
0088+  7D6D             
0088+  7D6D~            	else
0088+  7D6D~            	else
0088+  7D6D~            	else
0088+  7D6D~            	else
0088+  7D6D             
0088+  7D6D~            	else
0088+  7D6D~            	else
0088+  7D6D~            	else
0088+  7D6D~            	else
0088+  7D6D             
0088+  7D6D             
0088+  7D6D 11          
0088+  7D7D             
0088+  7D7D 20 FE       
0088+  7D7F             
0088+  7D7F             
0088+  7D7F             
0088+  7D7F~            	else
0088+  7D7F~            	else
0088+  7D7F~            	else
0088+  7D7F~            	else
0088+  7D7F~            	else
0088+  7D7F             
0088+  7D7F~            	else
0088+  7D7F~            	else
0088+  7D7F             
0088+  7D7F~            	else
0088+  7D7F~            	else
0088+  7D7F             
0089+  7D7F C4 F0       		andB	11110000b
0090+  7D81             	endif
0090+  7D81             
0090+  7D81             
0090+  7D81             
0090+  7D81             
0090+  7D81             
0090+  7D81~            	endif
0090+  7D81~            	endif
0090+  7D81             
0090+  7D81~            	endif
0090+  7D81~            	endif
0090+  7D81             
0090+  7D7E             
0090+  7D7E 02          
0090+  7D7F             
0090+  7D7F             
0090+  7D7F~            	endif
0090+  7D7F~            	endif
0090+  7D7F~            	endif
0090+  7D7F             
0090+  7D81             
0090+  7D81~            	endif
0090+  7D81~            	endif
0090+  7D81             
0091+  7D81 A7 00       	staA  0, X 
0092+  7D83             	
0093+  7D83 08          	inX
0094+  7D84 8C 00 7E    	cpX	displayBcd1 + 14
0095+  7D87 26 C1       	bne copy24Loop	
0096+  7D89             	
0097+  7D89 39          	rts
0098+  7D8A             	
0099+  7D8A             blankNonPlayerScores:
0100+  7D8A D6 0F       	ldaB	>lc(8) ; gameover
0101+  7D8C C5 20       	bitB	lr(6)
0102+  7D8E             	ifne
0102+  7D8E             
0102+  7D8E 27 FE       
0103+  7D90 39          		rts
0104+  7D91             	endif
0104+  7D91             
0104+  7D91             
0104+  7D91             
0104+  7D91             
0104+  7D91             
0104+  7D91~            	endif
0104+  7D91~            	endif
0104+  7D91             
0104+  7D91~            	endif
0104+  7D91~            	endif
0104+  7D91             
0104+  7D8F             
0104+  7D8F 01          
0104+  7D90             
0104+  7D90             
0104+  7D90~            	endif
0104+  7D90~            	endif
0104+  7D90~            	endif
0104+  7D90             
0104+  7D91             
0104+  7D91~            	endif
0104+  7D91~            	endif
0104+  7D91             
0105+  7D91             	
0106+  7D91 D6 0E       	ldaB	>lc(7)
0107+  7D93 C5 02       	bitB	lr(2)
0108+  7D95 26 1A       	bne	blankP2
0109+  7D97 C5 04       	bitB	lr(3)
0110+  7D99 26 22       	bne	blankP3
0111+  7D9B C5 08       	bitB	lr(4)
0112+  7D9D 26 2A       	bne	blankP4
0113+  7D9F C5 10       	bitB	lr(5)
0114+  7DA1 26 32       	bne	blankDone
0115+  7DA3 20 00       	bra	blankP1
0116+  7DA5             blankP1:
0117+  7DA5 86 F0       	ldaA	$F0
0118+  7DA7 9A 74       	oraA	>displayBcd1 + 4
0119+  7DA9 97 74       	staA	displayBcd1 + 4
0120+  7DAB 86 F0       	ldaA	$F0
0121+  7DAD 9A 75       	oraA	>displayBcd1 + 5
0122+  7DAF 97 75       	staA	displayBcd1 + 5
0123+  7DB1             blankP2:
0124+  7DB1 86 F0       	ldaA	$F0
0125+  7DB3 9A 7C       	oraA	>displayBcd1 + 12
0126+  7DB5 97 7C       	staA	displayBcd1 + 12
0127+  7DB7 86 F0       	ldaA	$F0
0128+  7DB9 9A 7D       	oraA	>displayBcd1 + 13
0129+  7DBB 97 7D       	staA	displayBcd1 + 13
0130+  7DBD             blankP3:
0131+  7DBD 86 0F       	ldaA	$0F
0132+  7DBF 9A 74       	oraA	>displayBcd1 + 4
0133+  7DC1 97 74       	staA	displayBcd1 + 4
0134+  7DC3 86 0F       	ldaA	$0F
0135+  7DC5 9A 75       	oraA	>displayBcd1 + 5
0136+  7DC7 97 75       	staA	displayBcd1 + 5
0137+  7DC9             blankP4:
0138+  7DC9 86 0F       	ldaA	$0F
0139+  7DCB 9A 7C       	oraA	>displayBcd1 + 12
0140+  7DCD 97 7C       	staA	displayBcd1 + 12
0141+  7DCF 86 0F       	ldaA	$0F
0142+  7DD1 9A 7D       	oraA	>displayBcd1 + 13
0143+  7DD3 97 7D       	staA	displayBcd1 + 13
0144+  7DD5             blankDone:
0145+  7DD5 39          	rts
0146+  7DD6             	
0147+  7DD6             refreshPlayerScores:
0148+  7DD6 BD 7D 00    	jsr copyScores13
0149+  7DD9 BD 7D 45    	jsr copyScores24
0150+  7DDC             	
0151+  7DDC 86 F0       	ldaA	$F0
0152+  7DDE B1 01 50    	cmpA	>pA_1m
0153+  7DE1 26 29       	bne	refresh_1m
0154+  7DE3 B1 01 56    	cmpA	>pB_1m
0155+  7DE6 26 24       	bne	refresh_1m	
0156+  7DE8 B1 01 5C    	cmpA	>pC_1m
0157+  7DEB 26 1F       	bne	refresh_1m
0158+  7DED B1 01 62    	cmpA	>pD_1m
0159+  7DF0 26 1A       	bne	refresh_1m
0160+  7DF2             	
0161+  7DF2 CE 00 70    	ldX	displayBcd1
0162+  7DF5             refresh_10xloop:
0163+  7DF5 A6 01       	ldaA	1, X
0164+  7DF7 A7 00       	staA	0,X
0165+  7DF9 A6 09       	ldaA	8 + 1, X
0166+  7DFB A7 08       	staA	8, X
0167+  7DFD 08          	inX
0168+  7DFE 8C 00 75    	cpX	displayBcd1+5
0169+  7E01 26 F2       	bne	refresh_10xloop
0170+  7E03 86 00       	ldaA	0
0171+  7E05 97 75       	staA	displayBcd1 + 5
0172+  7E07 97 7D       	staA	displayBcd1 + 5 + 8
0173+  7E09 7E 7D 8A    	jmp blankNonPlayerScores
0174+  7E0C             refresh_1m:
0175+  7E0C 7E 7D 8A    	jmp blankNonPlayerScores
0176+  7E0F             	
0177+  7E0F             	
0178+  7E0F             ; add score instantly
0179+  7E0F             ; X = place in p*_1* to add the score to
0180+  7E0F             ; A = amount to add (max 9)
0181+  7E0F             ; tail call
0182+  7E0F             _addScoreI:
0183+  7E0F AB 00       	addA	0, X
0184+  7E11 8A F0       	oraA	11110000b
0185+  7E13             	ifcs ; overflowed, need to increment next number
0185+  7E13             
0185+  7E13 24 FE       
0186+  7E15 8B 06       		addA	6	; adjust A back into BCD
0187+  7E17 A7 00       		staA	0, X
0188+  7E19             addScore_carryOver:		; loop to propagate carry
0189+  7E19 09          		deX	; go to next decimal place
0190+  7E1A A6 00       		ldaA	0, X	
0191+  7E1C 8A F0       		oraA	11110000b
0192+  7E1E 81 F9       		cmpA	$F9
0193+  7E20             		ifeq			; if it's already a 9, reset it and carry again
0193+  7E20             
0193+  7E20 26 FE       
0194+  7E22 6F 00       			clr	0, X
0195+  7E24 27 F3       			beq addScore_carryOver
0196+  7E26             		else			; otherwise ++ it and done
0196+  7E26             
0196+  7E26             
0196+  7E26             
0196+  7E26             
0196+  7E21             
0196+  7E21             
0196+  7E21             
0196+  7E21~            		else			; otherwise ++ it and done
0196+  7E21~            		else			; otherwise ++ it and done
0196+  7E21~            		else			; otherwise ++ it and done
0196+  7E21~            		else			; otherwise ++ it and done
0196+  7E21             
0196+  7E21~            		else			; otherwise ++ it and done
0196+  7E21~            		else			; otherwise ++ it and done
0196+  7E21~            		else			; otherwise ++ it and done
0196+  7E21~            		else			; otherwise ++ it and done
0196+  7E21             
0196+  7E21             
0196+  7E21 06          
0196+  7E26             
0196+  7E26 20 FE       
0196+  7E28             
0196+  7E28             
0196+  7E28             
0196+  7E28~            		else			; otherwise ++ it and done
0196+  7E28~            		else			; otherwise ++ it and done
0196+  7E28~            		else			; otherwise ++ it and done
0196+  7E28~            		else			; otherwise ++ it and done
0196+  7E28~            		else			; otherwise ++ it and done
0196+  7E28             
0196+  7E28~            		else			; otherwise ++ it and done
0196+  7E28~            		else			; otherwise ++ it and done
0196+  7E28             
0196+  7E28~            		else			; otherwise ++ it and done
0196+  7E28~            		else			; otherwise ++ it and done
0196+  7E28             
0197+  7E28 6C 00       			inc	0, X
0198+  7E2A             		endif	
0198+  7E2A             
0198+  7E2A             
0198+  7E2A             
0198+  7E2A             
0198+  7E2A             
0198+  7E2A~            		endif	
0198+  7E2A~            		endif	
0198+  7E2A             
0198+  7E2A~            		endif	
0198+  7E2A~            		endif	
0198+  7E2A             
0198+  7E27             
0198+  7E27 02          
0198+  7E28             
0198+  7E28             
0198+  7E28~            		endif	
0198+  7E28~            		endif	
0198+  7E28~            		endif	
0198+  7E28             
0198+  7E2A             
0198+  7E2A~            		endif	
0198+  7E2A~            		endif	
0198+  7E2A             
0199+  7E2A             	else
0199+  7E2A             
0199+  7E2A             
0199+  7E2A             
0199+  7E2A             
0199+  7E14             
0199+  7E14             
0199+  7E14             
0199+  7E14~            	else
0199+  7E14~            	else
0199+  7E14~            	else
0199+  7E14~            	else
0199+  7E14             
0199+  7E14~            	else
0199+  7E14~            	else
0199+  7E14~            	else
0199+  7E14~            	else
0199+  7E14             
0199+  7E14             
0199+  7E14 17          
0199+  7E2A             
0199+  7E2A 20 FE       
0199+  7E2C             
0199+  7E2C             
0199+  7E2C             
0199+  7E2C~            	else
0199+  7E2C~            	else
0199+  7E2C~            	else
0199+  7E2C~            	else
0199+  7E2C~            	else
0199+  7E2C             
0199+  7E2C~            	else
0199+  7E2C~            	else
0199+  7E2C             
0199+  7E2C~            	else
0199+  7E2C~            	else
0199+  7E2C             
0200+  7E2C 81 F9       		cmpA	$F9
0201+  7E2E             		ifgt ; >9 -> need to adjust back into BCD
0201+  7E2E             
0201+  7E2E 23 FE       
0202+  7E30 8B 06       			addA	6
0203+  7E32 A7 00       			staA	0, X
0204+  7E34             addScore_carryDa:
0205+  7E34 09          			deX
0206+  7E35 A6 00       			ldaA	0, X
0207+  7E37 8A F0       			oraA	11110000b
0208+  7E39 81 F9       			cmpA	$F9
0209+  7E3B             			ifeq
0209+  7E3B             
0209+  7E3B 26 FE       
0210+  7E3D 6F 00       				clr	0, X
0211+  7E3F 27 F3       				beq 	addScore_carryDa
0212+  7E41             			else
0212+  7E41             
0212+  7E41             
0212+  7E41             
0212+  7E41             
0212+  7E3C             
0212+  7E3C             
0212+  7E3C             
0212+  7E3C~            			else
0212+  7E3C~            			else
0212+  7E3C~            			else
0212+  7E3C~            			else
0212+  7E3C             
0212+  7E3C~            			else
0212+  7E3C~            			else
0212+  7E3C~            			else
0212+  7E3C~            			else
0212+  7E3C             
0212+  7E3C             
0212+  7E3C 06          
0212+  7E41             
0212+  7E41 20 FE       
0212+  7E43             
0212+  7E43             
0212+  7E43             
0212+  7E43~            			else
0212+  7E43~            			else
0212+  7E43~            			else
0212+  7E43~            			else
0212+  7E43~            			else
0212+  7E43             
0212+  7E43~            			else
0212+  7E43~            			else
0212+  7E43             
0212+  7E43~            			else
0212+  7E43~            			else
0212+  7E43             
0213+  7E43 6C 00       				inc	0, X
0214+  7E45             			endif	
0214+  7E45             
0214+  7E45             
0214+  7E45             
0214+  7E45             
0214+  7E45             
0214+  7E45~            			endif	
0214+  7E45~            			endif	
0214+  7E45             
0214+  7E45~            			endif	
0214+  7E45~            			endif	
0214+  7E45             
0214+  7E42             
0214+  7E42 02          
0214+  7E43             
0214+  7E43             
0214+  7E43~            			endif	
0214+  7E43~            			endif	
0214+  7E43~            			endif	
0214+  7E43             
0214+  7E45             
0214+  7E45~            			endif	
0214+  7E45~            			endif	
0214+  7E45             
0215+  7E45             		else
0215+  7E45             
0215+  7E45             
0215+  7E45             
0215+  7E45             
0215+  7E2F             
0215+  7E2F             
0215+  7E2F             
0215+  7E2F~            		else
0215+  7E2F~            		else
0215+  7E2F~            		else
0215+  7E2F~            		else
0215+  7E2F             
0215+  7E2F~            		else
0215+  7E2F~            		else
0215+  7E2F~            		else
0215+  7E2F~            		else
0215+  7E2F             
0215+  7E2F             
0215+  7E2F 17          
0215+  7E45             
0215+  7E45 20 FE       
0215+  7E47             
0215+  7E47             
0215+  7E47             
0215+  7E47~            		else
0215+  7E47~            		else
0215+  7E47~            		else
0215+  7E47~            		else
0215+  7E47~            		else
0215+  7E47             
0215+  7E47~            		else
0215+  7E47~            		else
0215+  7E47             
0215+  7E47~            		else
0215+  7E47~            		else
0215+  7E47             
0216+  7E47 A7 00       			staA	0, X
0217+  7E49             		endif
0217+  7E49             
0217+  7E49             
0217+  7E49             
0217+  7E49             
0217+  7E49             
0217+  7E49~            		endif
0217+  7E49~            		endif
0217+  7E49             
0217+  7E49~            		endif
0217+  7E49~            		endif
0217+  7E49             
0217+  7E46             
0217+  7E46 02          
0217+  7E47             
0217+  7E47             
0217+  7E47~            		endif
0217+  7E47~            		endif
0217+  7E47~            		endif
0217+  7E47             
0217+  7E49             
0217+  7E49~            		endif
0217+  7E49~            		endif
0217+  7E49             
0218+  7E49             	endif
0218+  7E49             
0218+  7E49             
0218+  7E49             
0218+  7E49             
0218+  7E49             
0218+  7E49~            	endif
0218+  7E49~            	endif
0218+  7E49             
0218+  7E49~            	endif
0218+  7E49~            	endif
0218+  7E49             
0218+  7E2B             
0218+  7E2B 1D          
0218+  7E2C             
0218+  7E2C             
0218+  7E2C~            	endif
0218+  7E2C~            	endif
0218+  7E2C~            	endif
0218+  7E2C             
0218+  7E49             
0218+  7E49~            	endif
0218+  7E49~            	endif
0218+  7E49             
0219+  7E49             
0220+  7E49 7E 7D D6    	jmp refreshPlayerScores
0221+  7E4C             	
0222+  7E4C 39          	rts
0223+  7E4D             	
0224+  7E4D             ; t A,X
0225+  7E4D             setXToCurPlayer10:
0226+  7E4D 96 0F       	ldaA	>lc(8)
0227+  7E4F 85 01       	bitA	0001b
0228+  7E51 27 04       	beq	_addScore10N_p2
0229+  7E53 CE 01 55    	ldX	pA_10
0230+  7E56 39          	rts
0231+  7E57             _addScore10N_p2:
0232+  7E57 85 02       	bitA	0010b
0233+  7E59 27 04       	beq	_addScore10N_p3
0234+  7E5B CE 01 5B    	ldX	pB_10
0235+  7E5E 39          	rts
0236+  7E5F             _addScore10N_p3:
0237+  7E5F 85 04       	bitA	0100b
0238+  7E61 27 04       	beq	_addScore10N_p4
0239+  7E63 CE 01 61    	ldX	pC_10
0240+  7E66 39          	rts
0241+  7E67             _addScore10N_p4:
0242+  7E67 CE 01 67    	ldX	pD_10
0243+  7E6A 39          	rts
0244+  7E6B             
0245+  7E6B             ; suspends execution for A ms and returns to queue processor
0246+  7E6B             ; should only be called from switch callbacks
0247+  7E6B             ; trashes everything but B
0248+  7E6B             _delay:	
0249+  7E6B CE 00 7F    	ldX	waitLeft - 1
0250+  7E6E             delay_findEmptyLoop:
0251+  7E6E 08          	inX
0252+  7E6F 6D 00       	tst	0, X
0253+  7E71 26 FB       	bne 	delay_findEmptyLoop 
0254+  7E73             	
0255+  7E73             	; X = first waitLeft that = 0
0256+  7E73 E7 18       	staB	waitReg - waitLeft, X
0257+  7E75 33          	pulB	; A = MSB of PC
0258+  7E76 E7 08       	staB	waitMsb - waitLeft, X
0259+  7E78 33          	pulB	; A = LSB of PC
0260+  7E79 E7 10       	staB	waitLsb - waitLeft, X
0261+  7E7B A7 00       	staA	0, X
0262+  7E7D             	; time and add stored
0263+  7E7D 7E 7A 37    	jmp skipEvent
0264+  7E80             	
0265+  7E80             _fork:	
0266+  7E80 CE 00 7F    	ldX	waitLeft - 1
0267+  7E83             fork_findEmptyLoop:
0268+  7E83 08          	inX
0269+  7E84 6D 00       	tst	0, X
0270+  7E86 26 FB       	bne 	fork_findEmptyLoop 
0271+  7E88             	
0272+  7E88             	; X = first waitLeft that = 0
0273+  7E88 E7 18       	staB	waitReg - waitLeft, X
0274+  7E8A 33          	pulB	; A = MSB of PC
0275+  7E8B E7 08       	staB	waitMsb - waitLeft, X
0276+  7E8D 33          	pulB	; A = LSB of PC
0277+  7E8E CB 03       	addB	3
0278+  7E90             	ifcs
0278+  7E90             
0278+  7E90 24 FE       
0279+  7E92 6C 08       		inc	waitMsb - waitLeft, X
0280+  7E94             	endif
0280+  7E94             
0280+  7E94             
0280+  7E94             
0280+  7E94             
0280+  7E94             
0280+  7E94~            	endif
0280+  7E94~            	endif
0280+  7E94             
0280+  7E94~            	endif
0280+  7E94~            	endif
0280+  7E94             
0280+  7E91             
0280+  7E91 02          
0280+  7E92             
0280+  7E92             
0280+  7E92~            	endif
0280+  7E92~            	endif
0280+  7E92~            	endif
0280+  7E92             
0280+  7E94             
0280+  7E94~            	endif
0280+  7E94~            	endif
0280+  7E94             
0281+  7E94 E7 10       	staB	waitLsb - waitLeft, X
0282+  7E96 A7 00       	staA	0, X
0283+  7E98             	; time and add stored
0284+  7E98 C0 03       	subB	3
0285+  7E9A 37          	pshB
0286+  7E9B E6 08       	ldaB	waitMsb - waitLeft, X
0287+  7E9D             	ifcs
0287+  7E9D             
0287+  7E9D 24 FE       
0288+  7E9F 5A          		decB
0289+  7EA0             	endif
0289+  7EA0             
0289+  7EA0             
0289+  7EA0             
0289+  7EA0             
0289+  7EA0             
0289+  7EA0~            	endif
0289+  7EA0~            	endif
0289+  7EA0             
0289+  7EA0~            	endif
0289+  7EA0~            	endif
0289+  7EA0             
0289+  7E9E             
0289+  7E9E 01          
0289+  7E9F             
0289+  7E9F             
0289+  7E9F~            	endif
0289+  7E9F~            	endif
0289+  7E9F~            	endif
0289+  7E9F             
0289+  7EA0             
0289+  7EA0~            	endif
0289+  7EA0~            	endif
0289+  7EA0             
0290+  7EA0 37          	pshB
0291+  7EA1 39          	rts
0292+  7EA2             	
0293+  7EA2             	
0294+  7EA2             	
0295+  7EA2             resetScores:
0296+  7EA2 86 00       	ldaA	00
0297+  7EA4 CE 01 50    	ldX	pA_1m
0298+  7EA7             _zeroScores:
0299+  7EA7 A7 00       	staA	0, X
0300+  7EA9 08          	inX
0301+  7EAA 8C 01 68    	cpX	pD_10 + 1
0302+  7EAD 26 F8       	bne	_zeroScores
0303+  7EAF             	
0304+  7EAF 86 00       	ldaA	0
0305+  7EB1 97 12       	staA	curPlayer
0306+  7EB3 97 13       	staA	curPlayer + 1
0307+  7EB5 86 FF       	ldaA	$FF
0308+  7EB7 97 76       	staA	displayBcd1 + 6
0309+  7EB9 97 7E       	staA	displayBcd1 + 14
0310+  7EBB 97 7F       	staA	displayBcd1 + 15
0311+  7EBD             	
0312+  7EBD BD 7D D6    	jsr	refreshPlayerScores
0313+  7EC0 39          	rts
0314+  7EC1             
0315+  7EC1             ; trash ~B
0316+  7EC1             ; delay for ms (8-2000)
0317+  7EC1             #DEFINE delay(ms) ldaA ms/8\ jsr _delay
0318+  7EC1             ; makes a second thread that will skip the next (3b) instruction
0319+  7EC1             #DEFINE fork(ms) ldaA ms/8\ jsr _fork
0320+  7EC1             #DEFINE beginFork()	
0321+  7EC1             #DEFINE endFork()	ldX >forkX\ jmp afterFork
0322+  7EC1             	
0323+  7EC1             ; trashes B (max 104ms)
0324+  7EC1             #DEFINE fireSolenoid(s)	ldaB (s&$FF)/8\ staB solenoid1+(s>>8)-1 
0325+  7EC1             #DEFINE fireSolenoidA(s)	ldaA (s&$FF)/8\ staA solenoid1+(s>>8)-1 
0326+  7EC1             
0327+  7EC1             ; trashes AX
0328+  7EC1             ; place: 1-5 = 10s thru 100ks
0329+  7EC1             ; amount: 1-9
0330+  7EC1             #DEFINE addScoreI(place,amount)		ldX pB_10-place+1\ ldaA 0+amount\ jsr _addScoreI
0331+  7EC1             #DEFINE addScoreI_T(place,amount)	ldX pB_10-place+1\ ldaA 0+amount\ jmp _addScoreI
0332+  7EC1             #DEFINE addScore(place,amount)		ldX pB_10-place+1\ ldaA 0+amount\ jsr _addScore
0333+  7EC1             #DEFINE addScore_T(place,amount)	ldX pB_10-place+1\ ldaA 0+amount\ jmp _addScore
0334+  7EC1             #DEFINE addScoreN(place,amount)		ldX pB_10-place+1\ ldaA 0+amount\ jsr _addScoreN
0335+  7EC1             #DEFINE addScoreN_T(place,amount)	ldX pB_10-place+1\ ldaA 0+amount\ jmp _addScoreN
0336+  7EC1             
0337+  7EC1             #define disablePf ldaA 	>solenoidBC\ andA 11110111b\ staA solenoidBC
0338+  7EC1             #define enablePf ldaA 	>solenoidBC\ oraA 00111000b\ staA solenoidBC
0339+  7EC1             
0340+  7EC1             #define lampOn(r,c) ldaA lr(r)\ oraA >lc(c)\ staA lc(c)
0341+  7EC1             #define flashLamp(r,c) ldaA lr(r)\ oraA >flc(c)\ staA flc(c)
0342+  7EC1             #define lampOff(r,c) ldaA ~lr(r)\ andA >lc(c)\ staA lc(c)
0343+  7EC1             #define flashOff(r,c) ldaA ~lr(r)\ andA >flc(c)\ staA flc(c)
0344+  7EC1             
0345+  7EC1             #include "attract.asm"
0001++ 7EC1             attractStart:
0002++ 7EC1 08          	.db 00001000b
0003++ 7EC2 18          	.db 00011000b
0004++ 7EC3 10          	.db 00010000b
0005++ 7EC4 80          	.db 10000000b
0006++ 7EC5 01          	.db 00000001b
0007++ 7EC6             	
0008++ 7EC6 50          	.db 01010000b
0009++ 7EC7 40          	.db 01000000b
0010++ 7EC8 08          	.db 00001000b
0011++ 7EC9 80          	.db 10000000b
0012++ 7ECA 03          	.db 00000011b
0013++ 7ECB             	
0014++ 7ECB 20          	.db 00100000b
0015++ 7ECC 28          	.db 00101000b
0016++ 7ECD 04          	.db 00000100b
0017++ 7ECE 80          	.db 10000000b
0018++ 7ECF 07          	.db 00000111b
0019++ 7ED0             	
0020++ 7ED0 44          	.db 01000100b
0021++ 7ED1 80          	.db 10000000b
0022++ 7ED2 02          	.db 00000010b
0023++ 7ED3 80          	.db 10000000b
0024++ 7ED4 0F          	.db 00001111b
0025++ 7ED5             	
0026++ 7ED5 08          	.db 00001000b
0027++ 7ED6 18          	.db 00011000b
0028++ 7ED7 01          	.db 00000001b
0029++ 7ED8 80          	.db 10000000b
0030++ 7ED9 1F          	.db 00011111b
0031++ 7EDA             	
0032++ 7EDA 50          	.db 01010000b
0033++ 7EDB 40          	.db 01000000b
0034++ 7EDC 02          	.db 00000010b
0035++ 7EDD 80          	.db 10000000b
0036++ 7EDE 3F          	.db 00111111b
0037++ 7EDF             	
0038++ 7EDF 20          	.db 00100000b
0039++ 7EE0 28          	.db 00101000b
0040++ 7EE1 04          	.db 00000100b
0041++ 7EE2 80          	.db 10000000b
0042++ 7EE3 7F          	.db 01111111b
0043++ 7EE4             	
0044++ 7EE4 44          	.db 01000100b
0045++ 7EE5 80          	.db 10000000b
0046++ 7EE6 08          	.db 00001000b
0047++ 7EE7 80          	.db 10000000b
0048++ 7EE8 FF          	.db 11111111b
0049++ 7EE9             attractEnd:0006   7EE9             
0007   7EE9             #include "game.asm"
0001+  7EE9             ; Laser Ball solenoids
0002+  7EE9             ;#DEFINE KICKOUT 		01
0003+  7EE9             ;#DEFINE LEFT_KICKER 	02
0004+  7EE9             ;#DEFINE DROP_LA			03
0005+  7EE9             ;#DEFINE DROP_SER		04
0006+  7EE9             ;#DEFINE EJECT_HOLE		05
0007+  7EE9             ;#DEFINE DROP_BA			06
0008+  7EE9             ;#DEFINE DROP_LL			07
0009+  7EE9             ;#DEFINE RIGHT_KICKER	08
0010+  7EE9             ;#DEFINE SOUND1			09 ; thru 13
0011+  7EE9             ;#DEFINE KNOCKER			14
0012+  7EE9             ;#DEFINE	FLASHERS		15
0013+  7EE9             ;#DEFINE COIN_LOCKOUT	16
0014+  7EE9             
0015+  7EE9             ; Hot Tip solenoids
0016+  7EE9             #DEFINE SOL(n,t)	(n<<8)|t
0017+  7EE9             #DEFINE TOP_EJECT 	SOL(01, 24)
0018+  7EE9             #DEFINE DROP_TIP	SOL(02, 100)
0019+  7EE9             #DEFINE DROP_HOT	SOL(03, 100)
0020+  7EE9             #DEFINE LEFT_EJECT	SOL(04, 24)
0021+  7EE9             #DEFINE OUTHOLE		SOL(05, 20)
0022+  7EE9             #DEFINE CHIME_10	SOL(09, 16)
0023+  7EE9             #DEFINE CHIME_100	SOL(10, 16)
0024+  7EE9             #DEFINE CHIME_1000	SOL(11, 16)
0025+  7EE9             #DEFINE CHIME_10k	SOL(12, 16)
0026+  7EE9             #DEFINE CLICKER		SOL(13, 8)
0027+  7EE9             #DEFINE	KNOCKER		SOL(14, 50)
0028+  7EE9             #DEFINE BUZZER		SOL(15, 100)
0029+  7EE9             #DEFINE SHORT_PAUSE 	115
0030+  7EE9             
0031+  7EE9             #DEFINE noValidate ldaA 10b\ oraA >state\ staA state
0032+  7EE9             #DEFINE done(v)	\
0033+  7EE9             #DEFCONT	#IF (v==0)
0034+  7EE9             #DEFCONT		\ ldaA 10b
0035+  7EE9             #DEFCONT		\ oraA >state
0036+  7EE9             #DEFCONT		\ staA state
0037+  7EE9             #DEFCONT	\#ENDIF
0038+  7EE9             #DEFCONT	\ jmp afterQueueEvent
0039+  7EE9             	
0040+  7EE9             	
0041+  7EE9             _addScore10N:
0042+  7EE9 BD 7E 4D    	jsr setXToCurPlayer10
0043+  7EEC 86 01       	ldaA	1
0044+  7EEE BD 7E 0F    	jsr _addScoreI
0045+  7EF1 86 02       	fireSolenoidA(CHIME_10)
0045+  7EF3 B7 01 48    
0046+  7EF6 39          	rts
0047+  7EF7             _addScore100N:
0048+  7EF7 BD 7E 4D    	jsr setXToCurPlayer10
0049+  7EFA 09          	deX
0050+  7EFB 86 01       	ldaA	1
0051+  7EFD BD 7E 0F    	jsr _addScoreI
0052+  7F00 86 02       	fireSolenoidA(CHIME_100)	
0052+  7F02 B7 01 49    
0053+  7F05 39          	rts
0054+  7F06             _addScore1000N:
0055+  7F06 BD 7E 4D    	jsr setXToCurPlayer10
0056+  7F09 09          	deX
0057+  7F0A 09          	deX
0058+  7F0B 86 01       	ldaA	1
0059+  7F0D BD 7E 0F    	jsr _addScoreI
0060+  7F10 86 02       	fireSolenoidA(CHIME_1000)
0060+  7F12 B7 01 4A    
0061+  7F15 39          	rts
0062+  7F16             #DEFINE score10() jsr _addScore10N
0063+  7F16             #DEFINE score100() jsr _addScore100N
0064+  7F16             #DEFINE score1000() jsr _addScore1000N
0065+  7F16             #DEFINE score500() \ jsr _addScore100N
0066+  7F16             #DEFCONT	\ fireSolenoid(CHIME_100)	
0067+  7F16             #DEFCONT	\ delay(SHORT_PAUSE)
0068+  7F16             #DEFCONT	\ jsr _addScore100N
0069+  7F16             #DEFCONT	\ fireSolenoid(CHIME_100)	
0070+  7F16             #DEFCONT	\ delay(SHORT_PAUSE)
0071+  7F16             #DEFCONT	\ jsr _addScore100N
0072+  7F16             #DEFCONT	\ fireSolenoid(CHIME_100)	
0073+  7F16             #DEFCONT	\ delay(SHORT_PAUSE)
0074+  7F16             #DEFCONT	\ jsr _addScore100N
0075+  7F16             #DEFCONT	\ fireSolenoid(CHIME_100)	
0076+  7F16             #DEFCONT	\ delay(SHORT_PAUSE)
0077+  7F16             #DEFCONT	\ jsr _addScore100N
0078+  7F16             #DEFCONT	\ fireSolenoid(CHIME_100)	
0079+  7F16             #DEFCONT	\ delay(SHORT_PAUSE)
0080+  7F16             
0081+  7F16             #DEFINE advBonus()	jsr advanceBonus
0082+  7F16             
0083+  7F16             advanceBonus:
0084+  7F16             	;ldaA	1000b
0085+  7F16             	;bitA	>state
0086+  7F16             	;ifne
0087+  7F16             	;	rts
0088+  7F16             	;endif
0089+  7F16 7C 00 B0    	inc 	p_Bonus
0090+  7F19 86 7F       	lampOff(8,5) ; 1k
0090+  7F1B 94 0C       
0090+  7F1D 97 0C       
0091+  7F1F C6 02       	ldaB	2
0092+  7F21 86 08       	fork(64)
0092+  7F23 BD 7E 80    
0093+  7F26 39          	rts
0094+  7F27 01          	nop
0095+  7F28 01          	nop
0096+  7F29             	beginFork()
0097+  7F29             advanceBonus_loop:
0098+  7F29 7A 00 B0    	dec	p_Bonus
0099+  7F2C BD 60 C3    	jsr 	bonusLights
0100+  7F2F 7C 00 B0    	inc	p_Bonus
0101+  7F32 86 FE       	ldaA	11111110b
0102+  7F34             	
0103+  7F34 37          	pshB
0104+  7F35 5A          	decB
0105+  7F36             inner:
0106+  7F36 5A          	decB
0107+  7F37 27 04       	beq	innerEnd
0108+  7F39 0D          	seC
0109+  7F3A 49          	rolA
0110+  7F3B 20 F9       	bra 	inner
0111+  7F3D             innerEnd:
0112+  7F3D 33          	pulB
0113+  7F3E             	
0114+  7F3E 94 0D       	andA	>lc(6)
0115+  7F40 97 0D       	staA	lc(6)
0116+  7F42 86 08       	delay(64)
0116+  7F44 BD 7E 6B    
0117+  7F47 5C          	incB
0118+  7F48 D1 B0       	cmpB	>p_Bonus
0119+  7F4A 2D DD       	blt	advanceBonus_loop
0120+  7F4C D6 B0       	ldaB	>p_Bonus
0121+  7F4E BD 60 C3    	jsr 	bonusLights
0122+  7F51 DE 2C       	endFork()
0122+  7F53 7E 79 52    
0123+  7F56             	
0124+  7F56             ; switch callbacks:
0125+  7F56             
0126+  60C0             none:	.org $6000 + 192 ; size of callback table
0127+  60C0             	done(1)
0127+  60C0~            	done(1)
0127+  60C0~            	done(1)
0127+  60C0~            	done(1)
0127+  60C0~            	done(1)
0127+  60C0             
0127+  60C0 7E 79 E6    
0128+  60C3             	
0129+  60C3             bonusLights:
0130+  60C3 86 00       	ldaA	0
0131+  60C5 97 0C       	staA	lc(5)
0132+  60C7 97 0D       	staA	lc(6)
0133+  60C9 7D 00 B0    	tst	>p_Bonus
0134+  60CC 27 11       	beq	bonusLights_done
0135+  60CE             	
0136+  60CE 86 80       	lampOn(8,5) ; 1k
0136+  60D0 9A 0C       
0136+  60D2 97 0C       
0137+  60D4             	
0138+  60D4 96 B0       	ldaA	>p_Bonus
0139+  60D6             bonusLights_loop:
0140+  60D6 4A          	decA
0141+  60D7 27 06       	beq 	bonusLights_done
0142+  60D9 0D          	seC
0143+  60DA 79 00 0D    	rol	lc(6)
0144+  60DD 20 F7       	bra	bonusLights_loop
0145+  60DF             	
0146+  60DF             bonusLights_done
0147+  60DF             
0148+  60DF 86 09       	ldaA	9
0149+  60E1 91 B0       	cmpA	>p_Bonus
0150+  60E3             	ifge	
0150+  60E3             
0150+  60E3 25 FE       
0151+  60E5             	else	; bonus >= 10?
0151+  60E5             
0151+  60E5             
0151+  60E5             
0151+  60E5             
0151+  60E4             
0151+  60E4             
0151+  60E4             
0151+  60E4~            	else	; bonus >= 10?
0151+  60E4~            	else	; bonus >= 10?
0151+  60E4~            	else	; bonus >= 10?
0151+  60E4~            	else	; bonus >= 10?
0151+  60E4             
0151+  60E4~            	else	; bonus >= 10?
0151+  60E4~            	else	; bonus >= 10?
0151+  60E4~            	else	; bonus >= 10?
0151+  60E4~            	else	; bonus >= 10?
0151+  60E4             
0151+  60E4             
0151+  60E4 02          
0151+  60E5             
0151+  60E5 20 FE       
0151+  60E7             
0151+  60E7             
0151+  60E7             
0151+  60E7~            	else	; bonus >= 10?
0151+  60E7~            	else	; bonus >= 10?
0151+  60E7~            	else	; bonus >= 10?
0151+  60E7~            	else	; bonus >= 10?
0151+  60E7~            	else	; bonus >= 10?
0151+  60E7             
0151+  60E7~            	else	; bonus >= 10?
0151+  60E7~            	else	; bonus >= 10?
0151+  60E7             
0151+  60E7~            	else	; bonus >= 10?
0151+  60E7~            	else	; bonus >= 10?
0151+  60E7             
0152+  60E7 86 0A       		ldaA	10
0153+  60E9 97 B0       		staA	p_Bonus
0154+  60EB 86 40       		lampOn(7,5) ; 10k light
0154+  60ED 9A 0C       
0154+  60EF 97 0C       
0155+  60F1             	endif
0155+  60F1             
0155+  60F1             
0155+  60F1             
0155+  60F1             
0155+  60F1             
0155+  60F1~            	endif
0155+  60F1~            	endif
0155+  60F1             
0155+  60F1~            	endif
0155+  60F1~            	endif
0155+  60F1             
0155+  60E6             
0155+  60E6 0A          
0155+  60E7             
0155+  60E7             
0155+  60E7~            	endif
0155+  60E7~            	endif
0155+  60E7~            	endif
0155+  60E7             
0155+  60F1             
0155+  60F1~            	endif
0155+  60F1~            	endif
0155+  60F1             
0156+  60F1             	
0157+  60F1 39          	rts
0158+  60F2             	
0159+  60F2             	
0160+  60F2             startBall:
0161+  60F2 DE 12       	ldX	>curPlayer
0162+  60F4 86 01       	ldaA	1
0163+  60F6 97 B0       	staA	p_Bonus
0164+  60F8 86 80       	lampOn(8,5)
0164+  60FA 9A 0C       
0164+  60FC 97 0C       
0165+  60FE B6 22 03    	enablePf
0165+  6101 8A 38       
0165+  6103 B7 22 03    
0166+  6106             	
0167+  6106 86 00       	ldaA	0
0168+  6108 97 B5       	staA	p_DropsDown
0169+  610A 86 41       	ldaA	65
0170+  610C 97 A9       	staA	dropResetTimer
0171+  610E             	
0172+  610E 86 00       	ldaA	0
0173+  6110 97 AA       	staA	dropsDown
0174+  6112             	
0175+  6112 C6 0C       	fireSolenoid(DROP_HOT)
0175+  6114 F7 01 42    
0176+  6117 86 12       	delay(150)
0176+  6119 BD 7E 6B    
0177+  611C C6 0C       	fireSolenoid(DROP_TIP)
0177+  611E F7 01 41    
0178+  6121 86 12       	delay(150)
0178+  6123 BD 7E 6B    
0179+  6126             	
0180+  6126 86 FF       	ldaA	$FF
0181+  6128 97 A8       	staA	lastSwitch
0182+  612A             	
0183+  612A             	; clear lights
0184+  612A CE 00 08    	ldX	lampCol1
0185+  612D 86 00       	ldaA	0b
0186+  612F             lClearLights:
0187+  612F A7 00       	staA	0, X
0188+  6131 A7 98       	staA	flashLampCol1 - lampCol1, X
0189+  6133 08          	inX
0190+  6134 8C 00 0E    	cpX	lc(6) + 1
0191+  6137 26 F6       	bne	lClearLights
0192+  6139             	;
0193+  6139             	
0194+  6139             	; init lights for player data
0195+  6139 DE 12       	ldX	>curPlayer
0196+  613B A6 B1       	ldaA	p_Ejects, X
0197+  613D 97 0B       	staA	lc(4)
0198+  613F E6 B6       	ldaB	p_LampCol2, X
0199+  6141 C5 02       	bitB	lr(2)
0200+  6143             	ifne 
0200+  6143             
0200+  6143 27 FE       
0201+  6145 86 02       		lampOn(2,3)
0201+  6147 9A 0A       
0201+  6149 97 0A       
0202+  614B C4 FD       		andB	11111101b
0203+  614D             	endif
0203+  614D             
0203+  614D             
0203+  614D             
0203+  614D             
0203+  614D             
0203+  614D~            	endif
0203+  614D~            	endif
0203+  614D             
0203+  614D~            	endif
0203+  614D~            	endif
0203+  614D             
0203+  6144             
0203+  6144 08          
0203+  6145             
0203+  6145             
0203+  6145~            	endif
0203+  6145~            	endif
0203+  6145~            	endif
0203+  6145             
0203+  614D             
0203+  614D~            	endif
0203+  614D~            	endif
0203+  614D             
0204+  614D D7 09       	staB	lc(2)
0205+  614F             	
0206+  614F 86 40       	ldaA	lr(7) ; shoot again
0207+  6151 95 0F       	bitA	>lc(8)
0208+  6153             	ifne
0208+  6153             
0208+  6153 27 FE       
0209+  6155 86 01       		lampOn(1,3) ; shoot again
0209+  6157 9A 0A       
0209+  6159 97 0A       
0210+  615B             	endif
0210+  615B             
0210+  615B             
0210+  615B             
0210+  615B             
0210+  615B             
0210+  615B~            	endif
0210+  615B~            	endif
0210+  615B             
0210+  615B~            	endif
0210+  615B~            	endif
0210+  615B             
0210+  6154             
0210+  6154 06          
0210+  6155             
0210+  6155             
0210+  6155~            	endif
0210+  6155~            	endif
0210+  6155~            	endif
0210+  6155             
0210+  615B             
0210+  615B~            	endif
0210+  615B~            	endif
0210+  615B             
0211+  615B             	
0212+  615B             	; flash player light
0213+  615B 86 0F       	ldaA	00001111b ; player up lights
0214+  615D 9A A7       	oraA	>flc(8)
0215+  615F 97 A7       	staA	flc(8)
0216+  6161             	
0217+  6161 86 01       	ldaA	sr(1) ; check outhole
0218+  6163 95 21       	bitA	>sc(2)
0219+  6165             	ifne ; ball in hole
0219+  6165             
0219+  6165 27 FE       
0220+  6167 C6 02       		fireSolenoid(OUTHOLE)
0220+  6169 F7 01 44    
0221+  616C             	endif
0221+  616C             
0221+  616C             
0221+  616C             
0221+  616C             
0221+  616C             
0221+  616C~            	endif
0221+  616C~            	endif
0221+  616C             
0221+  616C~            	endif
0221+  616C~            	endif
0221+  616C             
0221+  6166             
0221+  6166 05          
0221+  6167             
0221+  6167             
0221+  6167~            	endif
0221+  6167~            	endif
0221+  6167~            	endif
0221+  6167             
0221+  616C             
0221+  616C~            	endif
0221+  616C~            	endif
0221+  616C             
0222+  616C             	
0223+  616C 39          	rts
0224+  616D             	
0225+  616D             	
0226+  616D             startGame:
0227+  616D 86 02       	lampOn(2,7) ; one player
0227+  616F 9A 0E       
0227+  6171 97 0E       
0228+  6173             	
0229+  6173 86 DF       	lampOff(6,8) ; game over
0229+  6175 94 0F       
0229+  6177 97 0F       
0230+  6179             	
0231+  6179 C6 02       	fireSolenoid(CHIME_10)
0231+  617B F7 01 48    
0232+  617E 86 0E       	delay(SHORT_PAUSE)
0232+  6180 BD 7E 6B    
0233+  6183 C6 02       	fireSolenoid(CHIME_10)
0233+  6185 F7 01 48    
0234+  6188 86 0E       	delay(SHORT_PAUSE)
0234+  618A BD 7E 6B    
0235+  618D C6 02       	fireSolenoid(CHIME_10)
0235+  618F F7 01 48    
0236+  6192 86 19       	delay(200)
0236+  6194 BD 7E 6B    
0237+  6197             	
0238+  6197 C6 02       	fireSolenoid(CHIME_10)
0238+  6199 F7 01 48    
0239+  619C 86 0E       	delay(SHORT_PAUSE)
0239+  619E BD 7E 6B    
0240+  61A1 C6 02       	fireSolenoid(CHIME_10)
0240+  61A3 F7 01 48    
0241+  61A6 86 0E       	delay(SHORT_PAUSE)
0241+  61A8 BD 7E 6B    
0242+  61AB C6 02       	fireSolenoid(CHIME_10)
0242+  61AD F7 01 48    
0243+  61B0 86 19       	delay(200)
0243+  61B2 BD 7E 6B    
0244+  61B5             	
0245+  61B5 C6 02       	fireSolenoid(CHIME_10)
0245+  61B7 F7 01 48    
0246+  61BA 86 0E       	delay(SHORT_PAUSE)
0246+  61BC BD 7E 6B    
0247+  61BF C6 02       	fireSolenoid(CHIME_10)
0247+  61C1 F7 01 48    
0248+  61C4 86 0E       	delay(SHORT_PAUSE)
0248+  61C6 BD 7E 6B    
0249+  61C9 C6 02       	fireSolenoid(CHIME_100)
0249+  61CB F7 01 49    
0250+  61CE 86 19       	delay(200)
0250+  61D0 BD 7E 6B    
0251+  61D3 C6 02       	fireSolenoid(CHIME_1000)
0251+  61D5 F7 01 4A    
0252+  61D8 86 19       	delay(200)
0252+  61DA BD 7E 6B    
0253+  61DD C6 02       	fireSolenoid(CHIME_10k)
0253+  61DF F7 01 4B    
0254+  61E2 86 12       	delay(150)
0254+  61E4 BD 7E 6B    
0255+  61E7             	
0256+  61E7             	; reset scores
0257+  61E7 BD 7E A2    	jsr 	resetScores
0258+  61EA             	
0259+  61EA             	; reset ball count
0260+  61EA 86 10       	ldaA	$10
0261+  61EC 97 77       	staA	ballCount	
0262+  61EE             
0263+  61EE C6 00       	ldaB	0
0264+  61F0 D7 13       	staB	curPlayer + 1
0265+  61F2             	
0266+  61F2 D7 0E       	staB	lc(7)
0267+  61F4 D7 0F       	staB	lc(8)
0268+  61F6 D7 A6       	staB	flc(7)
0269+  61F8 D7 A7       	staB	flc(8)
0270+  61FA             	
0271+  61FA CE 00 00    	ldX	0
0272+  61FD             lInitPlayers:
0273+  61FD C6 01       	ldaB	lr(1)
0274+  61FF E7 B1       	staB	p_Ejects, X
0275+  6201 C6 00       	ldaB	0
0276+  6203 E7 B6       	staB	p_LampCol2, X
0277+  6205 08          	inX
0278+  6206 8C 00 04    	cpX	4
0279+  6209 26 F2       	bne	lInitPlayers
0280+  620B             	
0281+  620B BD 60 F2    	jsr	startBall
0282+  620E             	
0283+  620E             	; invalidate playfield
0284+  620E 86 01       	ldaA	lr(1)
0285+  6210 9A 0F       	oraA	>lc(8)
0286+  6212 97 0F       	staA	lc(8)
0287+  6214             	
0288+  6214 86 02       	lampOn(2,7) ; one player
0288+  6216 9A 0E       
0288+  6218 97 0E       
0289+  621A             	
0290+  621A 86 DF       	lampOff(6,8) ; game over
0290+  621C 94 0F       
0290+  621E 97 0F       
0291+  6220             	
0292+  6220 39          	rts
0293+  6221             	
0294+  6221             
0295+  6221             	
0296+  6221             swTilt: 
0297+  6221 86 10       	lampOn(5,8) ; tilt
0297+  6223 9A 0F       
0297+  6225 97 0F       
0298+  6227 B6 22 03    	disablePf
0298+  622A 84 F7       
0298+  622C B7 22 03    
0299+  622F             	done(0)
0299+  622F             
0299+  622F 86 02       
0299+  6231 BA 01 6B    
0299+  6234 B7 01 6B    
0299+  6237             
0299+  6237 7E 79 E6    
0300+  623A             	
0301+  623A             swStart: 
0302+  623A 96 0F       	ldaA >lc(8)
0303+  623C 85 20       	bitA lr(6)
0304+  623E             	ifne ; in game over
0304+  623E             
0304+  623E 27 FE       
0305+  6240 BD 61 6D    		jsr startGame
0306+  6243             	else 
0306+  6243             
0306+  6243             
0306+  6243             
0306+  6243             
0306+  623F             
0306+  623F             
0306+  623F             
0306+  623F~            	else 
0306+  623F~            	else 
0306+  623F~            	else 
0306+  623F~            	else 
0306+  623F             
0306+  623F~            	else 
0306+  623F~            	else 
0306+  623F~            	else 
0306+  623F~            	else 
0306+  623F             
0306+  623F             
0306+  623F 05          
0306+  6243             
0306+  6243 20 FE       
0306+  6245             
0306+  6245             
0306+  6245             
0306+  6245~            	else 
0306+  6245~            	else 
0306+  6245~            	else 
0306+  6245~            	else 
0306+  6245~            	else 
0306+  6245             
0306+  6245~            	else 
0306+  6245~            	else 
0306+  6245             
0306+  6245~            	else 
0306+  6245~            	else 
0306+  6245             
0307+  6245 86 10       		ldaA	$10
0308+  6247 91 77       		cmpA	>ballCount
0309+  6249             		ifeq ; add player
0309+  6249             
0309+  6249 26 FE       
0310+  624B 86 1E       			ldaA	00011110b
0311+  624D 94 0E       			andA	>lc(7) ; player count lights
0312+  624F 85 10       			bitA	lr(5)
0313+  6251             			ifeq	; if not on P4 already, add player
0313+  6251             
0313+  6251 26 FE       
0314+  6253 48          				aslA
0315+  6254 C6 E1       				ldaB	11100001b
0316+  6256 D4 0E       				andB	>lc(7)
0317+  6258 D7 0E       				staB	lc(7)
0318+  625A 9A 0E       				oraA	>lc(7)
0319+  625C 97 0E       				staA	lc(7)
0320+  625E             			endif
0320+  625E             
0320+  625E             
0320+  625E             
0320+  625E             
0320+  625E             
0320+  625E~            			endif
0320+  625E~            			endif
0320+  625E             
0320+  625E~            			endif
0320+  625E~            			endif
0320+  625E             
0320+  6252             
0320+  6252 0B          
0320+  6253             
0320+  6253             
0320+  6253~            			endif
0320+  6253~            			endif
0320+  6253~            			endif
0320+  6253             
0320+  625E             
0320+  625E~            			endif
0320+  625E~            			endif
0320+  625E             
0321+  625E             		else ; restart game
0321+  625E             
0321+  625E             
0321+  625E             
0321+  625E             
0321+  624A             
0321+  624A             
0321+  624A             
0321+  624A~            		else ; restart game
0321+  624A~            		else ; restart game
0321+  624A~            		else ; restart game
0321+  624A~            		else ; restart game
0321+  624A             
0321+  624A~            		else ; restart game
0321+  624A~            		else ; restart game
0321+  624A~            		else ; restart game
0321+  624A~            		else ; restart game
0321+  624A             
0321+  624A             
0321+  624A 15          
0321+  625E             
0321+  625E 20 FE       
0321+  6260             
0321+  6260             
0321+  6260             
0321+  6260~            		else ; restart game
0321+  6260~            		else ; restart game
0321+  6260~            		else ; restart game
0321+  6260~            		else ; restart game
0321+  6260~            		else ; restart game
0321+  6260             
0321+  6260~            		else ; restart game
0321+  6260~            		else ; restart game
0321+  6260             
0321+  6260~            		else ; restart game
0321+  6260~            		else ; restart game
0321+  6260             
0322+  6260 BD 61 6D    			jsr startGame
0323+  6263             		endif		
0323+  6263             
0323+  6263             
0323+  6263             
0323+  6263             
0323+  6263             
0323+  6263~            		endif		
0323+  6263~            		endif		
0323+  6263             
0323+  6263~            		endif		
0323+  6263~            		endif		
0323+  6263             
0323+  625F             
0323+  625F 03          
0323+  6260             
0323+  6260             
0323+  6260~            		endif		
0323+  6260~            		endif		
0323+  6260~            		endif		
0323+  6260             
0323+  6263             
0323+  6263~            		endif		
0323+  6263~            		endif		
0323+  6263             
0324+  6263             	endif
0324+  6263             
0324+  6263             
0324+  6263             
0324+  6263             
0324+  6263             
0324+  6263~            	endif
0324+  6263~            	endif
0324+  6263             
0324+  6263~            	endif
0324+  6263~            	endif
0324+  6263             
0324+  6244             
0324+  6244 1E          
0324+  6245             
0324+  6245             
0324+  6245~            	endif
0324+  6245~            	endif
0324+  6245~            	endif
0324+  6245             
0324+  6263             
0324+  6263~            	endif
0324+  6263~            	endif
0324+  6263             
0325+  6263             	
0326+  6263 BD 7D D6    	jsr refreshPlayerScores
0327+  6266             	
0328+  6266             	done(0)
0328+  6266             
0328+  6266 86 02       
0328+  6268 BA 01 6B    
0328+  626B B7 01 6B    
0328+  626E             
0328+  626E 7E 79 E6    
0329+  6271             	
0330+  6271             swOuthole: 
0331+  6271 96 0F       	ldaA	>lc(8) ; !game over
0332+  6273 85 20       	bitA	lr(6)
0333+  6275             	ifne ; game over
0333+  6275             
0333+  6275 27 FE       
0334+  6277             		done(0)
0334+  6277             
0334+  6277 86 02       
0334+  6279 BA 01 6B    
0334+  627C B7 01 6B    
0334+  627F             
0334+  627F 7E 79 E6    
0335+  6282             	endif
0335+  6282             
0335+  6282             
0335+  6282             
0335+  6282             
0335+  6282             
0335+  6282~            	endif
0335+  6282~            	endif
0335+  6282             
0335+  6282~            	endif
0335+  6282~            	endif
0335+  6282             
0335+  6276             
0335+  6276 0B          
0335+  6277             
0335+  6277             
0335+  6277~            	endif
0335+  6277~            	endif
0335+  6277~            	endif
0335+  6277             
0335+  6282             
0335+  6282~            	endif
0335+  6282~            	endif
0335+  6282             
0336+  6282             	
0337+  6282 7D 00 BF    	tst	>bonusTimer
0338+  6285             	ifne
0338+  6285             
0338+  6285 27 FE       
0339+  6287             		done(0)
0339+  6287             
0339+  6287 86 02       
0339+  6289 BA 01 6B    
0339+  628C B7 01 6B    
0339+  628F             
0339+  628F 7E 79 E6    
0340+  6292             	else
0340+  6292             
0340+  6292             
0340+  6292             
0340+  6292             
0340+  6286             
0340+  6286             
0340+  6286             
0340+  6286~            	else
0340+  6286~            	else
0340+  6286~            	else
0340+  6286~            	else
0340+  6286             
0340+  6286~            	else
0340+  6286~            	else
0340+  6286~            	else
0340+  6286~            	else
0340+  6286             
0340+  6286             
0340+  6286 0D          
0340+  6292             
0340+  6292 20 FE       
0340+  6294             
0340+  6294             
0340+  6294             
0340+  6294~            	else
0340+  6294~            	else
0340+  6294~            	else
0340+  6294~            	else
0340+  6294~            	else
0340+  6294             
0340+  6294~            	else
0340+  6294~            	else
0340+  6294             
0340+  6294~            	else
0340+  6294~            	else
0340+  6294             
0341+  6294 86 7F       		ldaA	127
0342+  6296 97 BF       		staA	bonusTimer
0343+  6298             	endif
0343+  6298             
0343+  6298             
0343+  6298             
0343+  6298             
0343+  6298             
0343+  6298~            	endif
0343+  6298~            	endif
0343+  6298             
0343+  6298~            	endif
0343+  6298~            	endif
0343+  6298             
0343+  6293             
0343+  6293 04          
0343+  6294             
0343+  6294             
0343+  6294~            	endif
0343+  6294~            	endif
0343+  6294~            	endif
0343+  6294             
0343+  6298             
0343+  6298~            	endif
0343+  6298~            	endif
0343+  6298             
0344+  6298 86 4B       	delay(600)
0344+  629A BD 7E 6B    
0345+  629D             	
0346+  629D             	; check ballsave
0347+  629D 86 01       	ldaA	lr(1)
0348+  629F 95 0A       	bitA	>lc(3)
0349+  62A1             	ifne	; shoot again on
0349+  62A1             
0349+  62A1 27 FE       
0350+  62A3 95 A2       		bitA	>flc(3)
0351+  62A5             		ifne ; shoot again flashing
0351+  62A5             
0351+  62A5 27 FE       
0352+  62A7             			; turn off used special
0353+  62A7 86 80       			ldaA	lr(8) ; right special
0354+  62A9 95 09       			bitA	>lc(2)
0355+  62AB             			ifne
0355+  62AB             
0355+  62AB 27 FE       
0356+  62AD 86 7F       				lampOff(8,2)
0356+  62AF 94 09       
0356+  62B1 97 09       
0357+  62B3 86 7F       				flashOff(8,2)
0357+  62B5 94 A1       
0357+  62B7 97 A1       
0358+  62B9             			endif
0358+  62B9             
0358+  62B9             
0358+  62B9             
0358+  62B9             
0358+  62B9             
0358+  62B9~            			endif
0358+  62B9~            			endif
0358+  62B9             
0358+  62B9~            			endif
0358+  62B9~            			endif
0358+  62B9             
0358+  62AC             
0358+  62AC 0C          
0358+  62AD             
0358+  62AD             
0358+  62AD~            			endif
0358+  62AD~            			endif
0358+  62AD~            			endif
0358+  62AD             
0358+  62B9             
0358+  62B9~            			endif
0358+  62B9~            			endif
0358+  62B9             
0359+  62B9 86 02       			ldaA	lr(2) ; right special
0360+  62BB 95 0A       			bitA	>lc(3)
0361+  62BD             			ifne
0361+  62BD             
0361+  62BD 27 FE       
0362+  62BF 86 FD       				lampOff(2,3)
0362+  62C1 94 0A       
0362+  62C3 97 0A       
0363+  62C5 86 FD       				flashOff(2,3)
0363+  62C7 94 A2       
0363+  62C9 97 A2       
0364+  62CB             			endif
0364+  62CB             
0364+  62CB             
0364+  62CB             
0364+  62CB             
0364+  62CB             
0364+  62CB~            			endif
0364+  62CB~            			endif
0364+  62CB             
0364+  62CB~            			endif
0364+  62CB~            			endif
0364+  62CB             
0364+  62BE             
0364+  62BE 0C          
0364+  62BF             
0364+  62BF             
0364+  62BF~            			endif
0364+  62BF~            			endif
0364+  62BF~            			endif
0364+  62BF             
0364+  62CB             
0364+  62CB~            			endif
0364+  62CB~            			endif
0364+  62CB             
0365+  62CB             			
0366+  62CB             			; flash player light
0367+  62CB 86 0F       			ldaA	00001111b ; player up lights
0368+  62CD 9A A7       			oraA	>flc(8)
0369+  62CF 97 A7       			staA	flc(8)
0370+  62D1             		endif
0370+  62D1             
0370+  62D1             
0370+  62D1             
0370+  62D1             
0370+  62D1             
0370+  62D1~            		endif
0370+  62D1~            		endif
0370+  62D1             
0370+  62D1~            		endif
0370+  62D1~            		endif
0370+  62D1             
0370+  62A6             
0370+  62A6 2A          
0370+  62A7             
0370+  62A7             
0370+  62A7~            		endif
0370+  62A7~            		endif
0370+  62A7~            		endif
0370+  62A7             
0370+  62D1             
0370+  62D1~            		endif
0370+  62D1~            		endif
0370+  62D1             
0371+  62D1             	endif
0371+  62D1             
0371+  62D1             
0371+  62D1             
0371+  62D1             
0371+  62D1             
0371+  62D1~            	endif
0371+  62D1~            	endif
0371+  62D1             
0371+  62D1~            	endif
0371+  62D1~            	endif
0371+  62D1             
0371+  62A2             
0371+  62A2 2E          
0371+  62A3             
0371+  62A3             
0371+  62A3~            	endif
0371+  62A3~            	endif
0371+  62A3~            	endif
0371+  62A3             
0371+  62D1             
0371+  62D1~            	endif
0371+  62D1~            	endif
0371+  62D1             
0372+  62D1             	
0373+  62D1 86 0F       	ldaA	00001111b ; player up lights
0374+  62D3 95 A7       	bitA	>flc(8)	; check if any player is flashing
0375+  62D5             	ifne ; any flashing -> playfield invalid
0375+  62D5             
0375+  62D5 27 FE       
0376+  62D7             swOuthole_save:
0377+  62D7 86 EF       		lampOff(5,8) ; tilt
0377+  62D9 94 0F       
0377+  62DB 97 0F       
0378+  62DD             		
0379+  62DD B6 22 03    		enablePf
0379+  62E0 8A 38       
0379+  62E2 B7 22 03    
0380+  62E5 C6 02       		fireSolenoid(OUTHOLE)
0380+  62E7 F7 01 44    
0381+  62EA             	else ; none flashing -> playfield valid -> end ball			
0381+  62EA             
0381+  62EA             
0381+  62EA             
0381+  62EA             
0381+  62D6             
0381+  62D6             
0381+  62D6             
0381+  62D6~            	else ; none flashing -> playfield valid -> end ball			
0381+  62D6~            	else ; none flashing -> playfield valid -> end ball			
0381+  62D6~            	else ; none flashing -> playfield valid -> end ball			
0381+  62D6~            	else ; none flashing -> playfield valid -> end ball			
0381+  62D6             
0381+  62D6~            	else ; none flashing -> playfield valid -> end ball			
0381+  62D6~            	else ; none flashing -> playfield valid -> end ball			
0381+  62D6~            	else ; none flashing -> playfield valid -> end ball			
0381+  62D6~            	else ; none flashing -> playfield valid -> end ball			
0381+  62D6             
0381+  62D6             
0381+  62D6 15          
0381+  62EA             
0381+  62EA 20 FE       
0381+  62EC             
0381+  62EC             
0381+  62EC             
0381+  62EC~            	else ; none flashing -> playfield valid -> end ball			
0381+  62EC~            	else ; none flashing -> playfield valid -> end ball			
0381+  62EC~            	else ; none flashing -> playfield valid -> end ball			
0381+  62EC~            	else ; none flashing -> playfield valid -> end ball			
0381+  62EC~            	else ; none flashing -> playfield valid -> end ball			
0381+  62EC             
0381+  62EC~            	else ; none flashing -> playfield valid -> end ball			
0381+  62EC~            	else ; none flashing -> playfield valid -> end ball			
0381+  62EC             
0381+  62EC~            	else ; none flashing -> playfield valid -> end ball			
0381+  62EC~            	else ; none flashing -> playfield valid -> end ball			
0381+  62EC             
0382+  62EC             swOuthole_bonusLoop:
0383+  62EC BD 7F 06    		score1000()
0384+  62EF 96 09       		ldaA	>lc(2) ; double bonus
0385+  62F1 85 04       		bitA	lr(3)
0386+  62F3             		ifne 
0386+  62F3             
0386+  62F3 27 FE       
0387+  62F5 86 0C       			delay(100)
0387+  62F7 BD 7E 6B    
0388+  62FA BD 7F 06    			score1000()
0389+  62FD             		endif
0389+  62FD             
0389+  62FD             
0389+  62FD             
0389+  62FD             
0389+  62FD             
0389+  62FD~            		endif
0389+  62FD~            		endif
0389+  62FD             
0389+  62FD~            		endif
0389+  62FD~            		endif
0389+  62FD             
0389+  62F4             
0389+  62F4 08          
0389+  62F5             
0389+  62F5             
0389+  62F5~            		endif
0389+  62F5~            		endif
0389+  62F5~            		endif
0389+  62F5             
0389+  62FD             
0389+  62FD~            		endif
0389+  62FD~            		endif
0389+  62FD             
0390+  62FD 7A 00 B0    		dec	p_Bonus
0391+  6300 BD 60 C3    		jsr	bonusLights
0392+  6303 86 19       		delay(200)
0392+  6305 BD 7E 6B    
0393+  6308 7D 00 B0    		tst	>p_Bonus
0394+  630B 26 DF       		bne	swOuthole_bonusLoop
0395+  630D             	
0396+  630D 86 0F       		ldaA	00001111b ; player up lights
0397+  630F 94 0F       		andA	>lc(8) ; remove non-player up lights from col 8 for processing
0398+  6311 D6 0A       		ldaB	>lc(3) ; check shoot again light
0399+  6313 C5 01       		bitB	lr(1)
0400+  6315             		ifeq ; shoot again not lit
0400+  6315             
0400+  6315 26 FE       
0401+  6317             			; store player's data
0402+  6317 DE 12       			ldX	>curPlayer
0403+  6319 D6 0B       			ldaB	>lc(4)
0404+  631B E7 B1       			staB	p_Ejects, X
0405+  631D D6 0A       			ldaB	>lc(3)
0406+  631F C4 02       			andB	lr(2)
0407+  6321 DA 09       			oraB	>lc(2)
0408+  6323 E7 B6       			staB	p_LampCol2, X
0409+  6325             			
0410+  6325             		
0411+  6325             			; go to next player
0412+  6325 48          			aslA
0413+  6326 7C 00 13    			inc	curPlayer + 1
0414+  6329 95 0E       			bitA	>lc(7)	; is player count < player #
0415+  632B             			ifne ; last player
0415+  632B             
0415+  632B 27 FE       
0416+  632D 86 01       				ldaA	00000001b; ; back to player 1
0417+  632F C6 00       				ldaB	0
0418+  6331 D7 13       				staB	curPlayer + 1
0419+  6333             				
0420+  6333             				; increase ball count
0421+  6333 D6 77       				ldaB	>ballCount
0422+  6335 CB 10       				addB	$10
0423+  6337 C1 40       				cmpB	$40
0424+  6339             				ifeq ; game over
0424+  6339             
0424+  6339 26 FE       
0425+  633B 86 20       					lampOn(6,8)
0425+  633D 9A 0F       
0425+  633F 97 0F       
0426+  6341 B6 22 03    					disablePf
0426+  6344 84 F7       
0426+  6346 B7 22 03    
0427+  6349             					done(1)
0427+  6349~            					done(1)
0427+  6349~            					done(1)
0427+  6349~            					done(1)
0427+  6349~            					done(1)
0427+  6349             
0427+  6349 7E 79 E6    
0428+  634C             				else
0428+  634C             
0428+  634C             
0428+  634C             
0428+  634C             
0428+  633A             
0428+  633A             
0428+  633A             
0428+  633A~            				else
0428+  633A~            				else
0428+  633A~            				else
0428+  633A~            				else
0428+  633A             
0428+  633A~            				else
0428+  633A~            				else
0428+  633A~            				else
0428+  633A~            				else
0428+  633A             
0428+  633A             
0428+  633A 13          
0428+  634C             
0428+  634C 20 FE       
0428+  634E             
0428+  634E             
0428+  634E             
0428+  634E~            				else
0428+  634E~            				else
0428+  634E~            				else
0428+  634E~            				else
0428+  634E~            				else
0428+  634E             
0428+  634E~            				else
0428+  634E~            				else
0428+  634E             
0428+  634E~            				else
0428+  634E~            				else
0428+  634E             
0429+  634E D7 77       					staB	ballCount
0430+  6350             				endif		
0430+  6350             
0430+  6350             
0430+  6350             
0430+  6350             
0430+  6350             
0430+  6350~            				endif		
0430+  6350~            				endif		
0430+  6350             
0430+  6350~            				endif		
0430+  6350~            				endif		
0430+  6350             
0430+  634D             
0430+  634D 02          
0430+  634E             
0430+  634E             
0430+  634E~            				endif		
0430+  634E~            				endif		
0430+  634E~            				endif		
0430+  634E             
0430+  6350             
0430+  6350~            				endif		
0430+  6350~            				endif		
0430+  6350             
0431+  6350             			endif
0431+  6350             
0431+  6350             
0431+  6350             
0431+  6350             
0431+  6350             
0431+  6350~            			endif
0431+  6350~            			endif
0431+  6350             
0431+  6350~            			endif
0431+  6350~            			endif
0431+  6350             
0431+  632C             
0431+  632C 23          
0431+  632D             
0431+  632D             
0431+  632D~            			endif
0431+  632D~            			endif
0431+  632D~            			endif
0431+  632D             
0431+  6350             
0431+  6350~            			endif
0431+  6350~            			endif
0431+  6350             
0432+  6350             			
0433+  6350 97 0F       			staA	lc(8)
0434+  6352             		endif
0434+  6352             
0434+  6352             
0434+  6352             
0434+  6352             
0434+  6352             
0434+  6352~            		endif
0434+  6352~            		endif
0434+  6352             
0434+  6352~            		endif
0434+  6352~            		endif
0434+  6352             
0434+  6316             
0434+  6316 3B          
0434+  6317             
0434+  6317             
0434+  6317~            		endif
0434+  6317~            		endif
0434+  6317~            		endif
0434+  6317             
0434+  6352             
0434+  6352~            		endif
0434+  6352~            		endif
0434+  6352             
0435+  6352             		
0436+  6352 BD 60 F2    		jsr	startBall
0437+  6355             	endif	
0437+  6355             
0437+  6355             
0437+  6355             
0437+  6355             
0437+  6355             
0437+  6355~            	endif	
0437+  6355~            	endif	
0437+  6355             
0437+  6355~            	endif	
0437+  6355~            	endif	
0437+  6355             
0437+  62EB             
0437+  62EB 69          
0437+  62EC             
0437+  62EC             
0437+  62EC~            	endif	
0437+  62EC~            	endif	
0437+  62EC~            	endif	
0437+  62EC             
0437+  6355             
0437+  6355~            	endif	
0437+  6355~            	endif	
0437+  6355             
0438+  6355             	
0439+  6355 7F 00 BF    	clr 	bonusTimer
0440+  6358             	
0441+  6358             	done(0)
0441+  6358             
0441+  6358 86 02       
0441+  635A BA 01 6B    
0441+  635D B7 01 6B    
0441+  6360             
0441+  6360 7E 79 E6    
0442+  6363             	
0443+  6363             swLeftEject:
0444+  6363 96 0F       	ldaA	>lc(8)
0445+  6365 85 20       	bitA	lr(6)
0446+  6367             	ifne ; not in game
0446+  6367             
0446+  6367 27 FE       
0447+  6369 C6 03       		fireSolenoid(LEFT_EJECT)
0447+  636B F7 01 43    
0448+  636E             		done(0)
0448+  636E             
0448+  636E 86 02       
0448+  6370 BA 01 6B    
0448+  6373 B7 01 6B    
0448+  6376             
0448+  6376 7E 79 E6    
0449+  6379             	endif
0449+  6379             
0449+  6379             
0449+  6379             
0449+  6379             
0449+  6379             
0449+  6379~            	endif
0449+  6379~            	endif
0449+  6379             
0449+  6379~            	endif
0449+  6379~            	endif
0449+  6379             
0449+  6368             
0449+  6368 10          
0449+  6369             
0449+  6369             
0449+  6369~            	endif
0449+  6369~            	endif
0449+  6369~            	endif
0449+  6369             
0449+  6379             
0449+  6379~            	endif
0449+  6379~            	endif
0449+  6379             
0450+  6379             		
0451+  6379 BD 7F 16    	advBonus()
0452+  637C 86 04       	ldaA	lr(3) ; extra ball
0453+  637E 95 0A       	bitA	>lc(3)
0454+  6380             	ifne
0454+  6380             
0454+  6380 27 FE       
0455+  6382 C6 06       		fireSolenoid(KNOCKER)
0455+  6384 F7 01 4D    
0456+  6387 86 01       		lampOn(1,3) ; shoot again
0456+  6389 9A 0A       
0456+  638B 97 0A       
0457+  638D 86 40       		lampOn(7,8)
0457+  638F 9A 0F       
0457+  6391 97 0F       
0458+  6393 86 FB       		lampOff(3,3) ; extra ball
0458+  6395 94 0A       
0458+  6397 97 0A       
0459+  6399 86 3E       		delay(500)
0459+  639B BD 7E 6B    
0460+  639E             	else
0460+  639E             
0460+  639E             
0460+  639E             
0460+  639E             
0460+  6381             
0460+  6381             
0460+  6381             
0460+  6381~            	else
0460+  6381~            	else
0460+  6381~            	else
0460+  6381~            	else
0460+  6381             
0460+  6381~            	else
0460+  6381~            	else
0460+  6381~            	else
0460+  6381~            	else
0460+  6381             
0460+  6381             
0460+  6381 1E          
0460+  639E             
0460+  639E 20 FE       
0460+  63A0             
0460+  63A0             
0460+  63A0             
0460+  63A0~            	else
0460+  63A0~            	else
0460+  63A0~            	else
0460+  63A0~            	else
0460+  63A0~            	else
0460+  63A0             
0460+  63A0~            	else
0460+  63A0~            	else
0460+  63A0             
0460+  63A0~            	else
0460+  63A0~            	else
0460+  63A0             
0461+  63A0 BD 67 78    		jsr	addCollect
0462+  63A3             		score500()
0462+  63A3 BD 7E F7    
0462+  63A6 C6 02       
0462+  63A8 F7 01 49    
0462+  63AB 86 0E       
0462+  63AD BD 7E 6B    
0462+  63B0 BD 7E F7    
0462+  63B3 C6 02       
0462+  63B5 F7 01 49    
0462+  63B8 86 0E       
0462+  63BA BD 7E 6B    
0462+  63BD BD 7E F7    
0462+  63C0 C6 02       
0462+  63C2 F7 01 49    
0462+  63C5 86 0E       
0462+  63C7 BD 7E 6B    
0462+  63CA BD 7E F7    
0462+  63CD C6 02       
0462+  63CF F7 01 49    
0462+  63D2 86 0E       
0462+  63D4 BD 7E 6B    
0462+  63D7 BD 7E F7    
0462+  63DA C6 02       
0462+  63DC F7 01 49    
0462+  63DF 86 0E       
0462+  63E1 BD 7E 6B    
0463+  63E4             	endif
0463+  63E4             
0463+  63E4             
0463+  63E4             
0463+  63E4             
0463+  63E4             
0463+  63E4~            	endif
0463+  63E4~            	endif
0463+  63E4             
0463+  63E4~            	endif
0463+  63E4~            	endif
0463+  63E4             
0463+  639F             
0463+  639F 44          
0463+  63A0             
0463+  63A0             
0463+  63A0~            	endif
0463+  63A0~            	endif
0463+  63A0~            	endif
0463+  63A0             
0463+  63E4             
0463+  63E4~            	endif
0463+  63E4~            	endif
0463+  63E4             
0464+  63E4 C6 03       	fireSolenoid(LEFT_EJECT)
0464+  63E6 F7 01 43    
0465+  63E9             	
0466+  63E9 86 32       	fork(400)
0466+  63EB BD 7E 80    
0467+  63EE             	done(1)
0467+  63EE~            	done(1)
0467+  63EE~            	done(1)
0467+  63EE~            	done(1)
0467+  63EE~            	done(1)
0467+  63EE             
0467+  63EE 7E 79 E6    
0468+  63F1             	beginFork()
0469+  63F1 86 C7       	ldaA	11000111b
0470+  63F3 94 A1       	andA	>flc(2)
0471+  63F5 97 A1       	staA	flc(2)
0472+  63F7 DE 2C       	endFork()
0472+  63F9 7E 79 52    
0473+  63FC             	
0474+  63FC             swTopEject:
0475+  63FC BD 7F 16    	advBonus()
0476+  63FF D6 0B       	ldaB	>lc(4)
0477+  6401 57          	asrB
0478+  6402             	ifeq ; 1k
0478+  6402             
0478+  6402 26 FE       
0479+  6404 BD 7F 06    		score1000()
0480+  6407 86 19       		delay(200)
0480+  6409 BD 7E 6B    
0481+  640C 7E 64 D1    		jmp	swTopEject_scored
0482+  640F             	endif
0482+  640F             
0482+  640F             
0482+  640F             
0482+  640F             
0482+  640F             
0482+  640F~            	endif
0482+  640F~            	endif
0482+  640F             
0482+  640F~            	endif
0482+  640F~            	endif
0482+  640F             
0482+  6403             
0482+  6403 0B          
0482+  6404             
0482+  6404             
0482+  6404~            	endif
0482+  6404~            	endif
0482+  6404~            	endif
0482+  6404             
0482+  640F             
0482+  640F~            	endif
0482+  640F~            	endif
0482+  640F             
0483+  640F 57          	asrB
0484+  6410             	ifeq  ; captive
0484+  6410             
0484+  6410 26 FE       
0485+  6412 86 40       		ldaA	lr(7)
0486+  6414 95 09       		bitA	>lc(2) ; captive ball
0487+  6416             		ifeq	; not lit
0487+  6416             
0487+  6416 26 FE       
0488+  6418 86 40       			lampOn(7,2)
0488+  641A 9A 09       
0488+  641C 97 09       
0489+  641E 86 40       			flashLamp(7,2)
0489+  6420 9A A1       
0489+  6422 97 A1       
0490+  6424             		else
0490+  6424             
0490+  6424             
0490+  6424             
0490+  6424             
0490+  6417             
0490+  6417             
0490+  6417             
0490+  6417~            		else
0490+  6417~            		else
0490+  6417~            		else
0490+  6417~            		else
0490+  6417             
0490+  6417~            		else
0490+  6417~            		else
0490+  6417~            		else
0490+  6417~            		else
0490+  6417             
0490+  6417             
0490+  6417 0E          
0490+  6424             
0490+  6424 20 FE       
0490+  6426             
0490+  6426             
0490+  6426             
0490+  6426~            		else
0490+  6426~            		else
0490+  6426~            		else
0490+  6426~            		else
0490+  6426~            		else
0490+  6426             
0490+  6426~            		else
0490+  6426~            		else
0490+  6426             
0490+  6426~            		else
0490+  6426~            		else
0490+  6426             
0491+  6426 86 BF       			lampOff(7,2)
0491+  6428 94 09       
0491+  642A 97 09       
0492+  642C             		endif
0492+  642C             
0492+  642C             
0492+  642C             
0492+  642C             
0492+  642C             
0492+  642C~            		endif
0492+  642C~            		endif
0492+  642C             
0492+  642C~            		endif
0492+  642C~            		endif
0492+  642C             
0492+  6425             
0492+  6425 06          
0492+  6426             
0492+  6426             
0492+  6426~            		endif
0492+  6426~            		endif
0492+  6426~            		endif
0492+  6426             
0492+  642C             
0492+  642C~            		endif
0492+  642C~            		endif
0492+  642C             
0493+  642C             	score500()
0493+  642C BD 7E F7    
0493+  642F C6 02       
0493+  6431 F7 01 49    
0493+  6434 86 0E       
0493+  6436 BD 7E 6B    
0493+  6439 BD 7E F7    
0493+  643C C6 02       
0493+  643E F7 01 49    
0493+  6441 86 0E       
0493+  6443 BD 7E 6B    
0493+  6446 BD 7E F7    
0493+  6449 C6 02       
0493+  644B F7 01 49    
0493+  644E 86 0E       
0493+  6450 BD 7E 6B    
0493+  6453 BD 7E F7    
0493+  6456 C6 02       
0493+  6458 F7 01 49    
0493+  645B 86 0E       
0493+  645D BD 7E 6B    
0493+  6460 BD 7E F7    
0493+  6463 C6 02       
0493+  6465 F7 01 49    
0493+  6468 86 0E       
0493+  646A BD 7E 6B    
0494+  646D 7E 64 D1    		jmp	swTopEject_scored
0495+  6470             	endif
0495+  6470             
0495+  6470             
0495+  6470             
0495+  6470             
0495+  6470             
0495+  6470~            	endif
0495+  6470~            	endif
0495+  6470             
0495+  6470~            	endif
0495+  6470~            	endif
0495+  6470             
0495+  6411             
0495+  6411 5E          
0495+  6412             
0495+  6412             
0495+  6412~            	endif
0495+  6412~            	endif
0495+  6412~            	endif
0495+  6412             
0495+  6470             
0495+  6470~            	endif
0495+  6470~            	endif
0495+  6470             
0496+  6470 57          	asrB
0497+  6471             	ifne	
0497+  6471             
0497+  6471 27 FE       
0498+  6473 57          		asrB
0499+  6474             		ifeq ; double
0499+  6474             
0499+  6474 26 FE       
0500+  6476 86 04       			ldaA	lr(3)
0501+  6478 95 09       			bitA	>lc(2) ; double bonus
0502+  647A             			ifeq	; not lit
0502+  647A             
0502+  647A 26 FE       
0503+  647C 86 04       				lampOn(3,2)
0503+  647E 9A 09       
0503+  6480 97 09       
0504+  6482 86 04       				flashLamp(3,2)
0504+  6484 9A A1       
0504+  6486 97 A1       
0505+  6488             			else
0505+  6488             
0505+  6488             
0505+  6488             
0505+  6488             
0505+  647B             
0505+  647B             
0505+  647B             
0505+  647B~            			else
0505+  647B~            			else
0505+  647B~            			else
0505+  647B~            			else
0505+  647B             
0505+  647B~            			else
0505+  647B~            			else
0505+  647B~            			else
0505+  647B~            			else
0505+  647B             
0505+  647B             
0505+  647B 0E          
0505+  6488             
0505+  6488 20 FE       
0505+  648A             
0505+  648A             
0505+  648A             
0505+  648A~            			else
0505+  648A~            			else
0505+  648A~            			else
0505+  648A~            			else
0505+  648A~            			else
0505+  648A             
0505+  648A~            			else
0505+  648A~            			else
0505+  648A             
0505+  648A~            			else
0505+  648A~            			else
0505+  648A             
0506+  648A 86 FB       				lampOff(3,2)
0506+  648C 94 09       
0506+  648E 97 09       
0507+  6490             			endif
0507+  6490             
0507+  6490             
0507+  6490             
0507+  6490             
0507+  6490             
0507+  6490~            			endif
0507+  6490~            			endif
0507+  6490             
0507+  6490~            			endif
0507+  6490~            			endif
0507+  6490             
0507+  6489             
0507+  6489 06          
0507+  648A             
0507+  648A             
0507+  648A~            			endif
0507+  648A~            			endif
0507+  648A~            			endif
0507+  648A             
0507+  6490             
0507+  6490~            			endif
0507+  6490~            			endif
0507+  6490             
0508+  6490             		endif
0508+  6490             
0508+  6490             
0508+  6490             
0508+  6490             
0508+  6490             
0508+  6490~            		endif
0508+  6490~            		endif
0508+  6490             
0508+  6490~            		endif
0508+  6490~            		endif
0508+  6490             
0508+  6475             
0508+  6475 1A          
0508+  6476             
0508+  6476             
0508+  6476~            		endif
0508+  6476~            		endif
0508+  6476~            		endif
0508+  6476             
0508+  6490             
0508+  6490~            		endif
0508+  6490~            		endif
0508+  6490             
0509+  6490             	endif
0509+  6490             
0509+  6490             
0509+  6490             
0509+  6490             
0509+  6490             
0509+  6490~            	endif
0509+  6490~            	endif
0509+  6490             
0509+  6490~            	endif
0509+  6490~            	endif
0509+  6490             
0509+  6472             
0509+  6472 1D          
0509+  6473             
0509+  6473             
0509+  6473~            	endif
0509+  6473~            	endif
0509+  6473~            	endif
0509+  6473             
0509+  6490             
0509+  6490~            	endif
0509+  6490~            	endif
0509+  6490             
0510+  6490             	score500()
0510+  6490 BD 7E F7    
0510+  6493 C6 02       
0510+  6495 F7 01 49    
0510+  6498 86 0E       
0510+  649A BD 7E 6B    
0510+  649D BD 7E F7    
0510+  64A0 C6 02       
0510+  64A2 F7 01 49    
0510+  64A5 86 0E       
0510+  64A7 BD 7E 6B    
0510+  64AA BD 7E F7    
0510+  64AD C6 02       
0510+  64AF F7 01 49    
0510+  64B2 86 0E       
0510+  64B4 BD 7E 6B    
0510+  64B7 BD 7E F7    
0510+  64BA C6 02       
0510+  64BC F7 01 49    
0510+  64BF 86 0E       
0510+  64C1 BD 7E 6B    
0510+  64C4 BD 7E F7    
0510+  64C7 C6 02       
0510+  64C9 F7 01 49    
0510+  64CC 86 0E       
0510+  64CE BD 7E 6B    
0511+  64D1             swTopEject_scored:
0512+  64D1 86 FB       	flashOff(3,2)
0512+  64D3 94 A1       
0512+  64D5 97 A1       
0513+  64D7 86 BF       	flashOff(7,2)
0513+  64D9 94 A1       
0513+  64DB 97 A1       
0514+  64DD C6 03       	fireSolenoid(TOP_EJECT)
0514+  64DF F7 01 40    
0515+  64E2             	done(1)
0515+  64E2~            	done(1)
0515+  64E2~            	done(1)
0515+  64E2~            	done(1)
0515+  64E2~            	done(1)
0515+  64E2             
0515+  64E2 7E 79 E6    
0516+  64E5             	
0517+  64E5             swHotTip:
0518+  64E5 7D 00 A9    	tst	>dropResetTimer
0519+  64E8             	ifne
0519+  64E8             
0519+  64E8 27 FE       
0520+  64EA             		done(0)
0520+  64EA             
0520+  64EA 86 02       
0520+  64EC BA 01 6B    
0520+  64EF B7 01 6B    
0520+  64F2             
0520+  64F2 7E 79 E6    
0521+  64F5             	endif
0521+  64F5             
0521+  64F5             
0521+  64F5             
0521+  64F5             
0521+  64F5             
0521+  64F5~            	endif
0521+  64F5~            	endif
0521+  64F5             
0521+  64F5~            	endif
0521+  64F5~            	endif
0521+  64F5             
0521+  64E9             
0521+  64E9 0B          
0521+  64EA             
0521+  64EA             
0521+  64EA~            	endif
0521+  64EA~            	endif
0521+  64EA~            	endif
0521+  64EA             
0521+  64F5             
0521+  64F5~            	endif
0521+  64F5~            	endif
0521+  64F5             
0522+  64F5             	
0523+  64F5 BD 67 78    	jsr	addCollect
0524+  64F8 86 00       	ldaA	0
0525+  64FA 97 B5       	staA	p_DropsDown
0526+  64FC 97 AA       	staA	dropsDown
0527+  64FE 86 41       	ldaA	65
0528+  6500 97 A9       	staA	dropResetTimer
0529+  6502 86 12       	delay(150)
0529+  6504 BD 7E 6B    
0530+  6507 C6 0C       	fireSolenoid(DROP_HOT)
0530+  6509 F7 01 42    
0531+  650C 86 12       	delay(150)
0531+  650E BD 7E 6B    
0532+  6511 C6 0C       	fireSolenoid(DROP_TIP)
0532+  6513 F7 01 41    
0533+  6516 86 F7       	lampOff(4,3) ; spinner
0533+  6518 94 0A       
0533+  651A 97 0A       
0534+  651C             	
0535+  651C 86 70       	fork(900)
0535+  651E BD 7E 80    
0536+  6521             	done(1)
0536+  6521~            	done(1)
0536+  6521~            	done(1)
0536+  6521~            	done(1)
0536+  6521~            	done(1)
0536+  6521             
0536+  6521 7E 79 E6    
0537+  6524             	beginFork()
0538+  6524 86 C7       	ldaA	11000111b
0539+  6526 94 A1       	andA	>flc(2)
0540+  6528 97 A1       	staA	flc(2)
0541+  652A DE 2C       	endFork()
0541+  652C 7E 79 52    
0542+  652F             	
0543+  652F             swLeftOutlane:
0544+  652F 86 02       	ldaA	lr(2) ; left special
0545+  6531 95 0A       	bitA	>lc(3)
0546+  6533             	ifne
0546+  6533             
0546+  6533 27 FE       
0547+  6535 86 01       		lampOn(1,3) ; shoot again
0547+  6537 9A 0A       
0547+  6539 97 0A       
0548+  653B 86 01       		flashLamp(1,3)
0548+  653D 9A A2       
0548+  653F 97 A2       
0549+  6541 C6 0C       		fireSolenoid(BUZZER)
0549+  6543 F7 01 4E    
0550+  6546 86 02       		flashLamp(2,3)
0550+  6548 9A A2       
0550+  654A 97 A2       
0551+  654C             	endif
0551+  654C             
0551+  654C             
0551+  654C             
0551+  654C             
0551+  654C             
0551+  654C~            	endif
0551+  654C~            	endif
0551+  654C             
0551+  654C~            	endif
0551+  654C~            	endif
0551+  654C             
0551+  6534             
0551+  6534 17          
0551+  6535             
0551+  6535             
0551+  6535~            	endif
0551+  6535~            	endif
0551+  6535~            	endif
0551+  6535             
0551+  654C             
0551+  654C~            	endif
0551+  654C~            	endif
0551+  654C             
0552+  654C BD 7F 16    	advBonus()
0553+  654F BD 7F 06    	score1000()
0554+  6552             	done(1)
0554+  6552~            	done(1)
0554+  6552~            	done(1)
0554+  6552~            	done(1)
0554+  6552~            	done(1)
0554+  6552             
0554+  6552 7E 79 E6    
0555+  6555             	
0556+  6555             swRightOutlane:
0557+  6555 86 80       	ldaA	lr(8) ; right special
0558+  6557 95 09       	bitA	>lc(2)
0559+  6559             	ifne
0559+  6559             
0559+  6559 27 FE       
0560+  655B 86 01       		lampOn(1,3) ; shoot again
0560+  655D 9A 0A       
0560+  655F 97 0A       
0561+  6561 86 01       		flashLamp(1,3)
0561+  6563 9A A2       
0561+  6565 97 A2       
0562+  6567 C6 0C       		fireSolenoid(BUZZER)
0562+  6569 F7 01 4E    
0563+  656C 86 80       		flashLamp(8,2)
0563+  656E 9A A1       
0563+  6570 97 A1       
0564+  6572             	endif
0564+  6572             
0564+  6572             
0564+  6572             
0564+  6572             
0564+  6572             
0564+  6572~            	endif
0564+  6572~            	endif
0564+  6572             
0564+  6572~            	endif
0564+  6572~            	endif
0564+  6572             
0564+  655A             
0564+  655A 17          
0564+  655B             
0564+  655B             
0564+  655B~            	endif
0564+  655B~            	endif
0564+  655B~            	endif
0564+  655B             
0564+  6572             
0564+  6572~            	endif
0564+  6572~            	endif
0564+  6572             
0565+  6572 BD 7F 16    	advBonus()
0566+  6575 BD 7F 06    	score1000()
0567+  6578             	done(1)
0567+  6578~            	done(1)
0567+  6578~            	done(1)
0567+  6578~            	done(1)
0567+  6578~            	done(1)
0567+  6578             
0567+  6578 7E 79 E6    
0568+  657B             	
0569+  657B             swLeftInlane:
0570+  657B BD 7F 16    	advBonus()
0571+  657E BD 7F 06    	score1000()
0572+  6581             	done(1)
0572+  6581~            	done(1)
0572+  6581~            	done(1)
0572+  6581~            	done(1)
0572+  6581~            	done(1)
0572+  6581             
0572+  6581 7E 79 E6    
0573+  6584             swRightInlane:
0574+  6584 BD 7F 16    	advBonus()
0575+  6587 BD 7F 06    	score1000()
0576+  658A 86 FF       	ldaA	255
0577+  658C 97 BA       	staA	spinnerTimer
0578+  658E 86 08       	flashLamp(4,3) ; spinner
0578+  6590 9A A2       
0578+  6592 97 A2       
0579+  6594 86 08       	lampOn(4,3)
0579+  6596 9A 0A       
0579+  6598 97 0A       
0580+  659A             	done(1)
0580+  659A~            	done(1)
0580+  659A~            	done(1)
0580+  659A~            	done(1)
0580+  659A~            	done(1)
0580+  659A             
0580+  659A 7E 79 E6    
0581+  659D             sw10pt:
0582+  659D BD 7E E9    	score10()
0583+  65A0 77 00 0B    	asr	lc(4)
0584+  65A3             	ifeq ; shifted off the edge
0584+  65A3             
0584+  65A3 26 FE       
0585+  65A5 86 10       		ldaA	00010000b
0586+  65A7 97 0B       		staA	lc(4)
0587+  65A9             	endif
0587+  65A9             
0587+  65A9             
0587+  65A9             
0587+  65A9             
0587+  65A9             
0587+  65A9~            	endif
0587+  65A9~            	endif
0587+  65A9             
0587+  65A9~            	endif
0587+  65A9~            	endif
0587+  65A9             
0587+  65A4             
0587+  65A4 04          
0587+  65A5             
0587+  65A5             
0587+  65A5~            	endif
0587+  65A5~            	endif
0587+  65A5~            	endif
0587+  65A5             
0587+  65A9             
0587+  65A9~            	endif
0587+  65A9~            	endif
0587+  65A9             
0588+  65A9             	done(1)
0588+  65A9~            	done(1)
0588+  65A9~            	done(1)
0588+  65A9~            	done(1)
0588+  65A9~            	done(1)
0588+  65A9             
0588+  65A9 7E 79 E6    
0589+  65AC             sw100pt:
0590+  65AC BD 7E F7    	score100()
0591+  65AF             	done(1)
0591+  65AF~            	done(1)
0591+  65AF~            	done(1)
0591+  65AF~            	done(1)
0591+  65AF~            	done(1)
0591+  65AF             
0591+  65AF 7E 79 E6    
0592+  65B2             sw500pt:
0593+  65B2 BD 67 4C    	jsr	alternate
0594+  65B5             	score500()
0594+  65B5 BD 7E F7    
0594+  65B8 C6 02       
0594+  65BA F7 01 49    
0594+  65BD 86 0E       
0594+  65BF BD 7E 6B    
0594+  65C2 BD 7E F7    
0594+  65C5 C6 02       
0594+  65C7 F7 01 49    
0594+  65CA 86 0E       
0594+  65CC BD 7E 6B    
0594+  65CF BD 7E F7    
0594+  65D2 C6 02       
0594+  65D4 F7 01 49    
0594+  65D7 86 0E       
0594+  65D9 BD 7E 6B    
0594+  65DC BD 7E F7    
0594+  65DF C6 02       
0594+  65E1 F7 01 49    
0594+  65E4 86 0E       
0594+  65E6 BD 7E 6B    
0594+  65E9 BD 7E F7    
0594+  65EC C6 02       
0594+  65EE F7 01 49    
0594+  65F1 86 0E       
0594+  65F3 BD 7E 6B    
0595+  65F6             	done(1)
0595+  65F6~            	done(1)
0595+  65F6~            	done(1)
0595+  65F6~            	done(1)
0595+  65F6~            	done(1)
0595+  65F6             
0595+  65F6 7E 79 E6    
0596+  65F9             swPop:
0597+  65F9 BD 67 4C    	jsr	alternate
0598+  65FC BD 7E F7    	score100()
0599+  65FF             	done(1)
0599+  65FF~            	done(1)
0599+  65FF~            	done(1)
0599+  65FF~            	done(1)
0599+  65FF~            	done(1)
0599+  65FF             
0599+  65FF 7E 79 E6    
0600+  6602             swDropTip:
0601+  6602 86 08       	ldaA	1<<3
0602+  6604 7E 66 20    	jmp	swDrop
0603+  6607             swDropHot:
0604+  6607 86 01       	ldaA	1<<0
0605+  6609 7E 66 20    	jmp	swDrop
0606+  660C             swDroptIp:
0607+  660C 86 10       	ldaA	1<<4
0608+  660E 7E 66 20    	jmp	swDrop
0609+  6611             swDrophOt:
0610+  6611 86 02       	ldaA	1<<1
0611+  6613 7E 66 20    	jmp	swDrop
0612+  6616             swDroptiP:
0613+  6616 86 20       	ldaA	1<<5
0614+  6618 7E 66 20    	jmp	swDrop
0615+  661B             swDrophoT:
0616+  661B 86 04       	ldaA	1<<2
0617+  661D 7E 66 20    	jmp	swDrop
0618+  6620             swDrop:
0619+  6620 7D 00 A9    	tst	>dropResetTimer
0620+  6623             	ifeq
0620+  6623             
0620+  6623 26 FE       
0621+  6625 95 AA       		bitA	>dropsDown
0622+  6627             		ifne
0622+  6627             
0622+  6627 27 FE       
0623+  6629             			done(0)
0623+  6629             
0623+  6629 86 02       
0623+  662B BA 01 6B    
0623+  662E B7 01 6B    
0623+  6631             
0623+  6631 7E 79 E6    
0624+  6634             		endif
0624+  6634             
0624+  6634             
0624+  6634             
0624+  6634             
0624+  6634             
0624+  6634~            		endif
0624+  6634~            		endif
0624+  6634             
0624+  6634~            		endif
0624+  6634~            		endif
0624+  6634             
0624+  6628             
0624+  6628 0B          
0624+  6629             
0624+  6629             
0624+  6629~            		endif
0624+  6629~            		endif
0624+  6629~            		endif
0624+  6629             
0624+  6634             
0624+  6634~            		endif
0624+  6634~            		endif
0624+  6634             
0625+  6634 9A AA       		oraA	>dropsDown
0626+  6636             		
0627+  6636 97 AA       		staA	dropsDown
0628+  6638 7C 00 B5    		inc	p_DropsDown
0629+  663B 86 04       		ldaA	4
0630+  663D 91 B5       		cmpA	>p_DropsDown
0631+  663F             		ifgt
0631+  663F             
0631+  663F 23 FE       
0632+  6641 86 F7       			lampOff(4,3) ; spinner
0632+  6643 94 0A       
0632+  6645 97 0A       
0633+  6647             		else
0633+  6647             
0633+  6647             
0633+  6647             
0633+  6647             
0633+  6640             
0633+  6640             
0633+  6640             
0633+  6640~            		else
0633+  6640~            		else
0633+  6640~            		else
0633+  6640~            		else
0633+  6640             
0633+  6640~            		else
0633+  6640~            		else
0633+  6640~            		else
0633+  6640~            		else
0633+  6640             
0633+  6640             
0633+  6640 08          
0633+  6647             
0633+  6647 20 FE       
0633+  6649             
0633+  6649             
0633+  6649             
0633+  6649~            		else
0633+  6649~            		else
0633+  6649~            		else
0633+  6649~            		else
0633+  6649~            		else
0633+  6649             
0633+  6649~            		else
0633+  6649~            		else
0633+  6649             
0633+  6649~            		else
0633+  6649~            		else
0633+  6649             
0634+  6649 86 08       			lampOn(4,3)
0634+  664B 9A 0A       
0634+  664D 97 0A       
0635+  664F             		endif
0635+  664F             
0635+  664F             
0635+  664F             
0635+  664F             
0635+  664F             
0635+  664F~            		endif
0635+  664F~            		endif
0635+  664F             
0635+  664F~            		endif
0635+  664F~            		endif
0635+  664F             
0635+  6648             
0635+  6648 06          
0635+  6649             
0635+  6649             
0635+  6649~            		endif
0635+  6649~            		endif
0635+  6649~            		endif
0635+  6649             
0635+  664F             
0635+  664F~            		endif
0635+  664F~            		endif
0635+  664F             
0636+  664F             		
0637+  664F BD 7E E9    		score10()
0638+  6652 BD 7F 16    		advBonus()
0639+  6655             		done(1)
0639+  6655~            		done(1)
0639+  6655~            		done(1)
0639+  6655~            		done(1)
0639+  6655~            		done(1)
0639+  6655             
0639+  6655 7E 79 E6    
0640+  6658             	else
0640+  6658             
0640+  6658             
0640+  6658             
0640+  6658             
0640+  6624             
0640+  6624             
0640+  6624             
0640+  6624~            	else
0640+  6624~            	else
0640+  6624~            	else
0640+  6624~            	else
0640+  6624             
0640+  6624~            	else
0640+  6624~            	else
0640+  6624~            	else
0640+  6624~            	else
0640+  6624             
0640+  6624             
0640+  6624 35          
0640+  6658             
0640+  6658 20 FE       
0640+  665A             
0640+  665A             
0640+  665A             
0640+  665A~            	else
0640+  665A~            	else
0640+  665A~            	else
0640+  665A~            	else
0640+  665A~            	else
0640+  665A             
0640+  665A~            	else
0640+  665A~            	else
0640+  665A             
0640+  665A~            	else
0640+  665A~            	else
0640+  665A             
0641+  665A             		done(0)
0641+  665A             
0641+  665A 86 02       
0641+  665C BA 01 6B    
0641+  665F B7 01 6B    
0641+  6662             
0641+  6662 7E 79 E6    
0642+  6665             	endif
0642+  6665             
0642+  6665             
0642+  6665             
0642+  6665             
0642+  6665             
0642+  6665~            	endif
0642+  6665~            	endif
0642+  6665             
0642+  6665~            	endif
0642+  6665~            	endif
0642+  6665             
0642+  6659             
0642+  6659 0B          
0642+  665A             
0642+  665A             
0642+  665A~            	endif
0642+  665A~            	endif
0642+  665A~            	endif
0642+  665A             
0642+  6665             
0642+  6665~            	endif
0642+  6665~            	endif
0642+  6665             
0643+  6665             swAdvBonus:
0644+  6665 BD 7F 16    	advBonus()
0645+  6668 BD 7F 06    	score1000()
0646+  666B             	done(1)
0646+  666B~            	done(1)
0646+  666B~            	done(1)
0646+  666B~            	done(1)
0646+  666B~            	done(1)
0646+  666B             
0646+  666B 7E 79 E6    
0647+  666E             swSpinner:
0648+  666E             	;ldaA	>sc(4)
0649+  666E             	;bitA	sr(6)
0650+  666E             	;ifne
0651+  666E             	;	score100()
0652+  666E             	;	ldaA	$E
0653+  666E             	;else
0654+  666E             	;	noValidate
0655+  666E             	;	ldaA	0
0656+  666E             	;endif
0657+  666E             	;staA	solenoid1 + CLICKER - 1
0658+  666E             	
0659+  666E 86 08       	ldaA	lr(4) ; spinner
0660+  6670 95 0A       	bitA	>lc(3)
0661+  6672             	ifne ; spinner on
0661+  6672             
0661+  6672 27 FE       
0662+  6674 7D 00 BA    		tst	>spinnerTimer
0663+  6677             		ifne
0663+  6677             
0663+  6677 27 FE       
0664+  6679 86 20       			ldaA	32
0665+  667B 97 BA       			staA	spinnerTimer
0666+  667D 86 0A       			ldaA	10
0667+  667F 95 02       			bitA	>counter
0668+  6681             			ifeq
0668+  6681             
0668+  6681 26 FE       
0669+  6683 BD 7F 16    				advBonus()
0670+  6686             			endif
0670+  6686             
0670+  6686             
0670+  6686             
0670+  6686             
0670+  6686             
0670+  6686~            			endif
0670+  6686~            			endif
0670+  6686             
0670+  6686~            			endif
0670+  6686~            			endif
0670+  6686             
0670+  6682             
0670+  6682 03          
0670+  6683             
0670+  6683             
0670+  6683~            			endif
0670+  6683~            			endif
0670+  6683~            			endif
0670+  6683             
0670+  6686             
0670+  6686~            			endif
0670+  6686~            			endif
0670+  6686             
0671+  6686             		endif
0671+  6686             
0671+  6686             
0671+  6686             
0671+  6686             
0671+  6686             
0671+  6686~            		endif
0671+  6686~            		endif
0671+  6686             
0671+  6686~            		endif
0671+  6686~            		endif
0671+  6686             
0671+  6678             
0671+  6678 0D          
0671+  6679             
0671+  6679             
0671+  6679~            		endif
0671+  6679~            		endif
0671+  6679~            		endif
0671+  6679             
0671+  6686             
0671+  6686~            		endif
0671+  6686~            		endif
0671+  6686             
0672+  6686 BD 7E F7    		score100()
0673+  6689 C6 01       		fireSolenoid(CLICKER)
0673+  668B F7 01 4C    
0674+  668E             	else
0674+  668E             
0674+  668E             
0674+  668E             
0674+  668E             
0674+  6673             
0674+  6673             
0674+  6673             
0674+  6673~            	else
0674+  6673~            	else
0674+  6673~            	else
0674+  6673~            	else
0674+  6673             
0674+  6673~            	else
0674+  6673~            	else
0674+  6673~            	else
0674+  6673~            	else
0674+  6673             
0674+  6673             
0674+  6673 1C          
0674+  668E             
0674+  668E 20 FE       
0674+  6690             
0674+  6690             
0674+  6690             
0674+  6690~            	else
0674+  6690~            	else
0674+  6690~            	else
0674+  6690~            	else
0674+  6690~            	else
0674+  6690             
0674+  6690~            	else
0674+  6690~            	else
0674+  6690             
0674+  6690~            	else
0674+  6690~            	else
0674+  6690             
0675+  6690 7D 00 BA    		tst	>spinnerTimer
0676+  6693             		ifne
0676+  6693             
0676+  6693 27 FE       
0677+  6695 86 20       			ldaA	32
0678+  6697 97 BA       			staA	spinnerTimer
0679+  6699 BD 7E F7    			score100()
0680+  669C C6 01       			fireSolenoid(CLICKER)
0680+  669E F7 01 4C    
0681+  66A1             		else
0681+  66A1             
0681+  66A1             
0681+  66A1             
0681+  66A1             
0681+  6694             
0681+  6694             
0681+  6694             
0681+  6694~            		else
0681+  6694~            		else
0681+  6694~            		else
0681+  6694~            		else
0681+  6694             
0681+  6694~            		else
0681+  6694~            		else
0681+  6694~            		else
0681+  6694~            		else
0681+  6694             
0681+  6694             
0681+  6694 0E          
0681+  66A1             
0681+  66A1 20 FE       
0681+  66A3             
0681+  66A3             
0681+  66A3             
0681+  66A3~            		else
0681+  66A3~            		else
0681+  66A3~            		else
0681+  66A3~            		else
0681+  66A3~            		else
0681+  66A3             
0681+  66A3~            		else
0681+  66A3~            		else
0681+  66A3             
0681+  66A3~            		else
0681+  66A3~            		else
0681+  66A3             
0682+  66A3 BD 7E E9    			score10()
0683+  66A6             		endif
0683+  66A6             
0683+  66A6             
0683+  66A6             
0683+  66A6             
0683+  66A6             
0683+  66A6~            		endif
0683+  66A6~            		endif
0683+  66A6             
0683+  66A6~            		endif
0683+  66A6~            		endif
0683+  66A6             
0683+  66A2             
0683+  66A2 03          
0683+  66A3             
0683+  66A3             
0683+  66A3~            		endif
0683+  66A3~            		endif
0683+  66A3~            		endif
0683+  66A3             
0683+  66A6             
0683+  66A6~            		endif
0683+  66A6~            		endif
0683+  66A6             
0684+  66A6             	endif
0684+  66A6             
0684+  66A6             
0684+  66A6             
0684+  66A6             
0684+  66A6             
0684+  66A6~            	endif
0684+  66A6~            	endif
0684+  66A6             
0684+  66A6~            	endif
0684+  66A6~            	endif
0684+  66A6             
0684+  668F             
0684+  668F 16          
0684+  6690             
0684+  6690             
0684+  6690~            	endif
0684+  6690~            	endif
0684+  6690~            	endif
0684+  6690             
0684+  66A6             
0684+  66A6~            	endif
0684+  66A6~            	endif
0684+  66A6             
0685+  66A6             	done(1)
0685+  66A6~            	done(1)
0685+  66A6~            	done(1)
0685+  66A6~            	done(1)
0685+  66A6~            	done(1)
0685+  66A6             
0685+  66A6 7E 79 E6    
0686+  66A9             
0687+  66A9             swCaptiveRollover:
0688+  66A9 96 09       	ldaA	>lc(2)
0689+  66AB 85 40       	bitA	lr(7)
0690+  66AD             	ifeq ; light off
0690+  66AD             
0690+  66AD 26 FE       
0691+  66AF BD 7E E9    		score10()
0692+  66B2             	else
0692+  66B2             
0692+  66B2             
0692+  66B2             
0692+  66B2             
0692+  66AE             
0692+  66AE             
0692+  66AE             
0692+  66AE~            	else
0692+  66AE~            	else
0692+  66AE~            	else
0692+  66AE~            	else
0692+  66AE             
0692+  66AE~            	else
0692+  66AE~            	else
0692+  66AE~            	else
0692+  66AE~            	else
0692+  66AE             
0692+  66AE             
0692+  66AE 05          
0692+  66B2             
0692+  66B2 20 FE       
0692+  66B4             
0692+  66B4             
0692+  66B4             
0692+  66B4~            	else
0692+  66B4~            	else
0692+  66B4~            	else
0692+  66B4~            	else
0692+  66B4~            	else
0692+  66B4             
0692+  66B4~            	else
0692+  66B4~            	else
0692+  66B4             
0692+  66B4~            	else
0692+  66B4~            	else
0692+  66B4             
0693+  66B4 BD 7F 06    		score1000()
0694+  66B7 86 0E       		ldaA	14 ; captive rollover switch number
0695+  66B9 91 A8       		cmpA	>lastSwitch
0696+  66BB             		ifne
0696+  66BB             
0696+  66BB 27 FE       
0697+  66BD 86 0F       			ldaA	15 ; captive rollover switch number
0698+  66BF 91 A8       			cmpA	>lastSwitch
0699+  66C1             			ifne
0699+  66C1             
0699+  66C1 27 FE       
0700+  66C3 BD 66 E0    				jsr	captiveAward
0701+  66C6             			endif
0701+  66C6             
0701+  66C6             
0701+  66C6             
0701+  66C6             
0701+  66C6             
0701+  66C6~            			endif
0701+  66C6~            			endif
0701+  66C6             
0701+  66C6~            			endif
0701+  66C6~            			endif
0701+  66C6             
0701+  66C2             
0701+  66C2 03          
0701+  66C3             
0701+  66C3             
0701+  66C3~            			endif
0701+  66C3~            			endif
0701+  66C3~            			endif
0701+  66C3             
0701+  66C6             
0701+  66C6~            			endif
0701+  66C6~            			endif
0701+  66C6             
0702+  66C6             		endif
0702+  66C6             
0702+  66C6             
0702+  66C6             
0702+  66C6             
0702+  66C6             
0702+  66C6~            		endif
0702+  66C6~            		endif
0702+  66C6             
0702+  66C6~            		endif
0702+  66C6~            		endif
0702+  66C6             
0702+  66BC             
0702+  66BC 09          
0702+  66BD             
0702+  66BD             
0702+  66BD~            		endif
0702+  66BD~            		endif
0702+  66BD~            		endif
0702+  66BD             
0702+  66C6             
0702+  66C6~            		endif
0702+  66C6~            		endif
0702+  66C6             
0703+  66C6             	endif
0703+  66C6             
0703+  66C6             
0703+  66C6             
0703+  66C6             
0703+  66C6             
0703+  66C6~            	endif
0703+  66C6~            	endif
0703+  66C6             
0703+  66C6~            	endif
0703+  66C6~            	endif
0703+  66C6             
0703+  66B3             
0703+  66B3 12          
0703+  66B4             
0703+  66B4             
0703+  66B4~            	endif
0703+  66B4~            	endif
0703+  66B4~            	endif
0703+  66B4             
0703+  66C6             
0703+  66C6~            	endif
0703+  66C6~            	endif
0703+  66C6             
0704+  66C6             	done(1)
0704+  66C6~            	done(1)
0704+  66C6~            	done(1)
0704+  66C6~            	done(1)
0704+  66C6~            	done(1)
0704+  66C6             
0704+  66C6 7E 79 E6    
0705+  66C9             
0706+  66C9             swCaptiveTarget:
0707+  66C9 BD 7F 16    	advBonus()
0708+  66CC 96 09       	ldaA	>lc(2)
0709+  66CE 85 40       	bitA	lr(7)
0710+  66D0             	ifeq ; light off
0710+  66D0             
0710+  66D0 26 FE       
0711+  66D2 BD 7E E9    		score10()
0712+  66D5 BD 66 E0    		jsr	captiveAward
0713+  66D8             	else
0713+  66D8             
0713+  66D8             
0713+  66D8             
0713+  66D8             
0713+  66D1             
0713+  66D1             
0713+  66D1             
0713+  66D1~            	else
0713+  66D1~            	else
0713+  66D1~            	else
0713+  66D1~            	else
0713+  66D1             
0713+  66D1~            	else
0713+  66D1~            	else
0713+  66D1~            	else
0713+  66D1~            	else
0713+  66D1             
0713+  66D1             
0713+  66D1 08          
0713+  66D8             
0713+  66D8 20 FE       
0713+  66DA             
0713+  66DA             
0713+  66DA             
0713+  66DA~            	else
0713+  66DA~            	else
0713+  66DA~            	else
0713+  66DA~            	else
0713+  66DA~            	else
0713+  66DA             
0713+  66DA~            	else
0713+  66DA~            	else
0713+  66DA             
0713+  66DA~            	else
0713+  66DA~            	else
0713+  66DA             
0714+  66DA BD 7F 06    		score1000()
0715+  66DD             	endif
0715+  66DD             
0715+  66DD             
0715+  66DD             
0715+  66DD             
0715+  66DD             
0715+  66DD~            	endif
0715+  66DD~            	endif
0715+  66DD             
0715+  66DD~            	endif
0715+  66DD~            	endif
0715+  66DD             
0715+  66D9             
0715+  66D9 03          
0715+  66DA             
0715+  66DA             
0715+  66DA~            	endif
0715+  66DA~            	endif
0715+  66DA~            	endif
0715+  66DA             
0715+  66DD             
0715+  66DD~            	endif
0715+  66DD~            	endif
0715+  66DD             
0716+  66DD             	done(1)
0716+  66DD~            	done(1)
0716+  66DD~            	done(1)
0716+  66DD~            	done(1)
0716+  66DD~            	done(1)
0716+  66DD             
0716+  66DD 7E 79 E6    
0717+  66E0             	
0718+  66E0             captiveAward:
0719+  66E0 86 01       	fork(10)
0719+  66E2 BD 7E 80    
0720+  66E5 39          	rts
0721+  66E6 01          	nop
0722+  66E7 01          	nop
0723+  66E8             	
0724+  66E8             	beginFork()
0725+  66E8 86 80       	lampOn(8,2) ; right special
0725+  66EA 9A 09       
0725+  66EC 97 09       
0726+  66EE             	
0727+  66EE 96 09       	ldaA	>lc(2)
0728+  66F0 85 08       	bitA	lr(4) ; shoe 1
0729+  66F2             	ifeq
0729+  66F2             
0729+  66F2 26 FE       
0730+  66F4 DE 2C       		endFork()
0730+  66F6 7E 79 52    
0731+  66F9             	else
0731+  66F9             
0731+  66F9             
0731+  66F9             
0731+  66F9             
0731+  66F3             
0731+  66F3             
0731+  66F3             
0731+  66F3~            	else
0731+  66F3~            	else
0731+  66F3~            	else
0731+  66F3~            	else
0731+  66F3             
0731+  66F3~            	else
0731+  66F3~            	else
0731+  66F3~            	else
0731+  66F3~            	else
0731+  66F3             
0731+  66F3             
0731+  66F3 07          
0731+  66F9             
0731+  66F9 20 FE       
0731+  66FB             
0731+  66FB             
0731+  66FB             
0731+  66FB~            	else
0731+  66FB~            	else
0731+  66FB~            	else
0731+  66FB~            	else
0731+  66FB~            	else
0731+  66FB             
0731+  66FB~            	else
0731+  66FB~            	else
0731+  66FB             
0731+  66FB~            	else
0731+  66FB~            	else
0731+  66FB             
0732+  66FB 85 20       		bitA	lr(6)
0733+  66FD             		ifne
0733+  66FD             
0733+  66FD 27 FE       
0734+  66FF 86 20       			flashLamp(6,2)
0734+  6701 9A A1       
0734+  6703 97 A1       
0735+  6705             		else
0735+  6705             
0735+  6705             
0735+  6705             
0735+  6705             
0735+  66FE             
0735+  66FE             
0735+  66FE             
0735+  66FE~            		else
0735+  66FE~            		else
0735+  66FE~            		else
0735+  66FE~            		else
0735+  66FE             
0735+  66FE~            		else
0735+  66FE~            		else
0735+  66FE~            		else
0735+  66FE~            		else
0735+  66FE             
0735+  66FE             
0735+  66FE 08          
0735+  6705             
0735+  6705 20 FE       
0735+  6707             
0735+  6707             
0735+  6707             
0735+  6707~            		else
0735+  6707~            		else
0735+  6707~            		else
0735+  6707~            		else
0735+  6707~            		else
0735+  6707             
0735+  6707~            		else
0735+  6707~            		else
0735+  6707             
0735+  6707~            		else
0735+  6707~            		else
0735+  6707             
0736+  6707 85 10       			bitA	lr(5)
0737+  6709             			ifne
0737+  6709             
0737+  6709 27 FE       
0738+  670B 86 10       				flashLamp(5,2)
0738+  670D 9A A1       
0738+  670F 97 A1       
0739+  6711             			else
0739+  6711             
0739+  6711             
0739+  6711             
0739+  6711             
0739+  670A             
0739+  670A             
0739+  670A             
0739+  670A~            			else
0739+  670A~            			else
0739+  670A~            			else
0739+  670A~            			else
0739+  670A             
0739+  670A~            			else
0739+  670A~            			else
0739+  670A~            			else
0739+  670A~            			else
0739+  670A             
0739+  670A             
0739+  670A 08          
0739+  6711             
0739+  6711 20 FE       
0739+  6713             
0739+  6713             
0739+  6713             
0739+  6713~            			else
0739+  6713~            			else
0739+  6713~            			else
0739+  6713~            			else
0739+  6713~            			else
0739+  6713             
0739+  6713~            			else
0739+  6713~            			else
0739+  6713             
0739+  6713~            			else
0739+  6713~            			else
0739+  6713             
0740+  6713 86 08       				flashLamp(4,2)
0740+  6715 9A A1       
0740+  6717 97 A1       
0741+  6719             			endif
0741+  6719             
0741+  6719             
0741+  6719             
0741+  6719             
0741+  6719             
0741+  6719~            			endif
0741+  6719~            			endif
0741+  6719             
0741+  6719~            			endif
0741+  6719~            			endif
0741+  6719             
0741+  6712             
0741+  6712 06          
0741+  6713             
0741+  6713             
0741+  6713~            			endif
0741+  6713~            			endif
0741+  6713~            			endif
0741+  6713             
0741+  6719             
0741+  6719~            			endif
0741+  6719~            			endif
0741+  6719             
0742+  6719             		endif
0742+  6719             
0742+  6719             
0742+  6719             
0742+  6719             
0742+  6719             
0742+  6719~            		endif
0742+  6719~            		endif
0742+  6719             
0742+  6719~            		endif
0742+  6719~            		endif
0742+  6719             
0742+  6706             
0742+  6706 12          
0742+  6707             
0742+  6707             
0742+  6707~            		endif
0742+  6707~            		endif
0742+  6707~            		endif
0742+  6707             
0742+  6719             
0742+  6719~            		endif
0742+  6719~            		endif
0742+  6719             
0743+  6719             	endif
0743+  6719             
0743+  6719             
0743+  6719             
0743+  6719             
0743+  6719             
0743+  6719~            	endif
0743+  6719~            	endif
0743+  6719             
0743+  6719~            	endif
0743+  6719~            	endif
0743+  6719             
0743+  66FA             
0743+  66FA 1E          
0743+  66FB             
0743+  66FB             
0743+  66FB~            	endif
0743+  66FB~            	endif
0743+  66FB~            	endif
0743+  66FB             
0743+  6719             
0743+  6719~            	endif
0743+  6719~            	endif
0743+  6719             
0744+  6719             	
0745+  6719 86 04       	ldaA	lr(3)
0746+  671B 95 09       	bitA	>lc(2)
0747+  671D             	ifne ; double bonus
0747+  671D             
0747+  671D 27 FE       
0748+  671F 96 B0       		ldaA	>p_Bonus
0749+  6721             	else
0749+  6721             
0749+  6721             
0749+  6721             
0749+  6721             
0749+  671E             
0749+  671E             
0749+  671E             
0749+  671E~            	else
0749+  671E~            	else
0749+  671E~            	else
0749+  671E~            	else
0749+  671E             
0749+  671E~            	else
0749+  671E~            	else
0749+  671E~            	else
0749+  671E~            	else
0749+  671E             
0749+  671E             
0749+  671E 04          
0749+  6721             
0749+  6721 20 FE       
0749+  6723             
0749+  6723             
0749+  6723             
0749+  6723~            	else
0749+  6723~            	else
0749+  6723~            	else
0749+  6723~            	else
0749+  6723~            	else
0749+  6723             
0749+  6723~            	else
0749+  6723~            	else
0749+  6723             
0749+  6723~            	else
0749+  6723~            	else
0749+  6723             
0750+  6723 86 01       		ldaA	1
0751+  6725             	endif	
0751+  6725             
0751+  6725             
0751+  6725             
0751+  6725             
0751+  6725             
0751+  6725~            	endif	
0751+  6725~            	endif	
0751+  6725             
0751+  6725~            	endif	
0751+  6725~            	endif	
0751+  6725             
0751+  6722             
0751+  6722 02          
0751+  6723             
0751+  6723             
0751+  6723~            	endif	
0751+  6723~            	endif	
0751+  6723~            	endif	
0751+  6723             
0751+  6725             
0751+  6725~            	endif	
0751+  6725~            	endif	
0751+  6725             
0752+  6725 97 BE       	staA	p_BonusLeft
0753+  6727             	
0754+  6727             captiveAward_bonusLoop:
0755+  6727 BD 7F 06    	score1000()
0756+  672A 7A 00 B0    	dec	p_Bonus
0757+  672D BD 60 C3    	jsr	bonusLights
0758+  6730 86 19       	delay(200)
0758+  6732 BD 7E 6B    
0759+  6735 7D 00 B0    	tst	>p_Bonus
0760+  6738 26 ED       	bne	captiveAward_bonusLoop
0761+  673A             	
0762+  673A 86 38       	ldaA	00111000b
0763+  673C 94 A1       	andA	>flc(2)
0764+  673E 43          	comA
0765+  673F 94 09       	andA	>lc(2)
0766+  6741 97 09       	staA	lc(2)
0767+  6743             	
0768+  6743 96 BE       	ldaA	>p_BonusLeft
0769+  6745 97 B0       	staA	p_Bonus
0770+  6747             	
0771+  6747 DE 2C       	endFork()	
0771+  6749 7E 79 52    
0772+  674C             	
0773+  674C             	
0774+  674C             alternate:
0775+  674C C6 00       	ldaB	0 ; turn on left?
0776+  674E 86 80       	ldaA	lr(8) ; right special
0777+  6750 95 09       	bitA	>lc(2)
0778+  6752             	ifne
0778+  6752             
0778+  6752 27 FE       
0779+  6754 C6 01       		ldaB	1
0780+  6756 86 7F       		lampOff(8,2) ; right special
0780+  6758 94 09       
0780+  675A 97 09       
0781+  675C             	endif
0781+  675C             
0781+  675C             
0781+  675C             
0781+  675C             
0781+  675C             
0781+  675C~            	endif
0781+  675C~            	endif
0781+  675C             
0781+  675C~            	endif
0781+  675C~            	endif
0781+  675C             
0781+  6753             
0781+  6753 08          
0781+  6754             
0781+  6754             
0781+  6754~            	endif
0781+  6754~            	endif
0781+  6754~            	endif
0781+  6754             
0781+  675C             
0781+  675C~            	endif
0781+  675C~            	endif
0781+  675C             
0782+  675C 86 02       	ldaA	lr(2) ; left special
0783+  675E 95 0A       	bitA	>lc(3)
0784+  6760             	ifne
0784+  6760             
0784+  6760 27 FE       
0785+  6762 86 80       		lampOn(8,2) ; right special
0785+  6764 9A 09       
0785+  6766 97 09       
0786+  6768 86 FD       		lampOff(2,3) ; left special
0786+  676A 94 0A       
0786+  676C 97 0A       
0787+  676E             	endif
0787+  676E             
0787+  676E             
0787+  676E             
0787+  676E             
0787+  676E             
0787+  676E~            	endif
0787+  676E~            	endif
0787+  676E             
0787+  676E~            	endif
0787+  676E~            	endif
0787+  676E             
0787+  6761             
0787+  6761 0C          
0787+  6762             
0787+  6762             
0787+  6762~            	endif
0787+  6762~            	endif
0787+  6762~            	endif
0787+  6762             
0787+  676E             
0787+  676E~            	endif
0787+  676E~            	endif
0787+  676E             
0788+  676E 5D          	tstB
0789+  676F             	ifne
0789+  676F             
0789+  676F 27 FE       
0790+  6771 86 02       		lampOn(2,3) ; left special
0790+  6773 9A 0A       
0790+  6775 97 0A       
0791+  6777             	endif
0791+  6777             
0791+  6777             
0791+  6777             
0791+  6777             
0791+  6777             
0791+  6777~            	endif
0791+  6777~            	endif
0791+  6777             
0791+  6777~            	endif
0791+  6777~            	endif
0791+  6777             
0791+  6770             
0791+  6770 06          
0791+  6771             
0791+  6771             
0791+  6771~            	endif
0791+  6771~            	endif
0791+  6771~            	endif
0791+  6771             
0791+  6777             
0791+  6777~            	endif
0791+  6777~            	endif
0791+  6777             
0792+  6777 39          	rts
0793+  6778             	
0794+  6778             addCollect:
0795+  6778 96 09       	ldaA	>lc(2)
0796+  677A 85 08       	bitA	lr(4)
0797+  677C             	ifeq
0797+  677C             
0797+  677C 26 FE       
0798+  677E 86 08       		lampOn(4,2)
0798+  6780 9A 09       
0798+  6782 97 09       
0799+  6784 86 08       		flashLamp(4,2)
0799+  6786 9A A1       
0799+  6788 97 A1       
0800+  678A             	else
0800+  678A             
0800+  678A             
0800+  678A             
0800+  678A             
0800+  677D             
0800+  677D             
0800+  677D             
0800+  677D~            	else
0800+  677D~            	else
0800+  677D~            	else
0800+  677D~            	else
0800+  677D             
0800+  677D~            	else
0800+  677D~            	else
0800+  677D~            	else
0800+  677D~            	else
0800+  677D             
0800+  677D             
0800+  677D 0E          
0800+  678A             
0800+  678A 20 FE       
0800+  678C             
0800+  678C             
0800+  678C             
0800+  678C~            	else
0800+  678C~            	else
0800+  678C~            	else
0800+  678C~            	else
0800+  678C~            	else
0800+  678C             
0800+  678C~            	else
0800+  678C~            	else
0800+  678C             
0800+  678C~            	else
0800+  678C~            	else
0800+  678C             
0801+  678C 85 10       		bitA	lr(5)
0802+  678E             		ifeq
0802+  678E             
0802+  678E 26 FE       
0803+  6790 86 10       			lampOn(5,2)
0803+  6792 9A 09       
0803+  6794 97 09       
0804+  6796 86 10       			flashLamp(5,2)
0804+  6798 9A A1       
0804+  679A 97 A1       
0805+  679C             		else
0805+  679C             
0805+  679C             
0805+  679C             
0805+  679C             
0805+  678F             
0805+  678F             
0805+  678F             
0805+  678F~            		else
0805+  678F~            		else
0805+  678F~            		else
0805+  678F~            		else
0805+  678F             
0805+  678F~            		else
0805+  678F~            		else
0805+  678F~            		else
0805+  678F~            		else
0805+  678F             
0805+  678F             
0805+  678F 0E          
0805+  679C             
0805+  679C 20 FE       
0805+  679E             
0805+  679E             
0805+  679E             
0805+  679E~            		else
0805+  679E~            		else
0805+  679E~            		else
0805+  679E~            		else
0805+  679E~            		else
0805+  679E             
0805+  679E~            		else
0805+  679E~            		else
0805+  679E             
0805+  679E~            		else
0805+  679E~            		else
0805+  679E             
0806+  679E 85 20       			bitA	lr(6)
0807+  67A0             			ifeq
0807+  67A0             
0807+  67A0 26 FE       
0808+  67A2 86 20       				lampOn(6,2)
0808+  67A4 9A 09       
0808+  67A6 97 09       
0809+  67A8 86 20       				flashLamp(6,2)
0809+  67AA 9A A1       
0809+  67AC 97 A1       
0810+  67AE             			else
0810+  67AE             
0810+  67AE             
0810+  67AE             
0810+  67AE             
0810+  67A1             
0810+  67A1             
0810+  67A1             
0810+  67A1~            			else
0810+  67A1~            			else
0810+  67A1~            			else
0810+  67A1~            			else
0810+  67A1             
0810+  67A1~            			else
0810+  67A1~            			else
0810+  67A1~            			else
0810+  67A1~            			else
0810+  67A1             
0810+  67A1             
0810+  67A1 0E          
0810+  67AE             
0810+  67AE 20 FE       
0810+  67B0             
0810+  67B0             
0810+  67B0             
0810+  67B0~            			else
0810+  67B0~            			else
0810+  67B0~            			else
0810+  67B0~            			else
0810+  67B0~            			else
0810+  67B0             
0810+  67B0~            			else
0810+  67B0~            			else
0810+  67B0             
0810+  67B0~            			else
0810+  67B0~            			else
0810+  67B0             
0811+  67B0 BD 7F 06    				score1000()
0812+  67B3 86 04       				lampOn(3,3)
0812+  67B5 9A 0A       
0812+  67B7 97 0A       
0813+  67B9             			endif
0813+  67B9             
0813+  67B9             
0813+  67B9             
0813+  67B9             
0813+  67B9             
0813+  67B9~            			endif
0813+  67B9~            			endif
0813+  67B9             
0813+  67B9~            			endif
0813+  67B9~            			endif
0813+  67B9             
0813+  67AF             
0813+  67AF 09          
0813+  67B0             
0813+  67B0             
0813+  67B0~            			endif
0813+  67B0~            			endif
0813+  67B0~            			endif
0813+  67B0             
0813+  67B9             
0813+  67B9~            			endif
0813+  67B9~            			endif
0813+  67B9             
0814+  67B9             		endif
0814+  67B9             
0814+  67B9             
0814+  67B9             
0814+  67B9             
0814+  67B9             
0814+  67B9~            		endif
0814+  67B9~            		endif
0814+  67B9             
0814+  67B9~            		endif
0814+  67B9~            		endif
0814+  67B9             
0814+  679D             
0814+  679D 1B          
0814+  679E             
0814+  679E             
0814+  679E~            		endif
0814+  679E~            		endif
0814+  679E~            		endif
0814+  679E             
0814+  67B9             
0814+  67B9~            		endif
0814+  67B9~            		endif
0814+  67B9             
0815+  67B9             	endif
0815+  67B9             
0815+  67B9             
0815+  67B9             
0815+  67B9             
0815+  67B9             
0815+  67B9~            	endif
0815+  67B9~            	endif
0815+  67B9             
0815+  67B9~            	endif
0815+  67B9~            	endif
0815+  67B9             
0815+  678B             
0815+  678B 2D          
0815+  678C             
0815+  678C             
0815+  678C~            	endif
0815+  678C~            	endif
0815+  678C~            	endif
0815+  678C             
0815+  67B9             
0815+  67B9~            	endif
0815+  67B9~            	endif
0815+  67B9             
0816+  67B9 39          	rts
0817+  67BA             	
0818+  67BA             ; end callbacks
0819+  67BA             	.msfirst
0820+  67BA             ; needs to be on $**00 address
0821+  6000             callbackTable: 	.org $6000 ; note: TRANSPOSED
0822+  6000 62 21       	.dw swTilt	\.dw swTilt\.dw swStart	\.dw none\.dw none\.dw none\.dw swTilt\.dw none
0822+  6002 62 21       
0822+  6004 62 3A       
0822+  6006 60 C0       
0822+  6008 60 C0       
0822+  600A 60 C0       
0822+  600C 62 21       
0822+  600E 60 C0       
0823+  6010 62 71       	.dw swOuthole	\.dw swTilt\.dw swRightOutlane\.dw swRightInlane\.dw sw10pt\.dw sw500pt\.dw swCaptiveRollover\.dw swCaptiveTarget
0823+  6012 62 21       
0823+  6014 65 55       
0823+  6016 65 84       
0823+  6018 65 9D       
0823+  601A 65 B2       
0823+  601C 66 A9       
0823+  601E 66 C9       
0824+  6020 66 02       	.dw swDropTip	\.dw swDroptIp\.dw swDroptiP\.dw swAdvBonus\.dw sw10pt\.dw swTopEject\.dw sw10pt\.dw none
0824+  6022 66 0C       
0824+  6024 66 16       
0824+  6026 66 65       
0824+  6028 65 9D       
0824+  602A 63 FC       
0824+  602C 65 9D       
0824+  602E 60 C0       
0825+  6030 66 07       	.dw swDropHot	\.dw swDrophOt\.dw swDrophoT\.dw sw10pt\.dw swLeftEject\.dw swSpinner\.dw swPop\.dw sw500pt
0825+  6032 66 11       
0825+  6034 66 1B       
0825+  6036 65 9D       
0825+  6038 63 63       
0825+  603A 66 6E       
0825+  603C 65 F9       
0825+  603E 65 B2       
0826+  6040 65 2F       	.dw swLeftOutlane\.dw swLeftInlane\.dw sw10pt\.dw none\.dw swHotTip\.dw none\.dw none\.dw none
0826+  6042 65 7B       
0826+  6044 65 9D       
0826+  6046 60 C0       
0826+  6048 64 E5       
0826+  604A 60 C0       
0826+  604C 60 C0       
0826+  604E 60 C0       
0827+  6050 60 C0       	.dw none	\.dw none\.dw none\.dw none\.dw none\.dw none\.dw none\.dw none
0827+  6052 60 C0       
0827+  6054 60 C0       
0827+  6056 60 C0       
0827+  6058 60 C0       
0827+  605A 60 C0       
0827+  605C 60 C0       
0827+  605E 60 C0       
0828+  6060 60 C0       	.dw none	\.dw none\.dw none\.dw none\.dw none\.dw none\.dw none\.dw none
0828+  6062 60 C0       
0828+  6064 60 C0       
0828+  6066 60 C0       
0828+  6068 60 C0       
0828+  606A 60 C0       
0828+  606C 60 C0       
0828+  606E 60 C0       
0829+  6070 60 C0       	.dw none	\.dw none\.dw none\.dw none\.dw none\.dw none\.dw none\.dw none
0829+  6072 60 C0       
0829+  6074 60 C0       
0829+  6076 60 C0       
0829+  6078 60 C0       
0829+  607A 60 C0       
0829+  607C 60 C0       
0829+  607E 60 C0       
0830+  6080             ; on = how many cycles it must be on for before registering (1 cycle = 64ms (?)) (max 7)
0831+  6080             ; off = how many cycles it must be off for
0832+  6080             ; onOnly = if true, don't notify of an off event (also set off = 0 for efficiency)
0833+  6080             ; gameover = whether the switch is active in gameover + tilt mode (these callbacks must check whether in game over when triggered if they want to act different)
0834+  6080             ; TRANSPOSED (?)
0835+  6080             #define SW(on,off,onOnly,gameover) .db (onOnly<<7)|(gameover<<6)|(on<<3)|(off) 
0836+  6080             settleTable: ; must be right after callbackTable
0837+  6080 87          	SW(0,7,1,0)\SW(0,7,1,0)\SW(0,2,1,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,1,0)\SW(0,7,0,1)
0837+  6081 87          
0837+  6082 C2          
0837+  6083 47          
0837+  6084 47          
0837+  6085 47          
0837+  6086 87          
0837+  6087 47          
0838+  6088 F9          	SW(7,1,1,1)\SW(0,7,1,0)\SW(0,7,1,0)\SW(0,7,1,0)\SW(0,1,1,0)\SW(0,1,1,0)\SW(0,0,1,0)\SW(0,7,1,0)
0838+  6089 87          
0838+  608A 87          
0838+  608B 87          
0838+  608C 81          
0838+  608D 81          
0838+  608E 80          
0838+  608F 87          
0839+  6090 87          	SW(0,7,1,0)\SW(0,7,1,0)\SW(0,7,1,0)\SW(0,3,1,0)\SW(0,3,1,0)\SW(4,1,1,1)\SW(0,1,1,0)\SW(0,0,1,0)
0839+  6091 87          
0839+  6092 87          
0839+  6093 83          
0839+  6094 83          
0839+  6095 E1          
0839+  6096 81          
0839+  6097 80          
0840+  6098 87          	SW(0,7,1,0)\SW(0,7,1,0)\SW(0,7,1,0)\SW(0,3,1,0)\SW(4,1,1,1)\SW(0,0,1,0)\SW(0,0,1,0)\SW(0,1,1,0)
0840+  6099 87          
0840+  609A 87          
0840+  609B 83          
0840+  609C E1          
0840+  609D 80          
0840+  609E 80          
0840+  609F 81          
0841+  60A0 87          	SW(0,7,1,0)\SW(0,7,1,0)\SW(0,1,1,0)\SW(0,7,0,1)\SW(0,0,1,0)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)
0841+  60A1 87          
0841+  60A2 81          
0841+  60A3 47          
0841+  60A4 80          
0841+  60A5 47          
0841+  60A6 47          
0841+  60A7 47          
0842+  60A8 FF          	SW(7,7,1,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)
0842+  60A9 47          
0842+  60AA 47          
0842+  60AB 47          
0842+  60AC 47          
0842+  60AD 47          
0842+  60AE 47          
0842+  60AF 47          
0843+  60B0 47          	SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)
0843+  60B1 47          
0843+  60B2 47          
0843+  60B3 47          
0843+  60B4 47          
0843+  60B5 47          
0843+  60B6 47          
0843+  60B7 47          
0844+  60B8 47          	SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)\SW(0,7,0,1)0844+  60B9 47          
0844+  60BA 47          
0844+  60BB 47          
0844+  60BC 47          
0844+  60BD 47          
0844+  60BE 47          
0844+  60BF 47          
0008   60C0             	
0009   7800             main:		.org $7800
0010   7800             
0011   7800             test:
0012   7800             	
0013   7800             piaSetup:
0014   7800 86 00       	ldaA	00000000b	;select direction (3rd bit = 0)
0015   7802 B7 28 01    	staA 	displayStrobeC
0016   7805 86 3F       	ldaA 	00111111b	;set LED pins to outputs
0017   7807 B7 28 00    	staA 	displayStrobe
0018   780A 86 04       	ldaA 	00000100b 	;select data (3rb bit = 1)
0019   780C B7 28 01    	staA 	displayStrobeC
0020   780F 86 00       	ldaA	00000000b
0021   7811 B7 28 00    	staA	displayStrobe
0022   7814             	
0023   7814 86 00       	ldaA	00000000b	;select direction (3rd bit = 0)
0024   7816 B7 28 03    	staA 	displayBcdC
0025   7819 86 FF       	ldaA 	11111111b	;set display BCD to output
0026   781B B7 28 02    	staA 	displayBcd
0027   781E 86 04       	ldaA 	00000100b 	;select data (3rb bit = 1)
0028   7820 B7 28 03    	staA 	displayBcdC
0029   7823 86 00       	ldaA	00000000b
0030   7825 B7 28 02    	staA	displayBcd
0031   7828             	
0032   7828 86 00       	ldaA	00000000b	;select direction (3rd bit = 0)
0033   782A B7 24 01    	staA 	lampColC
0034   782D 86 FF       	ldaA 	11111111b	;set to output
0035   782F B7 24 00    	staA 	lampCol
0036   7832 86 04       	ldaA 	00000100b 	;select data (3rb bit = 1)
0037   7834 B7 24 01    	staA 	lampColC
0038   7837 86 00       	ldaA	00000000b
0039   7839 B7 24 00    	staA	lampCol
0040   783C             	
0041   783C 86 00       	ldaA	00000000b	;select direction (3rd bit = 0)
0042   783E B7 24 03    	staA 	lampStrobeC
0043   7841 86 FF       	ldaA 	11111111b	;set to output
0044   7843 B7 24 02    	staA 	lampStrobe
0045   7846 86 04       	ldaA 	00000100b 	;select data (3rb bit = 1)
0046   7848 B7 24 03    	staA 	lampStrobeC
0047   784B 86 00       	ldaA	00000000b
0048   784D B7 24 02    	staA	lampStrobe
0049   7850             	
0050   7850 86 00       	ldaA	00000000b	;select direction (3rd bit = 0)
0051   7852 B7 30 03    	staA 	switchStrobeC
0052   7855 86 FF       	ldaA 	11111111b	;set to output
0053   7857 B7 30 02    	staA 	switchStrobe
0054   785A 86 04       	ldaA 	00000100b 	;select data (3rb bit = 1)
0055   785C B7 30 03    	staA 	switchStrobeC
0056   785F 86 00       	ldaA	00000000b
0057   7861 B7 30 02    	staA	switchStrobe
0058   7864             	
0059   7864 86 00       	ldaA	00000000b	;select direction (3rd bit = 0)
0060   7866 B7 30 01    	staA 	switchRowC
0061   7869 86 00       	ldaA 	00000000b	;set to input
0062   786B B7 30 00    	staA 	switchRow
0063   786E 86 04       	ldaA 	00000100b 	;select data (3rb bit = 1)
0064   7870 B7 30 01    	staA 	switchRowC
0065   7873 86 00       	ldaA	00000000b
0066   7875 B7 30 00    	staA	switchRow
0067   7878             	
0068   7878 86 00       	ldaA	00000000b	;select direction (3rd bit = 0)
0069   787A B7 22 01    	staA 	solenoidAC
0070   787D B7 22 03    	staA	solenoidBC
0071   7880 86 FF       	ldaA 	11111111b	;set to output
0072   7882 B7 22 00    	staA 	solenoidA
0073   7885 B7 22 02    	staA 	solenoidB
0074   7888 86 04       	ldaA 	00000100b 	;select data (3rb bit = 1)
0075   788A B7 22 01    	staA 	solenoidAC
0076   788D 86 34       	ldaA 	00110100b 	;select data (3rb bit = 1), enable CB2 output low
0077   788F B7 22 03    	staA 	solenoidBC
0078   7892             	
0079   7892             
0080   7892             resetRam:
0081   7892 CE 00 00    	ldX	RAM
0082   7895 86 00       	ldaA	0
0083   7897             resetRamLoop:
0084   7897 A7 00       	staA	0, X
0085   7899 08          	inX
0086   789A 8C 02 00    	cpX	RAMEnd + 1
0087   789D 26 F8       	bne	resetRamLoop
0088   789F             	
0089   789F             	
0090   789F 86 00       	ldaA 	0
0091   78A1 97 00       	staA	temp
0092   78A3 86 FF       	ldaA	$FF
0093   78A5 97 01       	staA	temp + 1
0094   78A7 9E 00       	ldS	>temp
0095   78A9             	
0096   78A9             ;
0097   78A9             
0098   78A9 86 00       	ldaA	00
0099   78AB D7 70       	staB	displayBcd1
0100   78AD             	
0101   78AD 86 7E       	ldaA	attractStart >> 8
0102   78AF 97 2A       	staA	attractX
0103   78B1 86 C1       	ldaA	attractStart&$FF
0104   78B3 97 2B       	staA	attractX + 1
0105   78B5             	
0106   78B5 86 FF       	ldaA	$FF	
0107   78B7 B7 28 00    	staA 	displayStrobe
0108   78BA             
0109   78BA 86 00       	ldaA	00
0110   78BC 97 07       	staA	strobe
0111   78BE B7 01 6A    	staA	displayCol
0112   78C1 97 31       	staA	scanStrobe
0113   78C3             	
0114   78C3 CE 00 00    	ldX 	0
0115   78C6 DF 50       	stX	curCol
0116   78C8 DF 2E       	stX	scanCurCol
0117   78CA             	
0118   78CA 86 00       	ldaA	0
0119   78CC 97 10       	staA	curSwitchRowLsb
0120   78CE 97 30       	staA	scanCurSwitchRowLsb
0121   78D0             	
0122   78D0             ; fill solenoid status with off
0123   78D0 86 0F       	ldaA	$F
0124   78D2 CE 01 40    	ldX	solenoid1
0125   78D5             lSolDefault:
0126   78D5 A7 00       	staA	0, X
0127   78D7 08          	inX
0128   78D8 8C 01 4F    	cpX	solenoid16
0129   78DB 26 F8       	bne	lSolDefault
0130   78DD             	
0131   78DD             ; clear 8 banks
0132   78DD 86 00       	ldaA 	0
0133   78DF CE 00 00    	ldX	0
0134   78E2             lClear8:
0135   78E2 A7 08       	staA	lampCol1, X
0136   78E4 A7 A0       	staA	flashLampCol1, X
0137   78E6 A7 80       	staA	waitLeft, X
0138   78E8 08          	inX
0139   78E9 8C 00 08    	cpX	8
0140   78EC 26 F4       	bne 	lClear8
0141   78EE             	
0142   78EE             ; empty settle
0143   78EE 86 00       	ldaA	$00
0144   78F0 CE 01 00    	ldX	settleRow1
0145   78F3             lSettleDefault:
0146   78F3 A7 00       	staA	0, X
0147   78F5 08          	inX
0148   78F6 8C 01 3F    	cpX	settleRow8End
0149   78F9 26 F8       	bne	lSettleDefault
0150   78FB             	
0151   78FB             ; empty queue
0152   78FB 86 FF       	ldaA	$FF
0153   78FD CE 00 60    	ldX	queue
0154   7900             lEmptyQueue:
0155   7900 A7 00       	staA	0, X
0156   7902 08          	inX
0157   7903 8C 00 6D    	cpX	queueEnd
0158   7906 26 F8       	bne	lEmptyQueue
0159   7908             	
0160   7908 86 00       	ldaA	0
0161   790A 97 54       	staA	queueHead + 0
0162   790C 97 56       	staA	queueTail + 0
0163   790E 86 60       	ldaA	queue
0164   7910 97 55       	staA	queueHead + 1
0165   7912 97 57       	staA	queueTail + 1
0166   7914             	
0167   7914             ; test numbers
0168   7914 86 20       	lampOn(6,8) ; game over
0168   7916 9A 0F       
0168   7918 97 0F       
0169   791A             
0170   791A             	
0171   791A BD 7E A2    	jsr resetScores
0172   791D             	
0173   791D             ; setup complete
0174   791D 0E          	clI		; enable timer interrupt
0175   791E             	
0176   791E             	
0177   791E             end:
0178   791E 86 F7       	ldaA	11110111b
0179   7920 B4 01 6B    	andA	>state
0180   7923 B7 01 6B    	staA	state
0181   7926             
0182   7926 B6 01 6C    	ldaA	>strobeReset
0183   7929 85 0F       	bitA	1111b
0184   792B             	ifne
0184   792B             
0184   792B 27 FE       
0185   792D 86 08       		ldaA	1000b
0186   792F BA 01 6B    		oraA	>state
0187   7932 B7 01 6B    		staA	state
0188   7935             		
0189   7935             		; dec wait timers
0190   7935 CE 00 7F    		ldX	waitLeft - 1
0191   7938             decWaitTimers:
0192   7938 08          		inX
0193   7939 A6 00       		ldaA	0, X
0194   793B             		ifne
0194   793B             
0194   793B 27 FE       
0195   793D 4A          			decA
0196   793E A7 00       			staA	0, X
0197   7940             			ifeq
0197   7940             
0197   7940 26 FE       
0198   7942 A6 08       				ldaA	waitMsb - waitLeft, X
0199   7944 97 58       				staA	tempQ
0200   7946 A6 10       				ldaA	waitLsb - waitLeft, X
0201   7948 97 59       				staA	tempQ + 1
0202   794A E6 18       				ldaB	waitReg - waitLeft, X
0203   794C DF 2C       				stX	forkX
0204   794E DE 58       				ldX	>tempQ
0205   7950 6E 00       				jmp	0, X
0206   7952             			endif
0206   7952             
0206   7952             
0206   7952             
0206   7952             
0206   7952             
0206   7952~            			endif
0206   7952~            			endif
0206   7952             
0206   7952~            			endif
0206   7952~            			endif
0206   7952             
0206   7941             
0206   7941 10          
0206   7942             
0206   7942             
0206   7942~            			endif
0206   7942~            			endif
0206   7942~            			endif
0206   7942             
0206   7952             
0206   7952~            			endif
0206   7952~            			endif
0206   7952             
0207   7952             		endif
0207   7952             
0207   7952             
0207   7952             
0207   7952             
0207   7952             
0207   7952~            		endif
0207   7952~            		endif
0207   7952             
0207   7952~            		endif
0207   7952~            		endif
0207   7952             
0207   793C             
0207   793C 15          
0207   793D             
0207   793D             
0207   793D~            		endif
0207   793D~            		endif
0207   793D~            		endif
0207   793D             
0207   7952             
0207   7952~            		endif
0207   7952~            		endif
0207   7952             
0208   7952             afterFork:
0209   7952 8C 00 87    		cpX	waitLeftEnd
0210   7955 26 E1       		bne	decWaitTimers
0211   7957             		
0212   7957             		
0213   7957 7A 00 A9    		dec	dropResetTimer
0214   795A             		ifmi
0214   795A             
0214   795A 2A FE       
0215   795C 7C 00 A9    			inc	dropResetTimer
0216   795F             		endif
0216   795F             
0216   795F             
0216   795F             
0216   795F             
0216   795F             
0216   795F~            		endif
0216   795F~            		endif
0216   795F             
0216   795F~            		endif
0216   795F~            		endif
0216   795F             
0216   795B             
0216   795B 03          
0216   795C             
0216   795C             
0216   795C~            		endif
0216   795C~            		endif
0216   795C~            		endif
0216   795C             
0216   795F             
0216   795F~            		endif
0216   795F~            		endif
0216   795F             
0217   795F 7A 00 BF    		dec	bonusTimer
0218   7962             		ifmi
0218   7962             
0218   7962 2A FE       
0219   7964 7C 00 BF    			inc	bonusTimer
0220   7967             		endif
0220   7967             
0220   7967             
0220   7967             
0220   7967             
0220   7967             
0220   7967~            		endif
0220   7967~            		endif
0220   7967             
0220   7967~            		endif
0220   7967~            		endif
0220   7967             
0220   7963             
0220   7963 03          
0220   7964             
0220   7964             
0220   7964~            		endif
0220   7964~            		endif
0220   7964~            		endif
0220   7964             
0220   7967             
0220   7967~            		endif
0220   7967~            		endif
0220   7967             
0221   7967 7D 00 BA    		tst	>spinnerTimer
0222   796A             		ifne
0222   796A             
0222   796A 27 FE       
0223   796C 7A 00 BA    			dec	spinnerTimer
0224   796F             			ifeq
0224   796F             
0224   796F 26 FE       
0225   7971 86 F7       				flashOff(4,3)
0225   7973 94 A2       
0225   7975 97 A2       
0226   7977 86 F7       				lampOff(4,3)
0226   7979 94 0A       
0226   797B 97 0A       
0227   797D 86 04       				ldaA	4
0228   797F 91 B5       				cmpA	>p_DropsDown
0229   7981             				ifgt
0229   7981             
0229   7981 23 FE       
0230   7983 86 F7       					lampOff(4,3) ; spinner
0230   7985 94 0A       
0230   7987 97 0A       
0231   7989             				else
0231   7989             
0231   7989             
0231   7989             
0231   7989             
0231   7982             
0231   7982             
0231   7982             
0231   7982~            				else
0231   7982~            				else
0231   7982~            				else
0231   7982~            				else
0231   7982             
0231   7982~            				else
0231   7982~            				else
0231   7982~            				else
0231   7982~            				else
0231   7982             
0231   7982             
0231   7982 08          
0231   7989             
0231   7989 20 FE       
0231   798B             
0231   798B             
0231   798B             
0231   798B~            				else
0231   798B~            				else
0231   798B~            				else
0231   798B~            				else
0231   798B~            				else
0231   798B             
0231   798B~            				else
0231   798B~            				else
0231   798B             
0231   798B~            				else
0231   798B~            				else
0231   798B             
0232   798B 86 08       					lampOn(4,3)
0232   798D 9A 0A       
0232   798F 97 0A       
0233   7991             				endif
0233   7991             
0233   7991             
0233   7991             
0233   7991             
0233   7991             
0233   7991~            				endif
0233   7991~            				endif
0233   7991             
0233   7991~            				endif
0233   7991~            				endif
0233   7991             
0233   798A             
0233   798A 06          
0233   798B             
0233   798B             
0233   798B~            				endif
0233   798B~            				endif
0233   798B~            				endif
0233   798B             
0233   7991             
0233   7991~            				endif
0233   7991~            				endif
0233   7991             
0234   7991             			endif
0234   7991             
0234   7991             
0234   7991             
0234   7991             
0234   7991             
0234   7991~            			endif
0234   7991~            			endif
0234   7991             
0234   7991~            			endif
0234   7991~            			endif
0234   7991             
0234   7970             
0234   7970 20          
0234   7971             
0234   7971             
0234   7971~            			endif
0234   7971~            			endif
0234   7971~            			endif
0234   7971             
0234   7991             
0234   7991~            			endif
0234   7991~            			endif
0234   7991             
0235   7991             		endif
0235   7991             
0235   7991             
0235   7991             
0235   7991             
0235   7991             
0235   7991~            		endif
0235   7991~            		endif
0235   7991             
0235   7991~            		endif
0235   7991~            		endif
0235   7991             
0235   796B             
0235   796B 25          
0235   796C             
0235   796C             
0235   796C~            		endif
0235   796C~            		endif
0235   796C~            		endif
0235   796C             
0235   7991             
0235   7991~            		endif
0235   7991~            		endif
0235   7991             
0236   7991             		
0237   7991             		;ldaA	>state		; clear strobe reset bit
0238   7991             		;andA	11111011b
0239   7991             		;staA	state
0240   7991 7F 01 6C    		clr	strobeReset
0241   7994             	endif
0241   7994             
0241   7994             
0241   7994             
0241   7994             
0241   7994             
0241   7994~            	endif
0241   7994~            	endif
0241   7994             
0241   7994~            	endif
0241   7994~            	endif
0241   7994             
0241   792C             
0241   792C 67          
0241   792D             
0241   792D             
0241   792D~            	endif
0241   792D~            	endif
0241   792D~            	endif
0241   792D             
0241   7994             
0241   7994~            	endif
0241   7994~            	endif
0241   7994             
0242   7994             
0243   7994             		
0244   7994             ; pop queue
0245   7994 D6 57       	ldaB	>queueTail + 1
0246   7996 D1 55       	cmpB	>queueHead + 1
0247   7998             	ifeq
0247   7998             
0247   7998 26 FE       
0248   799A 7E 7A 45    		jmp skipQueue
0249   799D             	endif
0249   799D             
0249   799D             
0249   799D             
0249   799D             
0249   799D             
0249   799D~            	endif
0249   799D~            	endif
0249   799D             
0249   799D~            	endif
0249   799D~            	endif
0249   799D             
0249   7999             
0249   7999 03          
0249   799A             
0249   799A             
0249   799A~            	endif
0249   799A~            	endif
0249   799A~            	endif
0249   799A             
0249   799D             
0249   799D~            	endif
0249   799D~            	endif
0249   799D             
0250   799D 86 08       	ldaA	1000b
0251   799F BA 01 6B    	oraA	>state
0252   79A2 B7 01 6B    	staA	state
0253   79A5             	
0254   79A5 DE 54       	ldX	>queueHead
0255   79A7 A6 00       	ldaA	0, X	; A now contains the first queue item
0256   79A9             	
0257   79A9             	; step queue
0258   79A9 C6 6D       	ldaB	queueEnd
0259   79AB D1 55       	cmpB	>queueHead + 1
0260   79AD             	ifeq
0260   79AD             
0260   79AD 26 FE       
0261   79AF C6 60       		ldaB	queue
0262   79B1 D7 55       		staB	queueHead + 1
0263   79B3             	else
0263   79B3             
0263   79B3             
0263   79B3             
0263   79B3             
0263   79AE             
0263   79AE             
0263   79AE             
0263   79AE~            	else
0263   79AE~            	else
0263   79AE~            	else
0263   79AE~            	else
0263   79AE             
0263   79AE~            	else
0263   79AE~            	else
0263   79AE~            	else
0263   79AE~            	else
0263   79AE             
0263   79AE             
0263   79AE 06          
0263   79B3             
0263   79B3 20 FE       
0263   79B5             
0263   79B5             
0263   79B5             
0263   79B5~            	else
0263   79B5~            	else
0263   79B5~            	else
0263   79B5~            	else
0263   79B5~            	else
0263   79B5             
0263   79B5~            	else
0263   79B5~            	else
0263   79B5             
0263   79B5~            	else
0263   79B5~            	else
0263   79B5             
0264   79B5 7C 00 55    		inc	queueHead + 1
0265   79B8             	endif
0265   79B8             
0265   79B8             
0265   79B8             
0265   79B8             
0265   79B8             
0265   79B8~            	endif
0265   79B8~            	endif
0265   79B8             
0265   79B8~            	endif
0265   79B8~            	endif
0265   79B8             
0265   79B4             
0265   79B4 03          
0265   79B5             
0265   79B5             
0265   79B5~            	endif
0265   79B5~            	endif
0265   79B5~            	endif
0265   79B5             
0265   79B8             
0265   79B8~            	endif
0265   79B8~            	endif
0265   79B8             
0266   79B8             	
0267   79B8 16          	tAB
0268   79B9 C4 3F       	andB	00111111b ; B = callback index
0269   79BB             	
0270   79BB D7 59       	staB	tempQ + 1
0271   79BD C6 60       	ldaB	callbackTable >> 8
0272   79BF D7 58       	staB	tempQ + 0	; callback address LSB / 2
0273   79C1 DE 58       	ldX	>tempQ
0274   79C3             	
0275   79C3 E6 80       	ldaB	settleTable - callbackTable, X ; B has settle settings
0276   79C5 C5 80       	bitB 	10000000b ; B.8 set if switch limited to closures
0277   79C7             	ifne ; if closure only
0277   79C7             
0277   79C7 27 FE       
0278   79C9 85 80       		bitA	10000000b ; A.8 set if item was a switch opening
0279   79CB 26 6A       		bne	skipEvent
0280   79CD             	endif
0280   79CD             
0280   79CD             
0280   79CD             
0280   79CD             
0280   79CD             
0280   79CD~            	endif
0280   79CD~            	endif
0280   79CD             
0280   79CD~            	endif
0280   79CD~            	endif
0280   79CD             
0280   79C8             
0280   79C8 04          
0280   79C9             
0280   79C9             
0280   79C9~            	endif
0280   79C9~            	endif
0280   79C9~            	endif
0280   79C9             
0280   79CD             
0280   79CD~            	endif
0280   79CD~            	endif
0280   79CD             
0281   79CD             	
0282   79CD C5 40       	bitB	01000000b ; B.7 = active in game over
0283   79CF             	ifeq 	 ; not active in game over
0283   79CF             
0283   79CF 26 FE       
0284   79D1 D6 0F       		ldaB	>lc(8)	; gameover mask
0285   79D3 C5 20       		bitB	lr(6)
0286   79D5 26 60       		bne	skipEvent
0287   79D7 D6 0F       		ldaB	>lc(8) ; tilt bit
0288   79D9 C5 10       		bitB	lr(5)
0289   79DB 26 5A       		bne	skipEvent
0290   79DD             	endif
0290   79DD             
0290   79DD             
0290   79DD             
0290   79DD             
0290   79DD             
0290   79DD~            	endif
0290   79DD~            	endif
0290   79DD             
0290   79DD~            	endif
0290   79DD~            	endif
0290   79DD             
0290   79D0             
0290   79D0 0C          
0290   79D1             
0290   79D1             
0290   79D1~            	endif
0290   79D1~            	endif
0290   79D1~            	endif
0290   79D1             
0290   79DD             
0290   79DD~            	endif
0290   79DD~            	endif
0290   79DD             
0291   79DD             	
0292   79DD             	; checked passed, do callback
0293   79DD 78 00 59    	lsl	tempQ + 1 ; double LSB because callback table is 2b wide
0294   79E0 DE 58       	ldX	>tempQ
0295   79E2 EE 00       	ldX	0, X
0296   79E4 6E 00       	jmp	0, X
0297   79E6             	; everything trashed
0298   79E6             afterQueueEvent:
0299   79E6 BD 60 C3    	jsr 	bonusLights
0300   79E9             	
0301   79E9             	; update last switch
0302   79E9 96 59       	ldaA	> tempQ + 1
0303   79EB 44          	lsrA 	; got doubled earlier
0304   79EC 97 A8       	staA	lastSwitch
0305   79EE             
0306   79EE 86 02       	ldaA	10b ; no validate bit
0307   79F0 B5 01 6B    	bitA	>state
0308   79F3             	ifeq ; validate pf
0308   79F3             
0308   79F3 26 FE       
0309   79F5             		; check if playfield invalid
0310   79F5 86 0F       		ldaA	00001111b ; player up
0311   79F7 95 A7       		bitA	>flc(8)
0312   79F9             		ifne ; any flashing -> pf invalid
0312   79F9             
0312   79F9 27 FE       
0313   79FB 43          			comA	; turn off flashing
0314   79FC 94 A7       			andA	>flc(8)
0315   79FE 97 A7       			staA	flc(8)
0316   7A00             			
0317   7A00 86 01       			ldaA	lr(1) ; shoot again pf flashing
0318   7A02 95 A2       			bitA	>flc(3)
0319   7A04             			ifne
0319   7A04             
0319   7A04 27 FE       
0320   7A06             				; turn off ball save
0321   7A06 86 FE       				flashOff(1,3)
0321   7A08 94 A2       
0321   7A0A 97 A2       
0322   7A0C 86 40       				ldaA	lr(7) ; shoot again backbox
0323   7A0E 95 0F       				bitA	>lc(8)
0324   7A10             				ifeq
0324   7A10             
0324   7A10 26 FE       
0325   7A12 86 FE       					lampOff(1,3) ; shoot again pf
0325   7A14 94 0A       
0325   7A16 97 0A       
0326   7A18             				endif
0326   7A18             
0326   7A18             
0326   7A18             
0326   7A18             
0326   7A18             
0326   7A18~            				endif
0326   7A18~            				endif
0326   7A18             
0326   7A18~            				endif
0326   7A18~            				endif
0326   7A18             
0326   7A11             
0326   7A11 06          
0326   7A12             
0326   7A12             
0326   7A12~            				endif
0326   7A12~            				endif
0326   7A12~            				endif
0326   7A12             
0326   7A18             
0326   7A18~            				endif
0326   7A18~            				endif
0326   7A18             
0327   7A18             			else
0327   7A18             
0327   7A18             
0327   7A18             
0327   7A18             
0327   7A05             
0327   7A05             
0327   7A05             
0327   7A05~            			else
0327   7A05~            			else
0327   7A05~            			else
0327   7A05~            			else
0327   7A05             
0327   7A05~            			else
0327   7A05~            			else
0327   7A05~            			else
0327   7A05~            			else
0327   7A05             
0327   7A05             
0327   7A05 14          
0327   7A18             
0327   7A18 20 FE       
0327   7A1A             
0327   7A1A             
0327   7A1A             
0327   7A1A~            			else
0327   7A1A~            			else
0327   7A1A~            			else
0327   7A1A~            			else
0327   7A1A~            			else
0327   7A1A             
0327   7A1A~            			else
0327   7A1A~            			else
0327   7A1A             
0327   7A1A~            			else
0327   7A1A~            			else
0327   7A1A             
0328   7A1A 86 FE       				lampOff(1,3) ; shoot again
0328   7A1C 94 0A       
0328   7A1E 97 0A       
0329   7A20 86 BF       				lampOff(7,8)
0329   7A22 94 0F       
0329   7A24 97 0F       
0330   7A26             			endif
0330   7A26             
0330   7A26             
0330   7A26             
0330   7A26             
0330   7A26             
0330   7A26~            			endif
0330   7A26~            			endif
0330   7A26             
0330   7A26~            			endif
0330   7A26~            			endif
0330   7A26             
0330   7A19             
0330   7A19 0C          
0330   7A1A             
0330   7A1A             
0330   7A1A~            			endif
0330   7A1A~            			endif
0330   7A1A~            			endif
0330   7A1A             
0330   7A26             
0330   7A26~            			endif
0330   7A26~            			endif
0330   7A26             
0331   7A26             		endif
0331   7A26             
0331   7A26             
0331   7A26             
0331   7A26             
0331   7A26             
0331   7A26~            		endif
0331   7A26~            		endif
0331   7A26             
0331   7A26~            		endif
0331   7A26~            		endif
0331   7A26             
0331   79FA             
0331   79FA 2B          
0331   79FB             
0331   79FB             
0331   79FB~            		endif
0331   79FB~            		endif
0331   79FB~            		endif
0331   79FB             
0331   7A26             
0331   7A26~            		endif
0331   7A26~            		endif
0331   7A26             
0332   7A26             	else
0332   7A26             
0332   7A26             
0332   7A26             
0332   7A26             
0332   79F4             
0332   79F4             
0332   79F4             
0332   79F4~            	else
0332   79F4~            	else
0332   79F4~            	else
0332   79F4~            	else
0332   79F4             
0332   79F4~            	else
0332   79F4~            	else
0332   79F4~            	else
0332   79F4~            	else
0332   79F4             
0332   79F4             
0332   79F4 33          
0332   7A26             
0332   7A26 20 FE       
0332   7A28             
0332   7A28             
0332   7A28             
0332   7A28~            	else
0332   7A28~            	else
0332   7A28~            	else
0332   7A28~            	else
0332   7A28~            	else
0332   7A28             
0332   7A28~            	else
0332   7A28~            	else
0332   7A28             
0332   7A28~            	else
0332   7A28~            	else
0332   7A28             
0333   7A28             		; clear don't validate bit
0334   7A28 43          		comA
0335   7A29 B4 01 6B    		andA	>state
0336   7A2C B7 01 6B    		staA	state
0337   7A2F             	endif
0337   7A2F             
0337   7A2F             
0337   7A2F             
0337   7A2F             
0337   7A2F             
0337   7A2F~            	endif
0337   7A2F~            	endif
0337   7A2F             
0337   7A2F~            	endif
0337   7A2F~            	endif
0337   7A2F             
0337   7A27             
0337   7A27 07          
0337   7A28             
0337   7A28             
0337   7A28~            	endif
0337   7A28~            	endif
0337   7A28~            	endif
0337   7A28             
0337   7A2F             
0337   7A2F~            	endif
0337   7A2F~            	endif
0337   7A2F             
0338   7A2F             	
0339   7A2F 86 08       	ldaA	1000b
0340   7A31 BA 01 6B    	oraA	>state
0341   7A34 B7 01 6B    	staA	state
0342   7A37             	
0343   7A37             skipEvent:
0344   7A37 B6 01 6C    	ldaA	>strobeReset
0345   7A3A 85 0F       	bitA	1111b
0346   7A3C             	ifeq	; don't process queue if still finishing timers
0346   7A3C             
0346   7A3C 26 FE       
0347   7A3E             	else
0347   7A3E             
0347   7A3E             
0347   7A3E             
0347   7A3E             
0347   7A3D             
0347   7A3D             
0347   7A3D             
0347   7A3D~            	else
0347   7A3D~            	else
0347   7A3D~            	else
0347   7A3D~            	else
0347   7A3D             
0347   7A3D~            	else
0347   7A3D~            	else
0347   7A3D~            	else
0347   7A3D~            	else
0347   7A3D             
0347   7A3D             
0347   7A3D 02          
0347   7A3E             
0347   7A3E 20 FE       
0347   7A40             
0347   7A40             
0347   7A40             
0347   7A40~            	else
0347   7A40~            	else
0347   7A40~            	else
0347   7A40~            	else
0347   7A40~            	else
0347   7A40             
0347   7A40~            	else
0347   7A40~            	else
0347   7A40             
0347   7A40~            	else
0347   7A40~            	else
0347   7A40             
0348   7A40 DE 2C       		ldX	>forkX
0349   7A42 7E 79 52    		jmp	afterFork
0350   7A45             	endif
0350   7A45             
0350   7A45             
0350   7A45             
0350   7A45             
0350   7A45             
0350   7A45~            	endif
0350   7A45~            	endif
0350   7A45             
0350   7A45~            	endif
0350   7A45~            	endif
0350   7A45             
0350   7A3F             
0350   7A3F 05          
0350   7A40             
0350   7A40             
0350   7A40~            	endif
0350   7A40~            	endif
0350   7A40~            	endif
0350   7A40             
0350   7A45             
0350   7A45~            	endif
0350   7A45~            	endif
0350   7A45             
0351   7A45             				
0352   7A45             skipQueue:
0353   7A45             				
0354   7A45             		
0355   7A45             	;	jmp 	quickScanDone		
0356   7A45 D6 0F       	ldaB	>lc(8)	; gameover mask
0357   7A47 C5 20       	bitB	lr(6)
0358   7A49             	ifne
0358   7A49             
0358   7A49 27 FE       
0359   7A4B 7E 7A F3    		jmp 	quickScanDone
0360   7A4E             	endif
0360   7A4E             
0360   7A4E             
0360   7A4E             
0360   7A4E             
0360   7A4E             
0360   7A4E~            	endif
0360   7A4E~            	endif
0360   7A4E             
0360   7A4E~            	endif
0360   7A4E~            	endif
0360   7A4E             
0360   7A4A             
0360   7A4A 03          
0360   7A4B             
0360   7A4B             
0360   7A4B~            	endif
0360   7A4B~            	endif
0360   7A4B~            	endif
0360   7A4B             
0360   7A4E             
0360   7A4E~            	endif
0360   7A4E~            	endif
0360   7A4E             
0361   7A4E D6 0F       	ldaB	>lc(8) ; tilt bit
0362   7A50 C5 10       	bitB	lr(5)
0363   7A52             	ifne
0363   7A52             
0363   7A52 27 FE       
0364   7A54 7E 7A F3    		jmp 	quickScanDone
0365   7A57             	endif
0365   7A57             
0365   7A57             
0365   7A57             
0365   7A57             
0365   7A57             
0365   7A57~            	endif
0365   7A57~            	endif
0365   7A57             
0365   7A57~            	endif
0365   7A57~            	endif
0365   7A57             
0365   7A53             
0365   7A53 03          
0365   7A54             
0365   7A54             
0365   7A54~            	endif
0365   7A54~            	endif
0365   7A54~            	endif
0365   7A54             
0365   7A57             
0365   7A57~            	endif
0365   7A57~            	endif
0365   7A57             
0366   7A57 B6 01 6B    	ldaA	>state
0367   7A5A 85 08       	bitA	1000b
0368   7A5C             	ifne
0368   7A5C             
0368   7A5C 27 FE       
0369   7A5E 7E 7A F3    		jmp 	quickScanDone
0370   7A61             	endif
0370   7A61             
0370   7A61             
0370   7A61             
0370   7A61             
0370   7A61             
0370   7A61~            	endif
0370   7A61~            	endif
0370   7A61             
0370   7A61~            	endif
0370   7A61~            	endif
0370   7A61             
0370   7A5D             
0370   7A5D 03          
0370   7A5E             
0370   7A5E             
0370   7A5E~            	endif
0370   7A5E~            	endif
0370   7A5E~            	endif
0370   7A5E             
0370   7A61             
0370   7A61~            	endif
0370   7A61~            	endif
0370   7A61             
0371   7A61             	
0372   7A61 86 01       	ldaA	1
0373   7A63 BA 01 6B    	oraA	>state
0374   7A66 B7 01 6B    	staA	state
0375   7A69             	
0376   7A69 96 31       	ldaA	>scanStrobe
0377   7A6B B7 30 02    	staA	switchStrobe
0378   7A6E DE 2E       	ldX	>scanCurCol
0379   7A70 B6 30 00    	ldaA	>switchRow
0380   7A73 16          	tab
0381   7A74 A8 20       	eorA	switchRow1, X ; A contains any switches that have changed state
0382   7A76 B4 30 00    	andA	>switchRow	; A contains any switches that are closed but not processed
0383   7A79             	ifne
0383   7A79             
0383   7A79 27 FE       
0384   7A7B             	
0385   7A7B D6 30       	ldaB	>scanCurSwitchRowLsb 	;	B now contains LSB of callbackTable row addr
0386   7A7D D7 35       	staB	scanTempX + 1 			; scanTempX = switch / 2
0387   7A7F D7 33       	staB	scanX + 1			; scanX = cRAM
0388   7A81 C6 60       	ldaB	callbackTable >> 8
0389   7A83 D7 34       	staB	scanTempX
0390   7A85 C6 01       	ldaB	cRAM >> 8
0391   7A87 D7 32       	staB	scanX
0392   7A89             	
0393   7A89 C6 01       	ldaB	00000001b ; B is the bit of the current switch in row
0394   7A8B             	
0395   7A8B             	; scanTempX now contains the beginning of the row in the callbackTable
0396   7A8B             scanSwNext:
0397   7A8B 85 01       	bitA	00000001b	 ; Z set if switch not different
0398   7A8D             	ifne		; if bit set, switch different
0398   7A8D             
0398   7A8D 27 FE       
0399   7A8F 36          		pshA ; store changed switches left
0400   7A90 DE 32       		ldX	>scanX
0401   7A92 A6 00       		ldaA	0, X ; A now how long the switch has left to settle
0402   7A94 84 0F       		andA	00001111b ; need to remove upper F ( sets Z if A = 0)
0403   7A96             		ifeq ; =0 -> was settled, so now it's not
0403   7A96             
0403   7A96 26 FE       
0404   7A98             			; get the settle time
0405   7A98 96 33       			ldaA	>scanX + 1
0406   7A9A 97 35       			staA	scanTempX + 1 	; get scanTempX in sync with scanX LSB
0407   7A9C DE 34       			ldX	>scanTempX
0408   7A9E             			
0409   7A9E             			; scanTempX contains half the address of the callback, so add diff between settleTable and callbackTable
0410   7A9E A6 80       			ldaA	settleTable - callbackTable, X ; A has settle settings
0411   7AA0             			
0412   7AA0             			; need to get correct 3 bits from switch settings
0413   7AA0 84 38       			andA	111000b
0414   7AA2             			
0415   7AA2             			ifeq
0415   7AA2             
0415   7AA2 26 FE       
0416   7AA4 DE 2E       				ldX	>scanCurCol
0417   7AA6 17          				tBA	; A now the bit in row
0418   7AA7 A5 20       				bitA	switchRow1, X
0419   7AA9             				ifeq
0419   7AA9             
0419   7AA9 26 FE       
0420   7AAB AA 20       					oraA	switchRow1, X ; toggle bit in row
0421   7AAD A7 20       					staA	switchRow1, X ; A now state of row
0422   7AAF             					;lsl	scanTempX + 1 ; double LSB because callback table is 2b wide
0423   7AAF             					;ldX	>scanTempX
0424   7AAF             					;ldX	0, X
0425   7AAF             					;jmp	0, X
0426   7AAF F5 30 00    					bitB	>switchRow
0427   7AB2 86 40       					ldaA	01000000b
0428   7AB4 9A 33       					oraA	>scanX + 1 ; A now contains the event per queue schema
0429   7AB6             					
0430   7AB6             					; store event
0431   7AB6 DE 56       					ldX	>queueTail
0432   7AB8 A7 00       					staA	0, X
0433   7ABA 7C 00 57    					inc	queueTail + 1
0434   7ABD             					
0435   7ABD             					; wrap queueTail if necessary
0436   7ABD 8C 00 6D    					cpX	queueEnd 
0437   7AC0             					ifeq
0437   7AC0             
0437   7AC0 26 FE       
0438   7AC2 86 60       						ldaA	queue 
0439   7AC4 97 57       						staA	queueTail + 1
0440   7AC6             					endif
0440   7AC6             
0440   7AC6             
0440   7AC6             
0440   7AC6             
0440   7AC6             
0440   7AC6~            					endif
0440   7AC6~            					endif
0440   7AC6             
0440   7AC6~            					endif
0440   7AC6~            					endif
0440   7AC6             
0440   7AC1             
0440   7AC1 04          
0440   7AC2             
0440   7AC2             
0440   7AC2~            					endif
0440   7AC2~            					endif
0440   7AC2~            					endif
0440   7AC2             
0440   7AC6             
0440   7AC6~            					endif
0440   7AC6~            					endif
0440   7AC6             
0441   7AC6             				endif
0441   7AC6             
0441   7AC6             
0441   7AC6             
0441   7AC6             
0441   7AC6             
0441   7AC6~            				endif
0441   7AC6~            				endif
0441   7AC6             
0441   7AC6~            				endif
0441   7AC6~            				endif
0441   7AC6             
0441   7AAA             
0441   7AAA 1B          
0441   7AAB             
0441   7AAB             
0441   7AAB~            				endif
0441   7AAB~            				endif
0441   7AAB~            				endif
0441   7AAB             
0441   7AC6             
0441   7AC6~            				endif
0441   7AC6~            				endif
0441   7AC6             
0442   7AC6             			endif
0442   7AC6             
0442   7AC6             
0442   7AC6             
0442   7AC6             
0442   7AC6             
0442   7AC6~            			endif
0442   7AC6~            			endif
0442   7AC6             
0442   7AC6~            			endif
0442   7AC6~            			endif
0442   7AC6             
0442   7AA3             
0442   7AA3 22          
0442   7AA4             
0442   7AA4             
0442   7AA4~            			endif
0442   7AA4~            			endif
0442   7AA4~            			endif
0442   7AA4             
0442   7AC6             
0442   7AC6~            			endif
0442   7AC6~            			endif
0442   7AC6             
0443   7AC6             		endif
0443   7AC6             
0443   7AC6             
0443   7AC6             
0443   7AC6             
0443   7AC6             
0443   7AC6~            		endif
0443   7AC6~            		endif
0443   7AC6             
0443   7AC6~            		endif
0443   7AC6~            		endif
0443   7AC6             
0443   7A97             
0443   7A97 2E          
0443   7A98             
0443   7A98             
0443   7A98~            		endif
0443   7A98~            		endif
0443   7A98~            		endif
0443   7A98             
0443   7AC6             
0443   7AC6~            		endif
0443   7AC6~            		endif
0443   7AC6             
0444   7AC6 32          		pulA
0445   7AC7             	endif
0445   7AC7             
0445   7AC7             
0445   7AC7             
0445   7AC7             
0445   7AC7             
0445   7AC7~            	endif
0445   7AC7~            	endif
0445   7AC7             
0445   7AC7~            	endif
0445   7AC7~            	endif
0445   7AC7             
0445   7A8E             
0445   7A8E 38          
0445   7A8F             
0445   7A8F             
0445   7A8F~            	endif
0445   7A8F~            	endif
0445   7A8F~            	endif
0445   7A8F             
0445   7AC7             
0445   7AC7~            	endif
0445   7AC7~            	endif
0445   7AC7             
0446   7AC7 7C 00 33    	inc scanX + 1
0447   7ACA 58          	aslB
0448   7ACB 44          	lsrA			; pop lowest bit off, set Z if A is empty
0449   7ACC 26 BD       	bne	scanSwNext 	; more 'switched' bits, keep processing 
0450   7ACE             	
0451   7ACE             	endif ; switch closed in row
0451   7ACE             
0451   7ACE             
0451   7ACE             
0451   7ACE             
0451   7ACE             
0451   7ACE~            	endif ; switch closed in row
0451   7ACE~            	endif ; switch closed in row
0451   7ACE             
0451   7ACE~            	endif ; switch closed in row
0451   7ACE~            	endif ; switch closed in row
0451   7ACE             
0451   7A7A             
0451   7A7A 53          
0451   7A7B             
0451   7A7B             
0451   7A7B~            	endif ; switch closed in row
0451   7A7B~            	endif ; switch closed in row
0451   7A7B~            	endif ; switch closed in row
0451   7A7B             
0451   7ACE             
0451   7ACE~            	endif ; switch closed in row
0451   7ACE~            	endif ; switch closed in row
0451   7ACE             
0452   7ACE             	
0453   7ACE 86 08       	ldaA	8 	; pitch
0454   7AD0 9B 30       	addA	>scanCurSwitchRowLsb
0455   7AD2 97 30       	staA	scanCurSwitchRowLsb
0456   7AD4 78 00 31    	asl	scanStrobe
0457   7AD7             	ifeq			
0457   7AD7             
0457   7AD7 26 FE       
0458   7AD9 86 01       		ldaA	00000001b
0459   7ADB 97 31       		staA	scanStrobe
0460   7ADD 7F 00 2E    		clr	scanCurCol
0461   7AE0 7F 00 2F    		clr	scanCurCol + 1
0462   7AE3 7F 00 30    		clr	scanCurSwitchRowLsb
0463   7AE6             	else
0463   7AE6             
0463   7AE6             
0463   7AE6             
0463   7AE6             
0463   7AD8             
0463   7AD8             
0463   7AD8             
0463   7AD8~            	else
0463   7AD8~            	else
0463   7AD8~            	else
0463   7AD8~            	else
0463   7AD8             
0463   7AD8~            	else
0463   7AD8~            	else
0463   7AD8~            	else
0463   7AD8~            	else
0463   7AD8             
0463   7AD8             
0463   7AD8 0F          
0463   7AE6             
0463   7AE6 20 FE       
0463   7AE8             
0463   7AE8             
0463   7AE8             
0463   7AE8~            	else
0463   7AE8~            	else
0463   7AE8~            	else
0463   7AE8~            	else
0463   7AE8~            	else
0463   7AE8             
0463   7AE8~            	else
0463   7AE8~            	else
0463   7AE8             
0463   7AE8~            	else
0463   7AE8~            	else
0463   7AE8             
0464   7AE8 7C 00 2F    		inc	scanCurCol + 1
0465   7AEB             	endif
0465   7AEB             
0465   7AEB             
0465   7AEB             
0465   7AEB             
0465   7AEB             
0465   7AEB~            	endif
0465   7AEB~            	endif
0465   7AEB             
0465   7AEB~            	endif
0465   7AEB~            	endif
0465   7AEB             
0465   7AE7             
0465   7AE7 03          
0465   7AE8             
0465   7AE8             
0465   7AE8~            	endif
0465   7AE8~            	endif
0465   7AE8~            	endif
0465   7AE8             
0465   7AEB             
0465   7AEB~            	endif
0465   7AEB~            	endif
0465   7AEB             
0466   7AEB             	
0467   7AEB 86 0E       	ldaA	1110b
0468   7AED B4 01 6B    	andA	>state
0469   7AF0 B7 01 6B    	staA	state
0470   7AF3             	
0471   7AF3             quickScanDone:
0472   7AF3             				
0473   7AF3 7E 79 1E    	jmp		end
0474   7AF6 00 00       	.dw 0
0475   7AF8 00 00       	.dw 0
0476   7AFA 00 00       	.dw 0
0477   7AFC 00 00       	.dw 0
0478   7AFE 00 00       	.dw 0
0479   7B00             		
0480   7B00             interrupt:	
0481   7B00 7C 00 02    	inc	counter
0482   7B03 86 00       	ldaA	0
0483   7B05 91 02       	cmpA	>counter
0484   7B07 26 52       	bne	counterHandled
0485   7B09             	
0486   7B09             	; attract mode
0487   7B09 86 20       	ldaA	lr(6) ; gameover
0488   7B0B 95 0F       		bitA	> lc(8)
0489   7B0D             		ifne
0489   7B0D             
0489   7B0D 27 FE       
0490   7B0F DE 2A       		ldX	>attractX
0491   7B11 A6 00       		ldaA	0, X
0492   7B13 97 09       		staA	lc(2)
0493   7B15 A6 01       		ldaA	1, X
0494   7B17 97 0A       		staA	lc(3)
0495   7B19 A6 02       		ldaA	2, X
0496   7B1B 97 0B       		staA	lc(4)
0497   7B1D A6 03       		ldaA	3, X
0498   7B1F 97 0C       		staA	lc(5)
0499   7B21 A6 04       		ldaA	4, X
0500   7B23 97 0D       		staA	lc(6)
0501   7B25 96 2B       		ldaA	>attractX + 1
0502   7B27 8B 05       		addA	5
0503   7B29 81 E9       		cmpA	attractEnd&$FF
0504   7B2B             		ifeq
0504   7B2B             
0504   7B2B 26 FE       
0505   7B2D 86 C1       			ldaA	attractStart&$FF
0506   7B2F             		endif
0506   7B2F             
0506   7B2F             
0506   7B2F             
0506   7B2F             
0506   7B2F             
0506   7B2F~            		endif
0506   7B2F~            		endif
0506   7B2F             
0506   7B2F~            		endif
0506   7B2F~            		endif
0506   7B2F             
0506   7B2C             
0506   7B2C 02          
0506   7B2D             
0506   7B2D             
0506   7B2D~            		endif
0506   7B2D~            		endif
0506   7B2D~            		endif
0506   7B2D             
0506   7B2F             
0506   7B2F~            		endif
0506   7B2F~            		endif
0506   7B2F             
0507   7B2F 97 2B       		staA	attractX + 1
0508   7B31             	endif
0508   7B31             
0508   7B31             
0508   7B31             
0508   7B31             
0508   7B31             
0508   7B31~            	endif
0508   7B31~            	endif
0508   7B31             
0508   7B31~            	endif
0508   7B31~            	endif
0508   7B31             
0508   7B0E             
0508   7B0E 22          
0508   7B0F             
0508   7B0F             
0508   7B0F~            	endif
0508   7B0F~            	endif
0508   7B0F~            	endif
0508   7B0F             
0508   7B31             
0508   7B31~            	endif
0508   7B31~            	endif
0508   7B31             
0509   7B31             	
0510   7B31 7C 00 03    	inc 	counter2
0511   7B34 86 08       	ldaA	8
0512   7B36 91 03       	cmpA	>counter2
0513   7B38 26 21       	bne	counterHandled
0514   7B3A             	
0515   7B3A 86 0A       	ldaA	10
0516   7B3C 91 B0       	cmpA	>p_Bonus
0517   7B3E             	ifeq
0517   7B3E             
0517   7B3E 26 FE       
0518   7B40 BD 7F 16    		jsr advanceBonus
0519   7B43             	endif
0519   7B43             
0519   7B43             
0519   7B43             
0519   7B43             
0519   7B43             
0519   7B43~            	endif
0519   7B43~            	endif
0519   7B43             
0519   7B43~            	endif
0519   7B43~            	endif
0519   7B43             
0519   7B3F             
0519   7B3F 03          
0519   7B40             
0519   7B40             
0519   7B40~            	endif
0519   7B40~            	endif
0519   7B40~            	endif
0519   7B40             
0519   7B43             
0519   7B43~            	endif
0519   7B43~            	endif
0519   7B43             
0520   7B43             	
0521   7B43 86 00       	ldaA	0
0522   7B45 97 03       	staA	counter2
0523   7B47 86 77       	ldaA	01110111b
0524   7B49 91 7E       	cmpA	>displayBcd1 + 14
0525   7B4B 27 08       	beq	on
0526   7B4D             	
0527   7B4D 86 F0       	ldaA	$F0
0528   7B4F             	;staA	lampRow1
0529   7B4F 86 77       	ldaA	01110111b
0530   7B51 97 7E       	staA	displayBcd1	 + 14
0531   7B53 20 06       	bra	counterHandled
0532   7B55             on:
0533   7B55 86 0F       	ldaA	$0F
0534   7B57             	;staA	lampRow1
0535   7B57 86 33       	ldaA	00110011b
0536   7B59 97 7E       	staA	displayBcd1	 + 14
0537   7B5B             
0538   7B5B             counterHandled:
0539   7B5B             	
0540   7B5B             ; update display 
0541   7B5B             	
0542   7B5B 96 BF       	ldaA	>$BF
0543   7B5D 97 7F       	staA	displayBcd1 + 15
0544   7B5F 96 6F       	ldaA	>$6F
0545   7B61 97 76       	staA	displayBcd1 + 6
0546   7B63             	
0547   7B63 DE 50       	ldX	>curCol
0548   7B65 B6 01 6A    	ldaA	>displayCol
0549   7B68 84 0F       	andA	1111b
0550   7B6A C6 FF       	ldaB 	$FF
0551   7B6C F7 28 02    	staB	displayBcd
0552   7B6F B7 28 00    	staA	displayStrobe
0553   7B72 85 08       	bitA	00001000b
0554   7B74             	ifeq
0554   7B74             
0554   7B74 26 FE       
0555   7B76 E6 70       		ldaB	displayBcd1, X
0556   7B78             	else
0556   7B78             
0556   7B78             
0556   7B78             
0556   7B78             
0556   7B75             
0556   7B75             
0556   7B75             
0556   7B75~            	else
0556   7B75~            	else
0556   7B75~            	else
0556   7B75~            	else
0556   7B75             
0556   7B75~            	else
0556   7B75~            	else
0556   7B75~            	else
0556   7B75~            	else
0556   7B75             
0556   7B75             
0556   7B75 04          
0556   7B78             
0556   7B78 20 FE       
0556   7B7A             
0556   7B7A             
0556   7B7A             
0556   7B7A~            	else
0556   7B7A~            	else
0556   7B7A~            	else
0556   7B7A~            	else
0556   7B7A~            	else
0556   7B7A             
0556   7B7A~            	else
0556   7B7A~            	else
0556   7B7A             
0556   7B7A~            	else
0556   7B7A~            	else
0556   7B7A             
0557   7B7A E6 78       		ldaB	displayBcd1 + 8, X
0558   7B7C             	endif
0558   7B7C             
0558   7B7C             
0558   7B7C             
0558   7B7C             
0558   7B7C             
0558   7B7C~            	endif
0558   7B7C~            	endif
0558   7B7C             
0558   7B7C~            	endif
0558   7B7C~            	endif
0558   7B7C             
0558   7B79             
0558   7B79 02          
0558   7B7A             
0558   7B7A             
0558   7B7A~            	endif
0558   7B7A~            	endif
0558   7B7A~            	endif
0558   7B7A             
0558   7B7C             
0558   7B7C~            	endif
0558   7B7C~            	endif
0558   7B7C             
0559   7B7C F7 28 02    	staB	displayBcd
0560   7B7F             	
0561   7B7F             ; read switches
0562   7B7F             	
0563   7B7F F6 30 02    	ldaB	>switchStrobe	; save for later
0564   7B82 96 07       	ldaA	>strobe
0565   7B84 B7 30 02    	staA	switchStrobe
0566   7B87 DE 50       	ldX	>curCol
0567   7B89 B6 30 00    	ldaA	>switchRow
0568   7B8C 97 36       	staA	irqSwitchRow
0569   7B8E F7 30 02    	staB	switchStrobe	; restore
0570   7B91 16          	tab
0571   7B92 A8 20       	eorA	switchRow1, X ; A contains any switches that have changed state
0572   7B94             	
0573   7B94 D6 10       	ldaB	>curSwitchRowLsb 	;	B now contains LSB of callbackTable row addr
0574   7B96 D7 01       	staB	temp + 1 			; temp = switch / 2
0575   7B98 D7 53       	staB	tempX + 1			; tempX = cRAM
0576   7B9A C6 60       	ldaB	callbackTable >> 8
0577   7B9C D7 00       	staB	temp
0578   7B9E C6 01       	ldaB	cRAM >> 8
0579   7BA0 D7 52       	staB	tempX
0580   7BA2             	
0581   7BA2 C6 01       	ldaB	00000001b ; B is the bit of the current switch in row
0582   7BA4             	
0583   7BA4             	; temp now contains the beginning of the row in the callbackTable
0584   7BA4             swNext:
0585   7BA4 85 01       	bitA	00000001b	 ; Z set if switch not different
0586   7BA6             	ifne		; if bit set, switch different
0586   7BA6             
0586   7BA6 27 FE       
0587   7BA8 36          		pshA ; store changed switches left
0588   7BA9 DE 52       		ldX	>tempX
0589   7BAB             checkSettled:
0590   7BAB A6 00       		ldaA	0, X ; A now how long the switch has left to settle
0591   7BAD 84 0F       		andA	00001111b ; need to remove upper F ( sets Z if A = 0)
0592   7BAF 27 34       		beq 	notSettled; A=0 -> was settled
0593   7BB1             		; else A > 0 -> settling
0594   7BB1 86 18       			ldaA	11000b ; want to skip decrementing settle counter 7/8 IRQs
0595   7BB3             				; but checking 'multiple of 8' would miss 7/8 switch
0596   7BB3             				; columns completely since they're in sync
0597   7BB3             				; so instead the lowest bits are empty (so that it'll
0598   7BB3             				; get all switch cols) and instead it skips 7/8 groups 
0599   7BB3             				; of 8 IRQs
0600   7BB3 95 02       			bitA	>counter
0601   7BB5 26 47       			bne	settledEnd
0602   7BB7 A6 00       			ldaA	0, X ; A now how long the switch has left to settle
0603   7BB9 84 0F       			andA	00001111b ; need to remove upper F ( sets Z if A = 0)
0604   7BBB 4A          			decA
0605   7BBC A7 00       			staA	0, X	; sets Z if now A = 0
0606   7BBE             			ifeq ; A=0 -> now settled, fire event
0606   7BBE             
0606   7BBE 26 FE       
0607   7BC0             settled:		
0608   7BC0 DE 50       				ldX	>curCol
0609   7BC2 17          				tBA	; A now the bit in row
0610   7BC3 A8 20       				eorA	switchRow1, X ; toggle bit in row
0611   7BC5 A7 20       				staA	switchRow1, X ; A now state of row
0612   7BC7             				
0613   7BC7 D5 36       				bitB	>irqSwitchRow
0614   7BC9             				ifne ; switch just closed
0614   7BC9             
0614   7BC9 27 FE       
0615   7BCB 86 40       					ldaA	01000000b
0616   7BCD             				else
0616   7BCD             
0616   7BCD             
0616   7BCD             
0616   7BCD             
0616   7BCA             
0616   7BCA             
0616   7BCA             
0616   7BCA~            				else
0616   7BCA~            				else
0616   7BCA~            				else
0616   7BCA~            				else
0616   7BCA             
0616   7BCA~            				else
0616   7BCA~            				else
0616   7BCA~            				else
0616   7BCA~            				else
0616   7BCA             
0616   7BCA             
0616   7BCA 04          
0616   7BCD             
0616   7BCD 20 FE       
0616   7BCF             
0616   7BCF             
0616   7BCF             
0616   7BCF~            				else
0616   7BCF~            				else
0616   7BCF~            				else
0616   7BCF~            				else
0616   7BCF~            				else
0616   7BCF             
0616   7BCF~            				else
0616   7BCF~            				else
0616   7BCF             
0616   7BCF~            				else
0616   7BCF~            				else
0616   7BCF             
0617   7BCF 86 C0       					ldaA	11000000b
0618   7BD1             				endif
0618   7BD1             
0618   7BD1             
0618   7BD1             
0618   7BD1             
0618   7BD1             
0618   7BD1~            				endif
0618   7BD1~            				endif
0618   7BD1             
0618   7BD1~            				endif
0618   7BD1~            				endif
0618   7BD1             
0618   7BCE             
0618   7BCE 02          
0618   7BCF             
0618   7BCF             
0618   7BCF~            				endif
0618   7BCF~            				endif
0618   7BCF~            				endif
0618   7BCF             
0618   7BD1             
0618   7BD1~            				endif
0618   7BD1~            				endif
0618   7BD1             
0619   7BD1 9A 53       				oraA	>tempX + 1 ; A now contains the event per queue schema
0620   7BD3             				
0621   7BD3             				; store event
0622   7BD3 DE 56       				ldX	>queueTail
0623   7BD5 A7 00       				staA	0, X
0624   7BD7 7C 00 57    				inc	queueTail + 1
0625   7BDA             				
0626   7BDA             				; wrap queueTail if necessary
0627   7BDA 8C 00 6D    				cpX	queueEnd 
0628   7BDD             				ifeq
0628   7BDD             
0628   7BDD 26 FE       
0629   7BDF 86 60       					ldaA	queue 
0630   7BE1 97 57       					staA	queueTail + 1
0631   7BE3             				endif
0631   7BE3             
0631   7BE3             
0631   7BE3             
0631   7BE3             
0631   7BE3             
0631   7BE3~            				endif
0631   7BE3~            				endif
0631   7BE3             
0631   7BE3~            				endif
0631   7BE3~            				endif
0631   7BE3             
0631   7BDE             
0631   7BDE 04          
0631   7BDF             
0631   7BDF             
0631   7BDF~            				endif
0631   7BDF~            				endif
0631   7BDF~            				endif
0631   7BDF             
0631   7BE3             
0631   7BE3~            				endif
0631   7BE3~            				endif
0631   7BE3             
0632   7BE3             			endif
0632   7BE3             
0632   7BE3             
0632   7BE3             
0632   7BE3             
0632   7BE3             
0632   7BE3~            			endif
0632   7BE3~            			endif
0632   7BE3             
0632   7BE3~            			endif
0632   7BE3~            			endif
0632   7BE3             
0632   7BBF             
0632   7BBF 23          
0632   7BC0             
0632   7BC0             
0632   7BC0~            			endif
0632   7BC0~            			endif
0632   7BC0~            			endif
0632   7BC0             
0632   7BE3             
0632   7BE3~            			endif
0632   7BE3~            			endif
0632   7BE3             
0633   7BE3 20 19       		bra settledEnd
0634   7BE5             notSettled: ; =0 -> was settled, so now it's not
0635   7BE5             			; get the settle time
0636   7BE5 96 53       			ldaA	>tempX + 1
0637   7BE7 97 01       			staA	temp + 1 	; get temp in sync with tempX LSB
0638   7BE9 DE 00       			ldX	>temp
0639   7BEB             			
0640   7BEB             			; temp contains half the address of the callback, so add diff between settleTable and callbackTable
0641   7BEB A6 80       			ldaA	settleTable - callbackTable, X ; A has settle settings
0642   7BED             			
0643   7BED             			; need to get correct 3 bits from switch settings
0644   7BED D5 36       			bitB	>irqSwitchRow
0645   7BEF             			ifne ; switch just turned on
0645   7BEF             
0645   7BEF 27 FE       
0646   7BF1 44          				lsrA
0647   7BF2 44          				lsrA
0648   7BF3             			else
0648   7BF3             
0648   7BF3             
0648   7BF3             
0648   7BF3             
0648   7BF0             
0648   7BF0             
0648   7BF0             
0648   7BF0~            			else
0648   7BF0~            			else
0648   7BF0~            			else
0648   7BF0~            			else
0648   7BF0             
0648   7BF0~            			else
0648   7BF0~            			else
0648   7BF0~            			else
0648   7BF0~            			else
0648   7BF0             
0648   7BF0             
0648   7BF0 04          
0648   7BF3             
0648   7BF3 20 FE       
0648   7BF5             
0648   7BF5             
0648   7BF5             
0648   7BF5~            			else
0648   7BF5~            			else
0648   7BF5~            			else
0648   7BF5~            			else
0648   7BF5~            			else
0648   7BF5             
0648   7BF5~            			else
0648   7BF5~            			else
0648   7BF5             
0648   7BF5~            			else
0648   7BF5~            			else
0648   7BF5             
0649   7BF5 48          				aslA
0650   7BF6             			endif
0650   7BF6             
0650   7BF6             
0650   7BF6             
0650   7BF6             
0650   7BF6             
0650   7BF6~            			endif
0650   7BF6~            			endif
0650   7BF6             
0650   7BF6~            			endif
0650   7BF6~            			endif
0650   7BF6             
0650   7BF4             
0650   7BF4 01          
0650   7BF5             
0650   7BF5             
0650   7BF5~            			endif
0650   7BF5~            			endif
0650   7BF5~            			endif
0650   7BF5             
0650   7BF6             
0650   7BF6~            			endif
0650   7BF6~            			endif
0650   7BF6             
0651   7BF6 84 0E       			andA	1110b ; A now has 3 bit settle time * 2
0652   7BF8             						
0653   7BF8 DE 52       			ldX	>tempX
0654   7BFA A7 00       			staA	0, X		; start settling	
0655   7BFC 27 C2       			beq	settled		; quick out for 0 settle
0656   7BFE             settledEnd:
0657   7BFE             			
0658   7BFE 32          		pulA
0659   7BFF             	endif
0659   7BFF             
0659   7BFF             
0659   7BFF             
0659   7BFF             
0659   7BFF             
0659   7BFF~            	endif
0659   7BFF~            	endif
0659   7BFF             
0659   7BFF~            	endif
0659   7BFF~            	endif
0659   7BFF             
0659   7BA7             
0659   7BA7 57          
0659   7BA8             
0659   7BA8             
0659   7BA8~            	endif
0659   7BA8~            	endif
0659   7BA8~            	endif
0659   7BA8             
0659   7BFF             
0659   7BFF~            	endif
0659   7BFF~            	endif
0659   7BFF             
0660   7BFF 7C 00 53    	inc tempX + 1
0661   7C02 58          	aslB
0662   7C03 44          	lsrA			; pop lowest bit off, set Z if A is empty
0663   7C04 26 9E       	bne		swNext 	; more 'switched' bits, keep processing 
0664   7C06             	
0665   7C06             	
0666   7C06             ; update lamps
0667   7C06             updateLamps:
0668   7C06             	;jmp updateStrobe
0669   7C06             
0670   7C06 DE 50       	ldX	>curCol
0671   7C08             	
0672   7C08 86 FF       	ldaA	$FF	;lamp row is inverted
0673   7C0A B7 24 00    	staA	lampCol
0674   7C0D 96 07       	ldaA	>strobe
0675   7C0F B7 24 02    	staA	lampStrobe
0676   7C12             	
0677   7C12 D6 02       	ldaB	>counter
0678   7C14 A6 08       	ldaA	lampCol1, X
0679   7C16 C5 80       	bitB	10000000b 
0680   7C18             	ifeq
0680   7C18             
0680   7C18 26 FE       
0681   7C1A A8 A0       		eorA	flashLampCol1, X
0682   7C1C A4 08       		andA	lampCol1, X
0683   7C1E             	endif
0683   7C1E             
0683   7C1E             
0683   7C1E             
0683   7C1E             
0683   7C1E             
0683   7C1E~            	endif
0683   7C1E~            	endif
0683   7C1E             
0683   7C1E~            	endif
0683   7C1E~            	endif
0683   7C1E             
0683   7C19             
0683   7C19 04          
0683   7C1A             
0683   7C1A             
0683   7C1A~            	endif
0683   7C1A~            	endif
0683   7C1A~            	endif
0683   7C1A             
0683   7C1E             
0683   7C1E~            	endif
0683   7C1E~            	endif
0683   7C1E             
0684   7C1E 43          	comA	; inverted
0685   7C1F             	
0686   7C1F B7 24 00    	staA	lampCol
0687   7C22 86 00       	ldaA	00
0688   7C24             
0689   7C24             ; update solenoids
0690   7C24             	; if a solenoid is set to <254, --
0691   7C24             	; if =255, off, otherwise on
0692   7C24             	; else leave it at 254
0693   7C24             	
0694   7C24 7C 00 50    	inc	curCol	; indexed can't use base >255, so temp inc X by 255 (1 MSB)
0695   7C27 86 FE       	ldaA	254
0696   7C29 DE 50       	ldX	>curCol
0697   7C2B             	; update solenoid in current 'column' (1-8) 
0698   7C2B A1 40       	cmpA	solenoid1 - cRAM, X
0699   7C2D             	ifge 	; solenoid <=254, turn on
0699   7C2D             
0699   7C2D 25 FE       
0700   7C2F             		ifgt	; solenoid < 254, decrement
0700   7C2F             
0700   7C2F 23 FE       
0701   7C31 6A 40       			dec	solenoid1 - cRAM, X
0702   7C33             		endif
0702   7C33             
0702   7C33             
0702   7C33             
0702   7C33             
0702   7C33             
0702   7C33~            		endif
0702   7C33~            		endif
0702   7C33             
0702   7C33~            		endif
0702   7C33~            		endif
0702   7C33             
0702   7C30             
0702   7C30 02          
0702   7C31             
0702   7C31             
0702   7C31~            		endif
0702   7C31~            		endif
0702   7C31~            		endif
0702   7C31             
0702   7C33             
0702   7C33~            		endif
0702   7C33~            		endif
0702   7C33             
0703   7C33 0D          		sec
0704   7C34             	else
0704   7C34             
0704   7C34             
0704   7C34             
0704   7C34             
0704   7C2E             
0704   7C2E             
0704   7C2E             
0704   7C2E~            	else
0704   7C2E~            	else
0704   7C2E~            	else
0704   7C2E~            	else
0704   7C2E             
0704   7C2E~            	else
0704   7C2E~            	else
0704   7C2E~            	else
0704   7C2E~            	else
0704   7C2E             
0704   7C2E             
0704   7C2E 07          
0704   7C34             
0704   7C34 20 FE       
0704   7C36             
0704   7C36             
0704   7C36             
0704   7C36~            	else
0704   7C36~            	else
0704   7C36~            	else
0704   7C36~            	else
0704   7C36~            	else
0704   7C36             
0704   7C36~            	else
0704   7C36~            	else
0704   7C36             
0704   7C36~            	else
0704   7C36~            	else
0704   7C36             
0705   7C36 0C          		clc
0706   7C37             	endif
0706   7C37             
0706   7C37             
0706   7C37             
0706   7C37             
0706   7C37             
0706   7C37~            	endif
0706   7C37~            	endif
0706   7C37             
0706   7C37~            	endif
0706   7C37~            	endif
0706   7C37             
0706   7C35             
0706   7C35 01          
0706   7C36             
0706   7C36             
0706   7C36~            	endif
0706   7C36~            	endif
0706   7C36~            	endif
0706   7C36             
0706   7C37             
0706   7C37~            	endif
0706   7C37~            	endif
0706   7C37             
0707   7C37 76 00 28    	ror	solAStatus ; pushes carry bit (set prev) onto status
0708   7C3A             	; repeat above for second bank
0709   7C3A A1 48       	cmpA	solenoid9 - cRAM, X
0710   7C3C             	ifge 	; solenoid <=254, turn on
0710   7C3C             
0710   7C3C 25 FE       
0711   7C3E             		ifgt	; solenoid < 254, decrement
0711   7C3E             
0711   7C3E 23 FE       
0712   7C40 6A 48       			dec	solenoid9 - cRAM, X
0713   7C42             		endif
0713   7C42             
0713   7C42             
0713   7C42             
0713   7C42             
0713   7C42             
0713   7C42~            		endif
0713   7C42~            		endif
0713   7C42             
0713   7C42~            		endif
0713   7C42~            		endif
0713   7C42             
0713   7C3F             
0713   7C3F 02          
0713   7C40             
0713   7C40             
0713   7C40~            		endif
0713   7C40~            		endif
0713   7C40~            		endif
0713   7C40             
0713   7C42             
0713   7C42~            		endif
0713   7C42~            		endif
0713   7C42             
0714   7C42 0D          		sec
0715   7C43             	else
0715   7C43             
0715   7C43             
0715   7C43             
0715   7C43             
0715   7C3D             
0715   7C3D             
0715   7C3D             
0715   7C3D~            	else
0715   7C3D~            	else
0715   7C3D~            	else
0715   7C3D~            	else
0715   7C3D             
0715   7C3D~            	else
0715   7C3D~            	else
0715   7C3D~            	else
0715   7C3D~            	else
0715   7C3D             
0715   7C3D             
0715   7C3D 07          
0715   7C43             
0715   7C43 20 FE       
0715   7C45             
0715   7C45             
0715   7C45             
0715   7C45~            	else
0715   7C45~            	else
0715   7C45~            	else
0715   7C45~            	else
0715   7C45~            	else
0715   7C45             
0715   7C45~            	else
0715   7C45~            	else
0715   7C45             
0715   7C45~            	else
0715   7C45~            	else
0715   7C45             
0716   7C45 0C          		clc
0717   7C46             	endif
0717   7C46             
0717   7C46             
0717   7C46             
0717   7C46             
0717   7C46             
0717   7C46~            	endif
0717   7C46~            	endif
0717   7C46             
0717   7C46~            	endif
0717   7C46~            	endif
0717   7C46             
0717   7C44             
0717   7C44 01          
0717   7C45             
0717   7C45             
0717   7C45~            	endif
0717   7C45~            	endif
0717   7C45~            	endif
0717   7C45             
0717   7C46             
0717   7C46~            	endif
0717   7C46~            	endif
0717   7C46             
0718   7C46 76 00 29    	ror		solBStatus	
0719   7C49 7A 00 50    	dec		curCol ; undo inc
0720   7C4C             	
0721   7C4C             ; update strobe	
0722   7C4C             updateStrobe:
0723   7C4C 86 08       	ldaA	8 	; pitch
0724   7C4E 9B 10       	addA	>curSwitchRowLsb
0725   7C50 97 10       	staA	curSwitchRowLsb
0726   7C52 7C 01 6A    	inc	displayCol
0727   7C55 78 00 07    	asl	strobe ; strobe done?  reset
0728   7C58             	ifeq		
0728   7C58             
0728   7C58 26 FE       
0729   7C5A 96 28       		ldaA	>solAStatus
0730   7C5C B7 22 00    		staA	solenoidA
0731   7C5F 96 29       		ldaA	>solBStatus
0732   7C61 B7 22 02    		staA	solenoidB
0733   7C64             	
0734   7C64 86 01       		ldaA	00000001b
0735   7C66 97 07       		staA	strobe
0736   7C68             		
0737   7C68 7F 00 50    		clr	curCol
0738   7C6B 7F 00 51    		clr	curCol + 1
0739   7C6E 7F 00 10    		clr	curSwitchRowLsb
0740   7C71 7F 00 28    		clr	solAStatus
0741   7C74 7F 00 29    		clr	solBStatus
0742   7C77             		
0743   7C77 F6 01 6A    		ldaB	>displayCol	; reset display col only if it's > 7 
0744   7C7A CA F0       		oraB	11110000b
0745   7C7C C1 F8       		cmpB	$F8	; since it needs to count to 15 instead of 7
0746   7C7E             		ifgt
0746   7C7E             
0746   7C7E 23 FE       
0747   7C80 7F 01 6A    			clr	displayCol
0748   7C83             		endif
0748   7C83             
0748   7C83             
0748   7C83             
0748   7C83             
0748   7C83             
0748   7C83~            		endif
0748   7C83~            		endif
0748   7C83             
0748   7C83~            		endif
0748   7C83~            		endif
0748   7C83             
0748   7C7F             
0748   7C7F 03          
0748   7C80             
0748   7C80             
0748   7C80~            		endif
0748   7C80~            		endif
0748   7C80~            		endif
0748   7C80             
0748   7C83             
0748   7C83~            		endif
0748   7C83~            		endif
0748   7C83             
0749   7C83             	
0750   7C83             		;ldaA	>state
0751   7C83             		;oraA	100b
0752   7C83             		;staA	state
0753   7C83 7C 01 6C    		inc	strobeReset
0754   7C86             	else
0754   7C86             
0754   7C86             
0754   7C86             
0754   7C86             
0754   7C59             
0754   7C59             
0754   7C59             
0754   7C59~            	else
0754   7C59~            	else
0754   7C59~            	else
0754   7C59~            	else
0754   7C59             
0754   7C59~            	else
0754   7C59~            	else
0754   7C59~            	else
0754   7C59~            	else
0754   7C59             
0754   7C59             
0754   7C59 2E          
0754   7C86             
0754   7C86 20 FE       
0754   7C88             
0754   7C88             
0754   7C88             
0754   7C88~            	else
0754   7C88~            	else
0754   7C88~            	else
0754   7C88~            	else
0754   7C88~            	else
0754   7C88             
0754   7C88~            	else
0754   7C88~            	else
0754   7C88             
0754   7C88~            	else
0754   7C88~            	else
0754   7C88             
0755   7C88 7C 00 51    		inc	curCol + 1
0756   7C8B             	endif
0756   7C8B             
0756   7C8B             
0756   7C8B             
0756   7C8B             
0756   7C8B             
0756   7C8B~            	endif
0756   7C8B~            	endif
0756   7C8B             
0756   7C8B~            	endif
0756   7C8B~            	endif
0756   7C8B             
0756   7C87             
0756   7C87 03          
0756   7C88             
0756   7C88             
0756   7C88~            	endif
0756   7C88~            	endif
0756   7C88~            	endif
0756   7C88             
0756   7C8B             
0756   7C8B~            	endif
0756   7C8B~            	endif
0756   7C8B             
0757   7C8B             	
0758   7C8B 3B          	rti
0759   7C8C             afterInterrupt:
0760   7C8C             
0761   7FF8             pointers: 	.org $7FF8  	
0762   7FF8             	.msfirst
0763   7FF8 7B 00       	.dw interrupt			
0764   7FFA 7B 00       	.dw interrupt			
0765   7FFC 7B 00       	.dw interrupt			
0766   7FFE 78 00       	.dw main
0767   8000             	
0768   8000             	
0769   8000             	.endtasm: Number of errors = 0
